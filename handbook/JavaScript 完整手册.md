**åŸæ–‡åœ°å€**ï¼š[freeCodeCamp](https://medium.freecodecamp.org/the-complete-javascript-handbook-f26b2c71719c)ï¼ˆéœ€æ¢¯å­ï¼‰

ç¬¬ä¸€æ¬¡ç¿»è¯‘~ å¦‚æœ‰çº°æ¼ï¼Œè¯·å¤šå¤šæŒ‡ç‚¹~

# JavaScript å®Œæ•´æ‰‹å†Œ

JavaScript æ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ï¼Œç°åœ¨ä¹Ÿå¹¿æ³›ç”¨äºæµè§ˆå™¨ä¹‹å¤–çš„åœºæ™¯ä¸­ã€‚è¿‘å‡ å¹´ï¼ŒNode.js çš„å´›èµ·è§£é”äº†é•¿æœŸä»¥æ¥è¢« Java, Ruby, Python, PHP ç­‰ä¼ ç»ŸæœåŠ¡ç«¯è¯­è¨€ç»Ÿæ²»çš„åç«¯å¼€å‘é¢†åŸŸã€‚

è¿™æœ¬ JavaScript å®Œæ•´æ‰‹å†Œéµå¾ªäºŒå…«å®šå¾‹ï¼ˆthe 80/20 ruleï¼‰ï¼šåœ¨ 20% çš„æ—¶é—´é‡Œäº†è§£ 80% çš„ JavaScript çŸ¥è¯†ã€‚

å¿«æ¥äº†è§£æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ JavaScript å§ï¼

**æ³¨æ„**ï¼šä½ å¯ä»¥è·å–è¿™ç¯‡ JavaScript æŒ‡å—çš„ [PDF, ePub, Mobi](https://pages.convertkit.com/2b70e494a0/7e0cc9da5b) ç‰ˆæœ¬ä»¥ä¾¿åœ¨ Kindle æˆ–å¹³æ¿ä¸Šé˜…è¯»ã€‚

## ä»‹ç»

JavaScript æ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ã€‚è‡ªä» 20 å¹´å‰è¯ç”Ÿä»¥æ¥ï¼Œå·²ç»èµ°è¿‡å¾ˆé•¿çš„ä¸€æ®µè·¯ã€‚ä½œä¸ºç¬¬ä¸€ä¸ªè€Œä¸”æ˜¯å”¯ä¸€ä¸€ä¸ªè¢«ç½‘é¡µæµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„è„šæœ¬è¯­è¨€ï¼Œå®ƒè¢«ä¸‹äº†æ­»å‘½ä»¤ã€‚

ä¸€å¼€å§‹ï¼Œå®ƒå¹¶ä¸åƒä»Šå¤©è¿™æ ·å¼ºå¤§ï¼Œä¸»è¦è¢«ç”¨äºå„ç§èŠ±å“¨çš„åŠ¨ç”» ğŸ˜† å’Œå½“æ—¶è¢«å¹¿æ³›ç§°å¥‡çš„åŠ¨æ€ HTMLï¼ˆ[DHTML](https://en.wikipedia.org/wiki/Dynamic_HTML)ï¼‰ä¸­ã€‚ä¼´éšç€ç½‘é¡µå¹³å°å‘å±•çš„éœ€è¦ï¼ŒJavaScript ä¹Ÿæœ‰*è´£ä»»*å˜å¾—æ›´å¥½ï¼Œä»¥æ»¡è¶³ä¸–ç•Œä¸Šæœ€å¹¿æ³›ä½¿ç”¨çš„ç”Ÿæ€ç³»ç»Ÿä¹‹ä¸€çš„éœ€æ±‚ã€‚å¹³å°æœ¬èº«å¼•å…¥äº†å¾ˆå¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬æµè§ˆå™¨ APIï¼ŒåŒæ—¶è¯­è¨€ç‰¹æ€§ä¹Ÿæˆé•¿äº†è®¸å¤šã€‚

ç°åœ¨ JavaScript ä¹Ÿå¯ä»¥æ“ä½œæ•°æ®åº“å’Œå¼€å‘åº”ç”¨ç¨‹åºï¼Œç”šè‡³å¯ä»¥å¼€å‘åµŒå…¥å¼ç¨‹åºï¼Œç§»åŠ¨ APPï¼Œç”µè§†åº”ç”¨ç¨‹åºç­‰ç­‰ã€‚æ›¾ç»åªæ˜¯åœ¨æµè§ˆå™¨ä¸­çš„å°è¯­è¨€ï¼Œç°åœ¨ä¹Ÿæ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„è¯­è¨€äº†~

## JavaScript åŸºæœ¬å®šä¹‰

JavaScript æ˜¯è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€ï¼š

- **é«˜çº§**ï¼šå®ƒå…è®¸ä½ æ›´åŠ æ³¨é‡æœ¬èº«çš„é€»è¾‘ï¼Œå¿½ç•¥å½“å‰è¿è¡Œå®ƒçš„æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚JavaScript é€šè¿‡åƒåœ¾å›æ”¶å™¨è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œè®©ä½ å¯ä»¥æ›´ä¸“æ³¨ä»£ç è€Œä¸æ˜¯ç®¡ç†å†…å­˜ï¼Œå®ƒä¹Ÿæä¾›äº†å¾ˆå¤šæ„é€ å‡½æ•°è®©ä½ èƒ½å¤Ÿå¤„ç†å¼ºå¤§çš„å˜é‡å’Œå¯¹è±¡ã€‚
- **åŠ¨æ€**ï¼šå’Œé™æ€è¯­è¨€åœ¨ç¼–è¯‘æ—¶æ‰§è¡Œç›¸åï¼ŒåŠ¨æ€è¯­è¨€åœ¨è¿è¡Œæ—¶æ‰ä¼šæ‰§è¡Œã€‚è¿™æœ‰åˆ©æœ‰å¼Šï¼ŒJavaScript ç»™æˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šåŠ¨æ€ç±»å‹ï¼Œå»¶è¿Ÿç»‘å®šï¼Œåå°„ï¼Œå‡½æ•°å¼ç¼–ç¨‹ï¼Œå¯¹è±¡è¿è¡Œæ—¶å˜æ›´ï¼ˆobject runtime alterationï¼‰ï¼Œé—­åŒ…ç­‰ç­‰ã€‚
- **åŠ¨æ€ç±»å‹**ï¼šå˜é‡ä¸ç”¨å®šä¹‰ç±»å‹ã€‚ä½ å¯ä»¥ä¸ºå˜é‡é‡æ–°ç»‘å®šä»»ä½•ç±»å‹ï¼Œæ¯”å¦‚ç»™ä¸€ä¸ªå·²å£°æ˜è¿‡çš„å­—ç¬¦ä¸²å˜é‡ç»‘å®šä¸€ä¸ªæ•´å‹å€¼ã€‚
- **å¼±ç±»å‹**ï¼šä¸å¼ºç±»å‹ç›¸åï¼Œå¼±ç±»å‹è¯­è¨€ä¸å¼ºåˆ¶å¯¹è±¡çš„ç±»å‹ã€‚è¿™ä½¿å¾—æ“ä½œæ›´åŠ çµæ´»ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿæ— æ³•è¿›è¡Œç±»å‹æ£€æŸ¥ç¡®ä¿ç±»å‹å®‰å…¨ï¼ˆTypeScript å’Œ Flow æ—¨åœ¨æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼‰ã€‚
- **è§£é‡Šå‹**ï¼šJavaScript é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€åœ¨ç¨‹åºè¿è¡Œå‰ä¸éœ€è¦å…ˆç¼–è¯‘ï¼Œè¿™æ°æ°ä¸ C è¯­è¨€ï¼ŒJava æˆ–è€…æ˜¯ Go è¯­è¨€ç›¸åã€‚äº‹å®ä¸Šï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘æµè§ˆå™¨ä¼šåœ¨æ‰§è¡Œ JavaScript ä¹‹å‰è¿›è¡Œç¼–è¯‘ï¼Œä½†æ˜¯è¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªç„¶è€Œç„¶å‘ç”Ÿçš„ï¼Œä¸éœ€è¦æˆ‘ä»¬è¿›è¡Œé¢å¤–çš„æ“ä½œã€‚
- **å¤šèŒƒå‹**ï¼šJavaScript ä¸å¼ºåˆ¶ä½¿ç”¨ä»»ä½•å›ºå®šçš„ç¼–ç¨‹èŒƒå¼ï¼Œä¸åƒ Java å¼ºåˆ¶é¢å‘å¯¹è±¡ç¼–ç¨‹æˆ–è€…æ˜¯ C è¯­è¨€å¼ºåˆ¶å‘½ä»¤å¼ç¼–ç¨‹ã€‚åœ¨ JavaScript ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨åŸå‹å’Œ ES6 ä¸­æä¾›çš„ classes è¯­æ³•é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å®ƒçš„å¤´ç­‰å‡½æ•°ï¼ˆfirst-class functionsï¼‰ç¼–å†™å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„ä»£ç ï¼Œç”šè‡³ä»¥å‘½ä»¤å¼ç¼–å†™ç¨‹åºï¼ˆC-likeï¼‰ã€‚

è¯´æ˜ä¸€ä¸‹ï¼ŒJavaScript å’Œ Java æ— å…³ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¹¸çš„å‘½åé€‰æ‹©ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å¾—ä¸æ¥å—ç°å®ã€‚

### JavaScript ç‰ˆæœ¬

è®©æˆ‘ä»‹ç»ä¸€ä¸‹ ECMAScriptã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ä»‹ç» ECMAScript çš„å®Œæ•´æŒ‡å—ï¼Œä½ å¯ä»¥åœ¨é‚£é‡Œæ·±å…¥äº†è§£å®ƒï¼Œä½†ç°åœ¨ï¼Œä½ åªéœ€è¦çŸ¥é“ ECMAScriptï¼ˆä¹Ÿè¢«ç§°ä½œ ESï¼‰æ˜¯ JavaScript æ ‡å‡†çš„åå­—ã€‚JavaScript æ˜¯å¯¹ ECMAScript æ ‡å‡†çš„ä¸€ç§å®ç°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ ä¼šå¬åˆ° ES6, ES2015, ES2016, ES2017, ES2018 ç­‰ç­‰ã€‚

å¾ˆä¹…ä»¥å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨ä¸­è¿è¡Œçš„ JavaScript ç‰ˆæœ¬åŸºäº ECMAScipt 3ã€‚ç‰ˆæœ¬ 4 å› ä¸ºç‰¹å¾è •åŠ¨ï¼ˆfeature creepï¼‰è¢«å–æ¶ˆäº†ï¼ˆä»–ä»¬è¯•å›¾ä¸€æ¬¡æ€§æ·»åŠ å¾ˆå¤šç‰¹æ€§ï¼‰ã€‚è™½ç„¶ ES5 æ˜¯ JavaScript çš„ä¸€ä¸ªå·¨å¤§ç‰ˆæœ¬ï¼Œä½†æ˜¯ ES2015ï¼ˆä¹Ÿè¢«ç§°ä½œ ES6ï¼‰ä¹Ÿæ˜¯ JavaScript çš„é‡è¦æ›´æ–°ã€‚

ä»é‚£æ—¶èµ·ï¼Œæ ‡å‡†åˆ¶å®šå§”å‘˜ä¼šå†³å®šæ¯å¹´æ›´æ–°ä¸€ä¸ªç‰ˆæœ¬ï¼Œé¿å…ç‰ˆæœ¬è¿­ä»£é—´éš”å¤ªä¹…ï¼Œä¹Ÿå¯ä»¥åŠ å¿«åé¦ˆé€Ÿåº¦ã€‚

ç°åœ¨ï¼Œæœ€æ–°æ‰¹å‡†çš„ JavaScript ç‰ˆæœ¬æ˜¯ ES2017ï¼ˆè¯‘æ³¨ï¼š2018/11/10ï¼Œæœ€æ–°ç‰ˆæœ¬æ˜¯ ES2018ï¼‰ã€‚

## ECMASCRIPT

æ— è®ºä½•æ—¶ä½ é˜…è¯»å…³äº JavaScript çš„å†…å®¹æ—¶éƒ½æ— å¯é¿å…çš„çœ‹åˆ°ä¸‹é¢è¿™äº›æœ¯è¯­ï¼š

- ES3
- ES5
- ES6
- ES7
- ES8
- ES2015
- ES2016
- ES2017
- ECMAScript 2017
- ECMAScript 2016
- ECMAScript 2015

è¿™äº›éƒ½æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬éƒ½æŒ‡ **JavaScript æ ‡å‡†**ï¼Œè¢«ç§°ä½œ ECMAScriptã€‚

ECMAScript æ˜¯ **JavaScript æ‰€åŸºäºçš„æ ‡å‡†**ï¼Œç»å¸¸è¢«ç®€ç§°ä¸º **ES**ã€‚

é™¤äº† JavaScriptï¼Œå®ç°äº† ECMAScript æ ‡å‡†çš„è¿˜åŒ…æ‹¬ï¼š

- *ActionScript*ï¼ˆFlash è„šæœ¬è¯­è¨€ï¼‰ï¼Œè‡ªä»å®˜æ–¹å†³å®šä» 2020 å¹´èµ·ä¸å†ç»´æŠ¤ Flash ä¾¿ä¸å†æµè¡Œã€‚
- *JScript*ï¼ˆå¾®è½¯ï¼‰ï¼Œä¸€å¼€å§‹åªæœ‰ Netscape æ”¯æŒ JavaScriptï¼Œæµè§ˆå™¨å¤§æˆ˜æ„ˆæ¼”æ„ˆçƒˆï¼Œå¾®è½¯ä¾¿å®ç°äº†ä»… IE æµè§ˆå™¨æ”¯æŒçš„ç‰ˆæœ¬ã€‚

ä½†æ˜¯æ¯«æ— ç–‘é—®ï¼ŒJavaScript ä»æ˜¯**æœ€æ™®é**çš„ ES å®ç°ã€‚

ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªå¥‡æ€ªçš„åå­—ï¼Ÿ`Ecma International`æ˜¯ç‘å£«æ ‡å‡†åä¼šï¼Œè´Ÿè´£åˆ¶å®šå›½é™…æ ‡å‡†ã€‚

å½“ JavaScript è¢«åˆ›å»ºæ—¶ï¼Œå®ƒè¢« Netscape å’Œ Sun Microsystems æäº¤åˆ° Ecmaï¼Œå‘½åä¸º ECMA-262ï¼Œä¹Ÿå«åš ECMAScriptã€‚æ ¹æ®ç»´åŸºç™¾ç§‘ä¸Šçš„å†…å®¹ï¼ŒNetscapte å’Œ Sun Microsystemsï¼ˆJava åˆ¶é€ å•†ï¼‰è”åˆå‘å¸ƒçš„[æ–°é—»ç¨¿](https://web.archive.org/web/20070916144913/http://wp.netscape.com/newsref/pr/newsrelease67.html)å¯èƒ½ä¼šå¸®åŠ©äº†è§£å¦‚æ­¤å‘½åçš„åŸå› ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬å¾®è½¯åœ¨å§”å‘˜ä¼šé‡Œçš„æ³•å¾‹å’Œå“ç‰Œé—®é¢˜ã€‚

IE9 ä¹‹åï¼Œå¾®è½¯åœæ­¢åœ¨æµè§ˆå™¨ä¸­å°† ES å®ç°ç§°ä¸º JScriptï¼Œå¼€å§‹å«ä½œ JavaScriptï¼ˆè‡³å°‘æˆ‘ä¸èƒ½ä»»ä½•å¼•ç”¨ï¼‰ã€‚

æ‰€ä»¥ï¼Œä»201xå¹´èµ·ï¼Œå”¯ä¸€ä¸€ä¸ªæ”¯æŒ ECMAScript æ ‡å‡†çš„æµè¡Œè¯­è¨€å°±åªæœ‰ JavaScript äº†ã€‚

### ECMAScript æœ€æ–°ç‰ˆæœ¬

ç›®å‰ ECMAScript ç‰ˆæœ¬æ˜¯ **ES2018**ï¼Œå³ **ES9**ï¼Œ2018å¹´å…­æœˆå‘å¸ƒã€‚

### ä¸‹ä¸ªç‰ˆæœ¬ä»€ä¹ˆæ—¶å€™å‘å¸ƒï¼Ÿ

é€šå¸¸ï¼ŒJavaScript ä¼šåœ¨æ¯å¹´å¤å¤©å‘å¸ƒæ ‡å‡†ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ 2019 å¹´å¤å¤©è§åˆ° **ECMAScript 2019**ï¼ˆå³ **ES2019** æˆ–è€… **ES10**ï¼‰ï¼Œä½†è¿™ä¸€åˆ‡åªæ˜¯çŒœæµ‹ã€‚

### TC39 æ˜¯ä»€ä¹ˆ

TC39 æ˜¯ JavaScript å‘å±•å§”å‘˜ä¼šã€‚

TC39 æˆå‘˜æ¶‰åŠ JavaScript å’Œæµè§ˆå™¨ä¾›åº”å•†ï¼ŒåŒ…æ‹¬ç«ç‹ï¼Œè°·æ­Œï¼ŒFacebookï¼ŒAppleï¼Œå¾®è½¯ï¼Œè‹±ç‰¹å°”ï¼ŒPayPalï¼ŒSalesForce ç­‰ç­‰ã€‚

æ¯ä¸€ä¸ªæ ‡å‡†ç‰ˆæœ¬çš„å‘å¸ƒéƒ½å¿…é¡»é€šè¿‡[ä¸åŒé˜¶æ®µ](https://tc39.github.io/process-document/)çš„ææ¡ˆã€‚

### ES ç‰ˆæœ¬

æˆ‘å‘ç° ES ç‰ˆæœ¬æœ‰æ—¶å€™é€šè¿‡ç‰ˆæœ¬å·æŒ‡ä»£ï¼Œæœ‰æ—¶å€™é€šè¿‡å¹´ä»½ï¼Œè¿™ä¼šè®©äººå›°æƒ‘ã€‚

åœ¨ ES2015 ä¹‹å‰ï¼ŒECMAScript æ ‡å‡†é€šå¸¸æŒ‰ç…§ç‰ˆæœ¬å·å‘½åï¼Œæ‰€ä»¥ ES5 æ˜¯2009å¹´æ›´æ–°çš„ ECMAScript æ ‡å‡†å®˜æ–¹å‘½åã€‚

ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿåœ¨ ES2015 å‘å¸ƒæ—¶ï¼Œåå­—ä» ES6 å˜æˆäº† ES2015ï¼Œä½†æ˜¯ä¸ºæ—¶å·²æ™šï¼Œäººä»¬ä»ç„¶ä¹ æƒ¯æ€§åœ°ç§°ä¸º ES6ï¼Œç¤¾åŒºä¹Ÿæ²¡æœ‰æŠ›å¼ƒè¿™ä¸ªåå­—  - *ä¸–ç•Œäººæ°‘ä»ç„¶æŒ‰ç…§ç‰ˆæœ¬å·çš„æ–¹å¼æŒ‡ä»£ ES ç‰ˆæœ¬*ã€‚

è¿™ä¸ªè¡¨æ ¼å¯ä»¥å¸®åŠ©ç†æ¸…æ€è·¯ï¼š

| ç‰ˆæœ¬    | å®˜æ–¹åç§°   | å‘å¸ƒæ—¥æœŸ     |
| ----- | ------ | -------- |
| ES9   | ES2018 | 2018å¹´6æœˆ  |
| ES8   | ES2017 | 2017å¹´6æœˆ  |
| ES7   | ES2016 | 2016å¹´6æœˆ  |
| ES6   | ES2015 | 2015å¹´6æœˆ  |
| ES5.1 | ES5.1  | 2011å¹´6æœˆ  |
| ES5   | ES5    | 2009å¹´12æœˆ |
| ES4   | ES4    | åºŸå¼ƒ       |
| ES3   | ES3    | 1999å¹´12æœˆ |
| ES2   | ES2    | 1998å¹´6æœˆ  |
| ES1   | ES1    | 1997å¹´6æœˆ  |

ES.Next å§‹ç»ˆæŒ‡ JavaScript æœªæ¥ç‰ˆæœ¬ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒES9 å·²ç»å‘å¸ƒï¼ŒES.Next æ˜¯ ES10ã€‚

## ES6 æ”¹è¿›

ECMAScript 2015ï¼Œä¹Ÿå³ç†ŸçŸ¥çš„ ES6ï¼Œ æ˜¯ ECMAScript æ ‡å‡†çš„åŸºç¡€ç‰ˆæœ¬ï¼Œè·ç¦»ä¸Šä¸ªç‰ˆæœ¬ ECMAScript 5.1 å‘å¸ƒæœ‰å››å¹´ä¹‹ä¹…ï¼Œä¹Ÿæ˜¯ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹å°†ç‰ˆæœ¬æ”¹ä¸ºä»¥å¹´å‘½åã€‚æ‰€ä»¥å®ƒä¸åº”è¯¥å«åš ES6ï¼ˆå°½ç®¡æ¯ä¸ªäººéƒ½è¿™ä¹ˆå«ï¼‰ï¼Œè€Œæ˜¯ ES2015ã€‚

> ES5 ä» 1999 å¹´åˆ°2009å¹´èŠ±è´¹äº†åå¹´æ—¶é—´å®Œå–„ï¼Œå°½ç®¡å¯¹äºè¿™ä¸ªè¯­è¨€æ¥è®²ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦ç‰ˆæœ¬ï¼Œä½†æ˜¯å¤ªé•¿æ—¶é—´è¿‡å»äº†ï¼Œå·²ç»ä¸å€¼å¾—æˆ‘ä»¬è®¨è®º ES5 ä¹‹å‰çš„ä»£ç æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

ä» ES5.1 åˆ° ES6ï¼ŒJavaScript è¯­è¨€æœ‰äº†é‡è¦çš„æ–°ç‰¹æ€§ä»¥åŠåœ¨æ›´å¥½çš„å®è·µä¸­çš„å…³é”®æ›´æ–°ã€‚è¦äº†è§£ ES2015 çš„åŸºæœ¬åŠŸèƒ½ï¼Œè¯·å‚é˜…è§„èŒƒæ–‡æ¡£çš„250é¡µåˆ°600é¡µã€‚

ES2015 ä¸­çš„é‡è¦æ›´æ–°åŒ…æ‹¬ï¼š

- ç®­å¤´å‡½æ•°
- Promises
- Generators
- `let` å’Œ `const`
- Classes
- å¤šè¡Œå­—ç¬¦ä¸²
- æ¨¡æ¿å­—ç¬¦ä¸²
- å‚æ•°é»˜è®¤å€¼
- æ‰©å±•è¿ç®—ç¬¦
- è§£æ„èµ‹å€¼
- å¢å¼ºçš„å¯¹è±¡å­—é¢é‡
- for..of å¾ªç¯
- Map å’Œ Set

åœ¨è¿™ç¯‡æŒ‡å—ä¸­ï¼Œæˆ‘å°†åœ¨æ¯ä¸ªç« èŠ‚ä¸­ä¸“é—¨ä»‹ç»å®ƒä»¬ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼

### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æ”¹å˜äº†å¤§å¤šæ•° JavaScript ä»£ç çš„ä¹¦å†™ä¹ æƒ¯å’Œå·¥ä½œæ–¹å¼ã€‚

ä»è§†è§‰ä¸Šæ¥è®²ï¼Œå®ƒæ›´ç®€å•äº†ï¼Œä¹Ÿæ˜¯å—æ¬¢è¿çš„æ”¹å˜ï¼Œæ¯”å¦‚ï¼š

```js
const foo = function foo() {
  // ...
}
```

å˜æˆï¼š

```js
const foo = () => {
  // ...
}
```

å¦‚æœè¿™ä¸ªå‡½æ•°ä½“åªæœ‰ä¸€è¡Œï¼Œå¯ä»¥æ˜¯è¿™æ ·ï¼š

```js
const foo = () => doSomething()
```

å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥æ˜¯è¿™æ ·ï¼š

```js
const foo = param => doSomething(param)
```

å’Œå¸¸è§„å‡½æ•°ç›¸æ¯”å®ƒæ²¡æœ‰å¸¦æ¥ä»»ä½•ä¸å…¼å®¹å˜åŒ–ï¼Œå’Œä»¥å‰ä¸€æ ·å·¥ä½œã€‚

#### æ–°çš„ this ä½œç”¨åŸŸ

ç®­å¤´å‡½æ•°ä¸­çš„ `this` ä»æ‰§è¡Œä¸Šä¸‹æ–‡ç»§æ‰¿ã€‚

åœ¨ä»¥å‰çš„å¸¸è§„å‡½æ•°ä¸­ï¼Œ`this` é€šå¸¸æŒ‡æœ€è¿‘çš„å‡½æ•°ã€‚ç„¶è€Œåœ¨ç®­å¤´å‡½æ•°ä¸­è¿™ä¸ªé—®é¢˜æ²¡æœ‰äº†ï¼Œä½ ä¸å†éœ€è¦é‡å†™ä¸€é `var that = this`ã€‚

### Promises

Promises å¸®æˆ‘ä»¬è§£å†³äº†è‘—åçš„â€œå›è°ƒåœ°ç‹±â€é—®é¢˜ï¼Œè™½ç„¶å®ƒå¼•å…¥äº†æ›´å¤æ‚çš„é—®é¢˜ï¼ˆåœ¨ ES2017 ä¸­å¯ä»¥é€šè¿‡æ›´é«˜çº§çš„æ„é€ å‡½æ•° `asnyc` è§£å†³ ï¼‰ã€‚

åœ¨ ES2015 ä¹‹å‰ï¼ŒJavaScript å¼€å‘è€…å°±å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸åŒçš„åº“ï¼ˆjQueryï¼Œqï¼Œdeferred.jsï¼Œvow...ï¼‰å®ç°ç±»ä¼¼ Promises çš„åŠŸèƒ½ã€‚è¯¥æ ‡å‡†åˆ¶å®šäº†æ›´é€šç”¨çš„æ–¹æ³•ã€‚

é€šè¿‡ä½¿ç”¨ promisesï¼Œä½ å¯ä»¥é‡æ„è¿™ä¸ªä»£ç ï¼š

```js
setTimeout(function() {
  console.log('I promised to run after 1s')
  setTimeout(function() {
    console.log('I promised to run after 2s')
  }, 1000)
}, 1000)
```

ç­‰åŒäºï¼š

```js
const wait = () => new Promise((resolve, reject) => {
  setTimeout(resolve, 1000)
})
wait().then(() => {
  console.log('I promised to run after 1s')
  return wait()
})
.then(() => console.log('I promised to run after 2s'))
```

### Generators

ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œèƒ½å¤Ÿæš‚åœè¾“å‡ºï¼Œç¨åæ¢å¤ï¼Œè€Œä¸”å…è®¸å…¶å®ƒä»£ç åœ¨æ­¤æœŸé—´è¿è¡Œã€‚

ä»£ç æœ¬èº«å†³å®šäº†å®ƒå¿…é¡»ç­‰å¾…ï¼Œä»¥ä¾¿è®©å…¶å®ƒä»£ç â€œæŒ‰ç…§é˜Ÿåˆ—â€é¡ºåºè¿è¡Œï¼Œè€Œä¸”ä¿ç•™äº†â€œå½“ç­‰å¾…â€å®Œæˆæ—¶æ¢å¤æ“ä½œçš„æƒåˆ©ã€‚æ‰€æœ‰çš„è¿™äº›éƒ½é€šè¿‡ä¸€ä¸ªç®€å•çš„å…³é”®å­— `yield` æ¥å®Œæˆã€‚å½“ä¸€ä¸ªç”Ÿæˆå™¨åŒ…å«è¯¥å…³é”®å­—ï¼Œä»£ç å°†æš‚åœæ‰§è¡Œã€‚ç”Ÿæˆå™¨å¯ä»¥åŒ…å«å¾ˆå¤šä¸ª `yield` å…³é”®å­—ï¼Œå› æ­¤å¯ä»¥æš‚åœå¾ˆå¤šæ¬¡ï¼Œå¹¶ä¸”é€šè¿‡ `*function` å…³é”®å­—æ ‡è¯†ï¼Œä¸è¦ä¸ C è¯­è¨€ï¼ŒC++ æˆ–è€… Go ç­‰åº•å±‚è¯­è¨€çš„æŒ‡é’ˆåå‘å¼•ç”¨æ“ä½œç¬¦æ··æ·†ã€‚

åœ¨ JavaScript ä¸­ï¼Œç”Ÿæˆå™¨å¯ç”¨å…¨æ–°çš„ç¼–ç¨‹èŒƒä¾‹ï¼Œæ¯”å¦‚ï¼š

- ç”Ÿæˆå™¨è¿è¡Œä¸­åŒå‘é€šä¿¡
- æŒä¹…çš„ while å¾ªç¯ï¼Œä¸ä¼šå†»ç»“ç¨‹åº

è¿™é‡Œæœ‰ä¸ªä¾‹å­å¯ä»¥è§£é‡Šç”Ÿæˆå™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š

```js
function *calculator(input) {
    var doubleThat = 2 * (yield (input / 2))
    var another = yield (doubleThat)
    return (input * doubleThat * another)
}
```

åˆå§‹åŒ–ï¼š

```js
const calc = calculator(10)
```

ç„¶åå¼€å§‹è¿­ä»£ç”Ÿæˆå™¨ï¼š

```js
calc.next()
```

ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œä»£ç è¿”å›äº† `this` å¯¹è±¡ï¼š

```js
{
  done: false
  value: 5
}
```

å‘ç”Ÿäº†ä»€ä¹ˆï¼šå‡½æ•°å¼€å§‹è¿è¡Œæ—¶ï¼Œ`input = 10` ä½œä¸ºå‚æ•°ä¼ å…¥äº†ç”Ÿæˆå™¨çš„æ„é€ å‡½æ•°ä¸­ï¼Œç›´åˆ°é‡åˆ° `yield`ï¼Œè¿”å›äº† `yeild` çš„å†…å®¹ï¼š`input / 2 = 5`ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå€¼ä¸º 5ï¼Œå¹¶ä¸”å‘Šè¯‰æˆ‘ä»¬è¿­ä»£æ²¡æœ‰å®Œæˆï¼ˆä»…ä»…æ˜¯å‡½æ•°æš‚åœäº†ï¼‰ã€‚

åœ¨ç¬¬äºŒæ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥ `7`ï¼š

```js
calc.next(7)
```

ç„¶åæˆ‘ä»¬ä¼šå¾—åˆ°ï¼š

```js
{
  done: false
  value: 14
}
```

`7` æ˜¯ `doubleThat` çš„å€¼ã€‚

> æ³¨æ„ï¼šä½ å¯èƒ½ä¼šè®¤ä¸º `input / 2` æ˜¯è¿™ä¸ªå‚æ•°ï¼Œä½†æ˜¯å®ƒä»…ä»…æ˜¯ç¬¬ä¸€æ¬¡è¿­ä»£çš„è¿”å›å€¼ï¼Œè¿™æ¬¡æˆ‘ä»¬è·³è¿‡äº†è¿™ä¸€æ­¥ï¼Œä½¿ç”¨æ–°çš„è¾“å…¥å€¼ `7` å’Œ 2 ç›¸ä¹˜ã€‚

æˆ‘ä»¬ç»§ç»­ç¬¬äºŒæ¬¡è¿­ä»£ï¼Œå®ƒè¿”å›äº† `doubleThat`ï¼Œå€¼ä¸º `14`ã€‚

ä¸‹ä¸€ä¸ªï¼Œæœ€åä¸€æ¬¡è¿­ä»£ï¼Œæˆ‘ä»¬ä¼ å…¥100ï¼š

```js
calc.next(100)
```

è¿”å›ï¼š

```js
{
  done: true
  value: 14000
}
```

æ•´ä¸ªè¿­ä»£ç»“æŸï¼ˆæ²¡æœ‰ `yeild` å…³é”®å­—äº†ï¼‰ï¼Œæˆ‘ä»¬å¾—åˆ°äº† `(input * doubleThat * another)` çš„å€¼ï¼š`10 * 14 * 100`ã€‚

### let å’Œ const

`var` æ˜¯ä¼ ç»Ÿçš„**å‡½æ•°ä½œç”¨åŸŸ**ã€‚

`let` æ˜¯æ–°çš„å£°æ˜å˜é‡çš„æ–¹æ³•ï¼Œæ‹¥æœ‰**å—çº§ä½œç”¨åŸŸ**ã€‚è¿™æ„å‘³ç€åœ¨ for å¾ªç¯ä¸­ï¼Œif è¯­å¥å†…æˆ–è€… plain å—ä¸­ä½¿ç”¨ `let` å£°æ˜çš„å˜é‡ä¸ä¼šâ€œé€ƒå‡ºâ€æ‰€åœ¨çš„å—ï¼Œè€Œ `var`å˜é‡åˆ™ä¼šè¢«æå‡åˆ°å‡½æ•°å®šä¹‰ã€‚

`const` å’Œ `like` ç›¸ä¼¼ï¼Œä½†æ˜¯**ä¸å¯æ›´æ”¹**ã€‚

å±•æœ› JavaScript çš„å‘å±•ï¼Œ`var` å£°æ˜ä¼šé€æ¸æ¶ˆå¤±ï¼Œåªå‰©ä¸‹ `let` å’Œ `const`ã€‚

æ›´ç‰¹åˆ«çš„æ˜¯ï¼Œç”±äºä¸å¯å˜çš„ç‰¹æ€§ï¼Œ`const` åœ¨ä»Šå¤©å·²ç»å‡ºäººæ„æ–™çš„è¢«å¹¿æ³›ä½¿ç”¨ã€‚

### Classes

ä¼ ç»Ÿä¸Šï¼ŒJavaScript æ˜¯å”¯ä¸€åŸºäºåŸå‹ç»§æ‰¿çš„è¯­è¨€ã€‚ä»åŸºäºç±»ç»§æ‰¿çš„è¯­è¨€è½¬å‘ä½¿ç”¨ JavaScript çš„ç¨‹åºå‘˜ä¼šè§‰å¾—å›°æƒ‘ï¼Œä½†æ˜¯ ES2015 å¼•å…¥äº† classesï¼Œä½œä¸º JavaScript å†…éƒ¨å®ç°ç»§æ‰¿çš„è¯­æ³•ç³–ï¼Œå®ƒæ”¹å˜äº†æˆ‘ä»¬ç¼–å†™ JavaScript ç¨‹åºçš„æ–¹å¼ã€‚

ç°åœ¨ï¼Œç»§æ‰¿å˜å¾—éå¸¸ç®€å•ï¼Œå’Œå…¶ä»–é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ç±»ä¼¼ï¼š

```js
class Person {
  constructor(name) {
    this.name = name
  }
  hello() {
    return 'Hello, I am ' + this.name + '.'
  }
}
class Actor extends Person {
  hello() {
    return super.hello() + ' I am an actor.'
  }
}
var tomCruise = new Actor('Tom Cruise')
tomCruise.hello()
```

ä¸Šé¢çš„ä»£ç ä¼šæ‰“å°å‡ºï¼šâ€œ*Hello, I am Tom Cruise. I am an actor.*â€

Classes æ²¡æœ‰æ˜¾æ€§çš„å£°æ˜ç±»å˜é‡ï¼Œä½ å¿…é¡»åœ¨æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰ä¸­åˆå§‹åŒ–å˜é‡ã€‚

#### Constructor

Classes æ‹¥æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• `constructor`ï¼Œåœ¨ä½¿ç”¨ `new` å®ä¾‹åŒ–ç±»æ—¶è¢«è°ƒç”¨ã€‚

#### Getters å’Œ Setters

å¯ä»¥åƒè¿™æ ·å£°æ˜ä¸€ä¸ª getter å±æ€§ï¼š

```js
class Person {
  get fullName() {
    return `${this.firstName} ${this.lastName}`
  }
}
```

ç”¨åŒæ ·çš„æ–¹å¼å£°æ˜ setter å±æ€§ï¼š

```js
class Person {
  set age(years) {
    this.theAge = years
  }
}
```

### æ¨¡å—åŒ–

ES2015 ä¹‹å‰ï¼Œè‡³å°‘æœ‰ä¸‰ä¸ªä¸»è¦çš„æ¨¡å—åŒ–æ ‡å‡†ï¼Œè¿™åˆ†è£‚äº†æ•´ä¸ªç¤¾åŒºï¼š

- AMD
- RequireJS
- CommonJS

ES2015 åˆ¶å®šäº†ç»Ÿä¸€çš„æ¨¡å—åŒ–æ ‡å‡†ã€‚

#### å¯¼å…¥æ¨¡å—

é€šè¿‡ `import ... from ...` å¯¼å…¥æ¨¡å—ï¼š

```js
import * from 'mymodule'
import React from 'react'
import { React, Component } from 'react'
import React as MyLibrary from 'react'
```

#### å¯¼å‡ºæ¨¡å—

ä½ å¯ä»¥ä½¿ç”¨å…³é”®å­— `export` å°†ç¼–å†™çš„æ¨¡å—å†…å®¹å¯¼å‡ºåˆ°å…¶å®ƒæ¨¡å—é‡Œï¼š

```js
export var foo = 2
export function bar() { /* ... */ }
```

### æ¨¡æ¿å­—ç¬¦ä¸²

æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯åˆ›å»ºå­—ç¬¦ä¸²çš„æ–°æ–¹æ³•ï¼š

```js
const aString = `A string`
```

ä½¿ç”¨ `${a_variable}` è¯­æ³•å¯ä»¥æ–¹ä¾¿åœ°å°†è¡¨è¾¾å¼çš„å€¼æ’åˆ°å­—ç¬¦ä¸²é‡Œï¼š

```js
const var = 'test'
const string = `something ${var}` //something test
```

ä½ è¿˜å¯ä»¥æ‰§è¡Œæ›´å¤æ‚çš„è¡¨è¾¾å¼ï¼Œåƒè¿™æ ·ï¼š

```js
const string = `something ${1 + 2 + 3}`
const string2 = `something ${foo() ? 'x' : 'y' }`
```

å­—ç¬¦ä¸²å¯ä»¥æ˜¯å¤šè¡Œçš„ï¼š

```js
const string3 = `Hey
this
string
is awesome!`
```

å¯¹æ¯”ä¸€ä¸‹ ES2015 ä¹‹å‰çš„å¤šè¡Œå­—ç¬¦ä¸²çš„å†™æ³•ï¼š

```js
var str = 'One\n' +
'Two\n' +
'Three'
```

### å‚æ•°é»˜è®¤å€¼

å‡½æ•°ç°åœ¨æ”¯æŒä½¿ç”¨é»˜è®¤å‚æ•°å€¼ï¼š

```js
const foo = function(index = 0, testing = true) { /* ... */ }
foo()
```

### æ‰©å±•è¿ç®—ç¬¦

ä½ å¯ä»¥é€šè¿‡æ‰©å±•è¿ç®—ç¬¦ `...` æ‰©å±•æ•°ç»„ï¼Œå¯¹è±¡æˆ–è€…æ˜¯å­—ç¬¦ä¸²ã€‚

è®©æˆ‘ä»¬ç”¨æ•°ç»„ä¸¾ä¸ªä¾‹å­ï¼š

```js
const a = [1, 2, 3]
```

ä½ å¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼š

```js
const b = [...a, 4, 5, 6]
```

ä½ å¯ä»¥å¤åˆ¶ä¸€ä¸ªæ•°ç»„ï¼š

```js
const c = [...a]
```

è¿™å¯¹å¯¹è±¡åŒæ ·å¥æ•ˆï¼Œè¿™æ ·å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ï¼š

```js
const newObj = { ...oldObj }
```

å¯¹äºå­—ç¬¦ä¸²ï¼Œæ‰©å±•è¿ç®—ç¬¦ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”æ¯ä¸ªå­—ç¬¦çš„æ•°ç»„ï¼š

```js
const hey = 'hey'
const arrayized = [...hey] // ['h', 'e', 'y']
```

è¿™ä¸ªè¿ç®—ç¬¦éå¸¸æœ‰ç”¨ã€‚æœ€é‡è¦çš„å°±æ˜¯å¯ä»¥ä»¥ä¸€ç§ååˆ†ç®€å•çš„æ–¹å¼ä¸ºä¸€ä¸ªå‡½æ•°ä¼ é€’æ•°ç»„å½¢å¼çš„å‚æ•°ï¼š

```js
const f = (foo, bar) => {}
const a = [1, 2]
f(...a)
```

ä»¥å‰ä½ å¯ä»¥ä½¿ç”¨ `f.apply(null, a)` è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯å®ƒä¸æ˜¯å¾ˆæ˜“è¯»ã€‚

### è§£æ„èµ‹å€¼

ç»™ä½ ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥æŠ½å‡ºä¸€äº›å€¼æŠŠä»–ä»¬èµ‹å€¼ç»™åˆ«çš„å˜é‡ï¼š

```js
const person = {
  firstName: 'Tom',
  lastName: 'Cruise',
  actor: true,
  age: 54, //made up
}
const {firstName: name, age} = person
```

`name` å’Œ `age` åŒ…å«è¿™äº›å€¼ã€‚

è¿™ä¸ªè¯­æ³•ä¹Ÿå¯ä»¥ç”¨åœ¨æ•°ç»„ä¸­ï¼š

```js
const a = [1,2,3,4,5]
[first, second, , , fifth] = a
```

### åŠ å¼ºçš„å‡½æ•°å­—é¢é‡

ES2015 ä¸­å‡½æ•°å­—é¢é‡æ›´åŠ å¼ºå¤§ã€‚

#### å£°æ˜å˜é‡çš„ç®€å•è¯­æ³•

ä»¥å‰ï¼š

```js
const something = 'y'
const x = {
  something: something
}
```

ç°åœ¨ä½ å¯ä»¥ï¼š

```js
const something = 'y'
const x = {
  something
}
```

#### åŸå‹

å¯ä»¥åƒè¿™æ ·ä¸ºå˜é‡æŒ‡å®šåŸå‹ï¼š

```js
const anObject = { y: 'y' }
const x = {
  __proto__: anObject
}
```

#### super()

```js
const anObject = { y: 'y', test: () => 'zoo' }
const x = {
  __proto__: anObject,
  test() {
    return super.test() + 'x'
  }
}
x.test() //zoox
```

#### åŠ¨æ€å±æ€§

```js
const x = {
  ['a' + '_' + 'b']: 'z'
}
x.a_b //z
```

### for-of å¾ªç¯

2009å¹´çš„ ES5 å¼•å…¥äº† `forEach()` å¾ªç¯ã€‚è™½ç„¶å¾ˆå¥½ï¼Œä½†æ˜¯ä¸èƒ½åƒ `for` é‚£æ ·ä¸­é€”è·³å‡ºå¾ªç¯ã€‚

ES2015 å¼•å…¥äº† `for-of` å¾ªç¯ï¼Œç»“åˆäº† `forEach` çš„ç®€æ´å’Œè·³å‡ºå¾ªç¯çš„èƒ½åŠ›ã€‚

```js
//iterate over the value
for (const v of ['a', 'b', 'c']) {
  console.log(v);
}
//get the index as well, using `entries()`
for (const [i, v] of ['a', 'b', 'c'].entries()) {
  console.log(i, v);
}
```

### Map å’Œ Set

**Map** å’Œ **Set**ï¼ˆä»¥åŠå„è‡ªçš„å¼±å¼•ç”¨ç±»å‹ **WeakMap** å’Œ **WeakSet**ï¼‰æ˜¯å®˜æ–¹å®ç°çš„ä¸¤ç§éå¸¸æµè¡Œçš„æ•°æ®ç»“æ„ï¼ˆç¨åä»‹ç»ï¼‰ã€‚

## ES2016 æ”¹è¿›

ES7ï¼Œå®˜æ–¹ç§°ä½œ ECMAScript 2016ï¼Œ2016å¹´6æœˆå‘å¸ƒã€‚

å’Œ ES6 ç›¸æ¯”ï¼ŒES7 æ˜¯ JavaScript çš„å°ç‰ˆæœ¬æ›´æ–°ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªåŠŸèƒ½ï¼š

- Array.prototype.includes
- æŒ‡æ•°è¿ç®—ç¬¦

### Array.prototype.includes()

è¿™ä¸ªåŠŸèƒ½å¼•å…¥äº†æ›´æ˜“è¯»çš„è¯­æ³•æ¥æ£€æŸ¥ä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…æ‹¬ä¸€ä¸ªå…ƒç´ ã€‚

åœ¨ ES6 ä»¥åŠæ›´ä½ç‰ˆæœ¬ä¸­ï¼Œæ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨æ•°ç»„ä¸­ä½ ä¸å¾—ä¸ä½¿ç”¨ `indexOf`æ£€æŸ¥æ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚æœè¿”å› `-1` å…ƒç´ åˆ™ä¸åœ¨æ•°ç»„ä¸­ã€‚

å› ä¸º `-1` è¢«è®¤ä¸ºæ˜¯ä¸ªçœŸå€¼ï¼Œæ‰€ä»¥ä½ **æ— æ³•**åˆ¤æ–­ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

```js
if (![1,2].indexOf(3)) {
  console.log('Not found')
}
```

ç”¨ ES7 çš„æ–°è¯­æ³•å¯ä»¥å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœï¼š

```js
if (![1,2].includes(3)) {
  console.log('Not found')
}
```

### æŒ‡æ•°è¿ç®—ç¬¦

æŒ‡æ•°è¿ç®—ç¬¦ `**` å’Œ `Math.pow()` ä¸€è‡´ï¼Œä½†æ˜¯å¼•å…¥çš„æ˜¯ä¸ªè¯­è¨€ç‰¹æ€§ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåº“å‡½æ•°ã€‚

```js
Math.pow(4, 2) === 4 ** 2
```

è¿™ä¸ªåŠŸèƒ½æ˜¯ Math å¯†é›†å‹ JavaScript åº”ç”¨å¾ˆå¥½çš„è¡¥å……ã€‚`**` è¿ç®—ç¬¦åœ¨å¾ˆå¤šè¯­è¨€ä¸­éƒ½å·²ç»æ ‡å‡†åŒ–ï¼Œæ¯”å¦‚ Pythonï¼ŒRubyï¼ŒMATLABï¼ŒLuaï¼ŒPerl ç­‰ç­‰ã€‚

## ES2017 æ”¹è¿›

ECMAScript 2017ï¼ŒECMA-262 æ ‡å‡†çš„ç¬¬å…«ç‰ˆï¼ˆç§°ä½œ **ES2017** æˆ–è€… **ES8**ï¼‰ï¼Œ2017å¹´6æœˆå‘å¸ƒã€‚

å’Œ ES6 ç›¸æ¯”ï¼ŒES8 ä»ç„¶å¸¦æ¥äº†å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼š

- String padding
- Object.values
- Object.entries
- Object.getOwnPropertyDescriptors()
- å‡½æ•°å‚æ•°å°¾é€—å·
- å¼‚æ­¥å‡½æ•°
- Shared memory and atomics

### String padding

String padding çš„ç›®çš„æ˜¯**ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ·»åŠ å­—ç¬¦ï¼Œè®©å®ƒå¯ä»¥å’Œå£°æ˜çš„é•¿åº¦ä¸€è‡´**ã€‚

ES2017 å¼•å…¥äº†ä¸¤ä¸ª `String` ä¸Šçš„æ–¹æ³•ï¼š`padStart()` å’Œ ` padEnd()`ã€‚

```js
padStart(targetLength [, padString])
padEnd(targetLength [, padString])
```

ä¾‹å­ï¼š

| padStart()                 | è¾“å‡º                             |
|:-------------------------- | ------------------------------ |
| 'test'.padStart(4)         | 'test'                         |
| 'test'.padStart(5)         | '&nbsp;test'                   |
| 'test'.padStart(8)         | '&nbsp;&nbsp;&nbsp;&nbsp;test' |
| 'test'.padStart(8, 'abcd') | 'abcdtest'                     |

| padEnd()                 | è¾“å‡º                             |
| ------------------------ | ------------------------------ |
| 'test'.padEnd(4)         | 'test'                         |
| 'test'.padEnd(5)         | 'test&nbsp;'                   |
| 'test'.padEnd(8)         | 'test&nbsp;&nbsp;&nbsp;&nbsp;' |
| 'test'.padEnd(8, 'abcd') | 'testabcd'                     |

### Object.values()

è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡è‡ªèº«å±æ€§å€¼çš„æ•°ç»„ã€‚ç”¨æ³•ï¼š

```js
const person = { name: 'Fred', age: 87 }
Object.values(person) // ['Fred', 87]
```

`Object.values()` ä¹Ÿå¯ä»¥ç”¨äºæ•°ç»„ï¼š

```js
const people = ['Fred', 'Tony']
Object.values(people) // ['Fred', 'Tony']
```

### Object.entries()

è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª `[key, value]` å½¢å¼çš„åŒ…å«å¯¹è±¡è‡ªèº«æ‰€æœ‰å±æ€§åŠå€¼çš„æ•°ç»„ã€‚ç”¨æ³•ï¼š

```js
const person = { name: 'Fred', age: 87 }
Object.entries(person) // [['name', 'Fred'], ['age', 87]]
```

`Object.entries()` ä¹Ÿå¯ä»¥ç”¨äºæ•°ç»„ï¼š

```js
const people = ['Fred', 'Tony']
Object.entries(people) // [['0', 'Fred'], ['1', 'Tony']]
```

### getOwnPropertyDescriptors()

è¿™ä¸ªæ–¹æ³•è¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰æè¿°ç¬¦ï¼ˆéç»§æ‰¿ï¼‰ã€‚

JavaScript ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå±æ€§é›†åˆï¼Œæ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªæè¿°ç¬¦ã€‚

æè¿°ç¬¦æ˜¯å±æ€§çš„ attribute é›†åˆï¼Œå®ƒåŒ…æ‹¬ä¸‹é¢è¿™äº›å­é›†ï¼š

- **value**ï¼šå±æ€§çš„å€¼
- **writable**ï¼šä¸º true æ—¶å±æ€§å¯ä»¥é‡å†™
- **get**ï¼šå±æ€§çš„ getter å‡½æ•°ï¼Œå½“è¯»å–å±æ€§æ—¶è¢«è°ƒç”¨
- **set**ï¼šå±æ€§çš„ setter å‡½æ•°ï¼Œå½“è®¾ç½®å±æ€§å€¼æ—¶è¢«è°ƒç”¨
- **configurable**ï¼šå¦‚æœä¸º falseï¼Œå±æ€§ä¸èƒ½è¢«åˆ é™¤ï¼Œè€Œä¸”ä¸èƒ½æ›´æ”¹æ‰€æœ‰çš„ attribute å€¼ï¼Œå±æ€§è‡ªèº«çš„å€¼é™¤å¤–
- **enumerable**ï¼šä¸º true æ—¶å±æ€§å¯æšä¸¾

`Object.getOwnPropertyDescriptors(obj)` æ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«æè¿°ç¬¦çš„å¯¹è±¡ã€‚

#### è¿™æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

ES2015 ç»™æˆ‘ä»¬å¸¦æ¥äº† `Object.assign()`ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¤åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼Œè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ã€‚

ç„¶è€Œè¿™æ ·æ“ä½œæœ‰ä¸ªé—®é¢˜ï¼Œå®ƒæ— æ³•æ­£ç¡®å¤åˆ¶æ²¡æœ‰é»˜è®¤ attributes çš„å±æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åªæœ‰ä¸€ä¸ª setterï¼Œå°±ä¸èƒ½ç”¨ `Object.assign()` æ­£ç¡®å¤åˆ¶å®ƒã€‚

```js
const person1 = {
    set name(newName) {
        console.log(newName)
    }
}
```

è¿™æ ·ä¸ä¼šå·¥ä½œï¼š

```js
const person2 = {}
Object.assign(person2, person1)
```

ä½†æ˜¯è¿™æ ·å¯ä»¥ï¼š

```js
const person3 = {}
Object.defineProperties(person3,
Object.getOwnPropertyDescriptors(person1))
```

ä½ å¯ä»¥é€šè¿‡æ§åˆ¶å°ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š

```js
person1.name = 'x'
"x"
person2.name = 'x'

person3.name = 'x'
"x"
```

`person2` æ²¡æœ‰ setterï¼Œå®ƒä¸èƒ½è¢«æ­£ç¡®å¤åˆ¶ã€‚

ä½¿ç”¨ `Object.create()` å¯¹å¯¹è±¡æµ…å…‹éš†ä¹Ÿæœ‰åŒæ ·çš„é™åˆ¶ã€‚

### å°¾åé€—å·

è¿™ä¸ªåŠŸèƒ½å…è®¸åœ¨å‡½æ•°å£°æ˜å’Œå‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨å°¾åé€—å·ï¼š

```js
const doSomething = (var1, var2,) => {
  //...
}
doSomething('test2', 'test2',)
```

è¿™ä¸ªæ”¹å˜å°†é¼“åŠ±å¼€å‘è€…åœæ­¢ä½¿ç”¨ä¸‘é™‹çš„â€œè¡Œé¦–é€—å·â€çš„ä¹ æƒ¯ã€‚

### å¼‚æ­¥å‡½æ•°

ES2017 å¼•å…¥äº†**å¼‚æ­¥å‡½æ•°**çš„æ¦‚å¿µï¼Œå®ƒä¹Ÿæ˜¯è¿™ä¸ª ECMAScript ç‰ˆæœ¬é‡Œæœ€é‡è¦çš„å˜åŒ–ã€‚

å¼‚æ­¥å‡½æ•°ç»“åˆäº† promises å’Œ generators ä»¥å‡å°‘ promises å¸¦æ¥çš„æ ·æ¿é£æ ¼å’Œ promises é“¾çš„â€œä¸è¦æ‰“ç ´è°ƒç”¨é“¾â€é™åˆ¶ã€‚

### ä¸ºä»€ä¹ˆä»–ä»¬å¾ˆæœ‰ç”¨

å®ƒæ˜¯å¯¹ promises å‡½æ•°çš„é«˜çº§æŠ½è±¡ã€‚

å½“ ES2015 é‡Œå¼•å…¥ Promises çš„æ—¶å€™ï¼Œè¿™ä¸ªåŠŸèƒ½è‡´åŠ›äºè§£å†³å¼‚æ­¥ä»£ç çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨ ES2015 åˆ° ES2017 å‘å¸ƒçš„ä¸¤å¹´é‡Œï¼Œäººä»¬æ¸…æ¥šçš„è®¤è¯†åˆ°*è¿™ä¸æ˜¯è§£å†³é—®é¢˜çš„æœ€ç»ˆæ–¹æ³•*ã€‚

å¼•å…¥ Promises ç”¨æ¥è§£å†³è‘—åçš„*å›è°ƒåœ°ç‹±*é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†è‡ªèº«çš„å¤æ‚æ€§ï¼ŒåŠ å¤§äº†è¯­æ³•çš„å¤æ‚ç¨‹åº¦ã€‚ä»–ä»¬æ˜¯å¾ˆå¥½çš„å¼€ç«¯ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¯ä»¥è®©å¼€å‘è€…ä½¿ç”¨æ›´å¥½çš„è¯­æ³•ï¼šé‚£å°±æ˜¯**å¼‚æ­¥å‡½æ•°**ã€‚

#### ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­

ä½¿ç”¨å¼‚æ­¥å‡½æ•°çš„ä»£ç å¯ä»¥åƒè¿™æ ·ï¼š

```js
function doSomethingAsync() {
    return new Promise((resolve) => {
        setTimeout(() => resolve('I did something'), 3000)
    })
}
async function doSomething() {
    console.log(await doSomethingAsync())
}
console.log('Before')
doSomething()
console.log('After')
```

ä¸Šé¢çš„ä»£ç ä¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°é‡Œæ‰“å°å‡ºï¼š

```js
Before
After
I did something //after 3s
```

### ä¸²è”å¤šä¸ªå¼‚æ­¥å‡½æ•°

é“¾å¼è°ƒç”¨å¼‚æ­¥å‡½æ•°å¾ˆç®€å•ï¼Œè€Œä¸”æ¯”åŸå§‹çš„ promises æ›´æ˜“è¯»ï¼š

```js
function promiseToDoSomething() {
    return new Promise((resolve)=>{
        setTimeout(() => resolve('I did something'), 10000)
    })
}
async function watchOverSomeoneDoingSomething() {
    const something = await promiseToDoSomething()
    return something + ' and I watched'
}
async function watchOverSomeoneWatchingSomeoneDoingSomething() {
    const something = await watchOverSomeoneDoingSomething()
    return something + ' and I watched as well'
}
watchOverSomeoneWatchingSomeoneDoingSomething().then((res) => {
    console.log(res)
})
```

### å…±äº«å†…å­˜å’ŒåŸå­

WebWorkers ç”¨æ¥åœ¨æµè§ˆå™¨é‡Œæ„å»ºå¤šçº¿ç¨‹ç¨‹åºã€‚

ä»–ä»¬é€šè¿‡äº‹ä»¶ï¼ˆeventsï¼‰æä¾›ä¸€ç§é€šä¿¡åè®®ã€‚ä» ES2017 å¼€å§‹ï¼Œä½ å¯ä»¥é€šè¿‡ `SharedArrayBuffer` åœ¨ web workers å’Œä»–ä»¬çš„æ„é€ è€…ä¸­é—´åˆ›å»ºä¸€ä¸ªå…±äº«å†…å­˜æ•°ç»„ã€‚

ç”±äºæˆ‘ä»¬ä¸çŸ¥é“å†™å…¥ä¸€ä¸ªå…±äº«å†…å­˜çš„ä¼ é€’éƒ¨åˆ†éœ€è¦å¤šé•¿äº‹ä»¶ï¼Œå› æ­¤**åŸå­**ï¼ˆ**Atomics**ï¼‰æ˜¯ä¸€ç§åœ¨è¯»å–å€¼æ—¶æ‰§è¡Œæ“ä½œçš„æ–¹æ³•ï¼Œå¹¶ä¸”å®Œæˆäº†æ‰€æœ‰ç±»å‹çš„å†™å…¥æ“ä½œã€‚

æ›´å¤šå†…å®¹å¯ä»¥åœ¨[è¿™ä¸ªææ¡ˆ](https://github.com/tc39/ecmascript_sharedmem/blob/master/TUTORIAL.md)ä¸­æ‰¾åˆ°ï¼Œè¯¥ææ¡ˆå·²ç»è¢«å®ç°ã€‚

## ES2018 æ”¹è¿›

ES2018 æ˜¯æœ€æ–°çš„ ECMAScript æ ‡å‡†ã€‚

å®ƒå¼•å…¥äº†ä»€ä¹ˆæ–°ä¸œè¥¿å‘¢ï¼Ÿ

### Rest/Spread å±æ€§

ES6 å¼•å…¥äº†é’ˆå¯¹**æ•°ç»„è§£æ„**çš„**å‰©ä½™å…ƒç´ **ï¼š

```js
const numbers = [1, 2, 3, 4, 5]
[first, second, ...others] = numbers
```

å’Œ**æ‰©å±•å…ƒç´ **ï¼š

```js
const numbers = [1, 2, 3, 4, 5]
const sum = (a, b, c, d, e) => a + b + c + d + e
const sum = sum(...numbers) // å‹˜è¯¯ï¼šæ­¤å¤„ä¸èƒ½å¯¹ sum é‡æ–°èµ‹å€¼ï¼Œæ„Ÿè°¢ [æ£®è“æƒ…ä¸¶](https://juejin.im/user/59c8ea816fb9a00a4746e258)
```

ES2018 ä¸ºå¯¹è±¡å¸¦æ¥äº†åŒæ ·çš„åŠŸèƒ½ã€‚

**å‰©ä½™å±æ€§**ï¼š

```js
const { first, second, ...others } = { first: 1, second: 2, third: 3, fourth: 4, fifth: 5 }
first // 1
second // 2
others // { third: 3, fourth: 4, fifth: 5 }
```

**æ‰©å±•å±æ€§**å…è®¸é€šè¿‡ç»„åˆåœ¨spreadè¿ç®—ç¬¦ä¹‹åä¼ é€’çš„å¯¹è±¡çš„å±æ€§æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼š

```js
const items = { first, second, ...others }
items //{ first: 1, second: 2, third: 3, fourth: 4, fifth: 5 }
```

### å¼‚æ­¥è¿­ä»£

æ–°çš„æ„é€ å‡½æ•° `for-await-of` å…è®¸ä½ ä½¿ç”¨å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ä½œä¸ºå¾ªç¯è¿­ä»£ï¼š

```js
for await (const line of readLines(filePath)) {
  console.log(line)
}
```

å› ä¸ºè¿™é‡Œç”¨äº† `await` ï¼Œæ‰€ä»¥ä½ åªèƒ½åœ¨ `async` å‡½æ•°å†…éƒ¨ä½¿ç”¨å®ƒï¼Œå°±åƒä¸€ä¸ªæ™®é€šçš„ `await`ï¼ˆå‚è€ƒ async/awaitï¼‰ã€‚

### Promise.prototype.finally()

å½“ä¸€ä¸ª promise å®Œæˆï¼ˆfulfilledï¼‰ï¼Œå®ƒä¼šä¸€ä¸ªæ¥ä¸€ä¸ªçš„è°ƒç”¨ `then()` æ–¹æ³•ã€‚å¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†ä»»ä½•é”™è¯¯ï¼Œ`then()` æ–¹æ³•ä¼šè¢«è·³è¿‡ï¼Œè¿›è€Œæ‰§è¡Œ `catch()` æ–¹æ³•ã€‚

æ— è®º promise æ‰§è¡ŒæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œ`finally()` éƒ½ä¼šè¿è¡Œå…¶ä¸­çš„ä»£ç ï¼š

```js
fetch('file.json')
  .then(data => data.json())
  .catch(error => console.error(error))
  .finally(() => console.log('finished'))
```

### æ­£åˆ™è¡¨è¾¾å¼æ”¹è¿›

RegExp åè¡Œæ–­è¨€ï¼šæ ¹æ®å‰é¢çš„å†…å®¹åŒ¹é…å­—ç¬¦ä¸²ã€‚

è¿™æ˜¯ä¸€ä¸ªå…ˆè¡Œæ–­è¨€ï¼šä½¿ç”¨ `?=` åŒ¹é…ç‰¹å®šçš„å­å­—ç¬¦ä¸²ï¼š

```js
/Roger(?=Waters)/
/Roger(?= Waters)/.test('Roger is my dog') //false
/Roger(?= Waters)/.test('Roger is my dog and Roger Waters is a famous musician') //true
```

`?!` æ‰§è¡Œç›¸åçš„æ“ä½œï¼ŒåŒ¹é…å­—ç¬¦ä¸²åé¢**æ²¡æœ‰**ç‰¹å®šçš„å­å­—ç¬¦ä¸²ï¼š

```js
/Roger(?!Waters)/
/Roger(?! Waters)/.test('Roger is my dog') //true
/Roger(?! Waters)/.test('Roger Waters is a famous musician') //false
```

å…ˆè¡Œæ–­è¨€ä½¿ç”¨ `?=` æ ‡è¯†ç¬¦ï¼Œå®ƒå·²ç»å¯ç”¨äº†ã€‚

**åè¡Œæ–­è¨€**ï¼Œæ–°åŠŸèƒ½ï¼Œä½¿ç”¨ `?<=`ã€‚

```js
/(?<=Roger) Waters/
/(?<=Roger) Waters/.test('Pink Waters is my dog') //false
/(?<=Roger) Waters/.test('Roger is my dog and Roger Waters is a famous musician') //true
```

ä½¿ç”¨ `?<!` å¦å®šåè¡Œæ–­è¨€ï¼š

```js
/(?<!Roger) Waters/
/(?<!Roger) Waters/.test('Pink Waters is my dog') //true
/(?<!Roger) Waters/.test('Roger is my dog and Roger Waters is a famous musician') //false
```

### Unicode å±æ€§è½¬ä¹‰  `\p{â€¦}` å’Œ `\P{â€¦}`

åœ¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼é‡Œï¼Œä½ å¯ä»¥ä½¿ç”¨ `\d` åŒ¹é…ä»»æ„æ•°å­—ï¼Œ `\s` åŒ¹é…ä¸åŒ…æ‹¬ç©ºæ ¼çš„ä»»æ„å­—ç¬¦ï¼Œ`\w` åŒ¹é…ä»»æ„å­—æ¯æ•°å­—å­—ç¬¦ç­‰ç­‰ã€‚

è¿™ä¸ªæ–°åŠŸèƒ½é€šè¿‡å¼•å…¥ `\p{}` å’Œ `\P{}` å°†æ­¤æ¦‚å¿µæ‰©å±•åˆ°æ‰€æœ‰ Unicode å­—ç¬¦ã€‚

ä»»ä½• unicode å­—ç¬¦éƒ½æœ‰ä¸€ç»„ç‰¹å®šçš„å±æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ`Script` å†³å®šäº†è¯­è¨€å®¶æ—ï¼Œ`ASCII` æ˜¯ ASCII å­—ç¬¦ä¸² true çš„å¸ƒå°”å€¼ï¼Œç­‰ç­‰ã€‚ä½ å¯ä»¥æŠŠè¿™ä¸ªç‰¹æ€§æ”¾åˆ°å¤§æ‹¬å·ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¼šæ£€æŸ¥æ˜¯å¦ä¸ºçœŸï¼š

```js
/^\p{ASCII}+$/u.test('abc')   //âœ…
/^\p{ASCII}+$/u.test('ABC@')  //âœ…
/^\p{ASCII}+$/u.test('ABCğŸ™ƒ') //âŒ
```

`ASCII_Hex_Digit` æ˜¯å¦ä¸€ä¸ªå¸ƒå°”å±æ€§ï¼Œå®ƒä¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶æ•°å­—ï¼š

```js
/^\p{ASCII_Hex_Digit}+$/u.test('0123456789ABCDEF') //âœ…
/^\p{ASCII_Hex_Digit}+$/u.test('h')                //âŒ
```

è¿˜æœ‰å¾ˆå¤šå¸ƒå°”å±æ€§ï¼Œä½ åªç”¨æŠŠä»–ä»¬çš„åå­—æ”¾åœ¨å¤§æ‹¬å·ä¸­å°±å¯ä»¥ç”¨äº†ï¼Œæ¯”å¦‚ï¼š`Uppercase`, `Lowercase`, `White_Space`, `Alphabatic`, `Emoji` ç­‰ç­‰ï¼š

```js
/^\p{Lowercase}$/u.test('h') //âœ…
/^\p{Uppercase}$/u.test('H') //âœ…
/^\p{Emoji}+$/u.test('H')   //âŒ
/^\p{Emoji}+$/u.test('ğŸ™ƒğŸ™ƒ') //âœ…
```

é™¤äº†è¿™äº›äºŒè¿›åˆ¶å±æ€§ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥æ£€æŸ¥ä»»æ„ unicode å­—ç¬¦æ˜¯å¦åŒ¹é…ç‰¹å®šçš„å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ£€æŸ¥äº†å­—ç¬¦ä¸²æ˜¯å¸Œè…Šè¯­è¿˜æ˜¯æ‹‰ä¸å­—æ¯ï¼š

```js
/^\p{Script=Greek}+$/u.test('ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬') //âœ…
/^\p{Script=Latin}+$/u.test('hey') //âœ…
```

äº†è§£æ›´å¤šå†…å®¹å¯ä»¥é˜…è¯»[ææ¡ˆ](https://github.com/tc39/proposal-regexp-unicode-property-escapes)ã€‚

### å‘½åæ•è·ç»„

åœ¨ ES2018 é‡ŒåŒ¹é…åˆ°çš„ç»„å¯ä»¥ç»‘å®šä¸€ä¸ªåå­—ï¼Œè€Œä¸æ˜¯ä»…åœ¨ç»“æœæ•°ç»„ä¸­ç»‘å®šä¸€ä¸ªæ’æ§½ï¼š

```js
const re = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
const result = re.exec('2015-01-02')
// result.groups.year === '2015';
// result.groups.month === '01';
// result.groups.day === '02';
```

### æ­£åˆ™è¡¨è¾¾å¼ 's'

`s` æ˜¯*å•è¡Œ*çš„ç¼©å†™ï¼Œå¯ä»¥å’Œ `.` ä¸€èµ·åŒ¹é…æ–°è¡Œï¼Œæ²¡æœ‰å®ƒï¼Œç‚¹æ ‡è¯†ç¬¦ä¸ä¼šåŒ¹é…æ–°è¡Œï¼š

```js
/hi.welcome/.test('hi\nwelcome') // false
/hi.welcome/s.test('hi\nwelcome') // true
```

## ç¼–ç¨‹é£æ ¼

JavaScript ç¼–ç¨‹é£æ ¼æ˜¯ç¼–å†™ JavaScript æ—¶çš„ä¸€ç³»åˆ—è§„èŒƒã€‚

ç¼–ç¨‹é£æ ¼æ˜¯**ä½ å’Œä½ çš„å›¢é˜Ÿ**è¾¾æˆçš„åè®®ï¼Œç”¨æ¥ä¿è¯é¡¹ç›®çš„ä¸€è‡´æ€§ã€‚å¦‚æœä½ æ²¡æœ‰å›¢é˜Ÿï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯**ä½ è‡ªå·±**çš„åå®šï¼Œåº”è¯¥å§‹ç»ˆä¿è¯ä½ çš„ä»£ç ç¬¦åˆä½ çš„æ ‡å‡†ã€‚

å¯¹ä»£ç ç¼–å†™æ ¼å¼æœ‰å›ºå®šçš„è§„åˆ™æœ‰å¾ˆå¤§çš„å¥½å¤„ï¼Œå¯ä»¥ä½¿ä»£ç **æ›´æ˜“è¯»å’Œæ›´æ˜“ç®¡ç†**ã€‚

### æµè¡Œçš„é£æ ¼æŒ‡å—

åœ¨ JavaScript é‡Œæœ‰å¾ˆå¤šé£æ ¼æŒ‡å—ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæœ€ä¸ºå¸¸è§çš„ï¼š

- [The Google JavaScript Style Guide](https://google.github.io/styleguide/jsguide.html)
- [The AirBnb JavaScript Style Guide](https://github.com/airbnb/javascript)

ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨å…¶ä¸­ä¸€ç§æˆ–è€…åˆ¶å®šè‡ªå·±çš„ä»£ç é£æ ¼ã€‚

#### å’Œä½ çš„é¡¹ç›®ä¿æŒä¸€è‡´çš„é£æ ¼

å³ä½¿ä½ æœ‰è‡ªå·±æ›´å–œæ¬¢çš„ä»£ç é£æ ¼ï¼Œåœ¨å›¢é˜Ÿåä½œä¸­ä½ ä¹Ÿè¦éµå®ˆå›¢é˜Ÿé¡¹ç›®é£æ ¼ã€‚

Github ä¸Šçš„æ¯ä¸ªå¼€æºé¡¹ç›®éƒ½å¯èƒ½ä¼šæœ‰ä¸€ç³»åˆ—è§„åˆ™ï¼Œä½ å‚ä¸çš„å¦ä¸€ä¸ªé¡¹ç›®å¯èƒ½ä¼šæœ‰å®Œå…¨ä¸åŒçš„è§„åˆ™ã€‚

[Prettier](https://flaviocopes.com/prettier/) æ˜¯æ ¼å¼ä»£ç çš„å¼ºå¤§å·¥å…·ï¼Œä½ åº”è¯¥è¯•è¯•å®ƒã€‚

#### æœ¬æŒ‡å—ä½¿ç”¨çš„è§„åˆ™

æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨æœ€æ–°çš„ ES ç‰ˆæœ¬ï¼Œåœ¨æ—§ç‰ˆæµè§ˆå™¨ä¸­ä½¿ç”¨ Babelã€‚

- **ç¼©è¿›**ï¼šç”¨ç©ºæ ¼ä»£æ›¿ tabsï¼Œç¼©è¿›ä¸¤ä¸ªç©ºæ ¼ã€‚

- **åˆ†å·**ï¼šä¸è¦ä½¿ç”¨åˆ†å·ã€‚

- **æ¯è¡Œé•¿åº¦**ï¼šå¦‚æœå¯èƒ½ï¼Œå°½åŠ›ä¿è¯æ¯è¡Œä¸è¶…è¿‡ 80 ä¸ªå­—ç¬¦ã€‚

- **è¡Œå†…æ³¨é‡Š**ï¼šåœ¨ä»£ç é‡Œä½¿ç”¨è¡Œå†…æ³¨é‡Šï¼Œåªåœ¨æ–‡ä»¶é‡Œä½¿ç”¨å—çº§æ³¨é‡Šã€‚

- **ä¸è¦æœ‰æ— ç”¨ä»£ç **ï¼šä¸è¦ç•™ä¸‹æ—§ä»£ç ï¼Œâ€œä»…ä»…ä»¥é˜²ä¸‡ä¸€â€å®ƒå°†æ¥è¿˜æœ‰ç”¨ã€‚ä¿è¯åªæœ‰ç°åœ¨éœ€è¦çš„ä»£ç ï¼Œç‰ˆæœ¬æ§åˆ¶æˆ–è€…ä½ çš„ç¬”è®°åº”ç”¨å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿçš„ã€‚

- **åªåœ¨éœ€è¦æ—¶æ³¨é‡Š**ï¼šä¸è¦æ·»åŠ ä¸èƒ½å¸®åŠ©ç†è§£çš„æ³¨é‡Šã€‚å¦‚æœä»£ç è‡ªèº«æœ‰è‰¯å¥½çš„å˜é‡ã€å‡½æ•°å‘½åå’Œ JSDoc å‡½æ•°æ³¨é‡Šï¼Œä¸è¦æ·»åŠ æ³¨é‡Šã€‚

- **å˜é‡å£°æ˜**ï¼šé¿å…æ±¡æŸ“å…¨å±€å˜é‡ï¼Œæ°¸è¿œä¸è¦ä½¿ç”¨ `var`ã€‚é»˜è®¤ä½¿ç”¨ `const`ï¼Œåªåœ¨éœ€è¦é‡ç»‘å®šå˜é‡æ—¶ä½¿ç”¨ `let`ã€‚

- **å¸¸é‡**ï¼šç”¨å¤§å†™å­—æ¯å£°æ˜æ‰€æœ‰å¸¸é‡ï¼Œç”¨ `_` åˆ†å‰² `VARIABLE_NAME`ã€‚

- **å‡½æ•°**ï¼šä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œé™¤éä½ æœ‰ä½¿ç”¨å¸¸è§„å‡½æ•°çš„ç†ç”±ï¼Œæ¯”å¦‚åœ¨å¯¹è±¡æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°ä¸­ï¼Œéœ€è¦ç¡®å®š `this` çš„æŒ‡å‘ã€‚ç”¨ const å£°æ˜å‡½æ•°ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä½¿ç”¨éšå¼è¿”å›ã€‚ä½¿ç”¨åµŒå¥—å‡½æ•°éšè—åŠ©æ‰‹å‡½æ•°çš„å¤šä½™ä»£ç ä¼šè®©ä½ è§‰å¾—æ— æ‹˜æ— æŸã€‚

  ```js
  const test = (a, b) => a + b
  const another = a => a + 2
  ```

- **åå­—**ï¼šå‡½æ•°å‘½ï¼Œå˜é‡åå’Œæ–¹æ³•åä»¥å°å†™å­—æ¯å¼€å§‹ï¼ˆé™¤éä»–ä»¬æ˜¯ç§æœ‰ä¸”åªè¯»çš„ï¼‰çš„é©¼å³°å‘½åï¼Œåªæœ‰æ„é€ å‡½æ•°å’Œç±»ååº”è¯¥ä»¥å¤§å†™å­—æ¯å¼€å§‹ã€‚å¦‚æœä½ ä½¿ç”¨ä¸€ä¸ªæœ‰ç‰¹å®šè§„èŒƒçš„æ¡†æ¶ï¼Œæ ¹æ®è¦æ±‚æ”¹å˜ä½ çš„ä¹ æƒ¯ã€‚æ–‡ä»¶ååº”è¯¥å…¨éƒ¨å°å†™ï¼Œç”¨ `-` åˆ†å‰²ã€‚

- ç‰¹å®šè¯­å¥æ ¼å¼å’Œè§„åˆ™ï¼š

  **if**

  ```js
  if (condition) {
    statements
  }
  if (condition) {
    statements
  } else {
    statements
  }
  if (condition) {
    statements
  } else if (condition) {
    statements
  } else {
    statements
  }
  ```

  **for**ï¼šå§‹ç»ˆåœ¨åˆå§‹åŒ–æ—¶ç¼“å­˜éå†å¯¹è±¡çš„é•¿åº¦ï¼Œä¸è¦æŠŠå®ƒæ’å…¥åˆ°æ¡ä»¶è¯­å¥ä¸­ã€‚é¿å…ä½¿ç”¨ `for in` è¡¨è¾¾å¼ï¼Œé™¤äº†å’Œ `.hasOwnProperty()` é…åˆä½¿ç”¨ï¼Œé¦–é€‰ `for of`ï¼š

  ```js
  for (initialization; condition; update) {
    statements
  }
  ```

  **while**

  ```js
  while (condition) {
    statements
  }
  ```

  **do**

  ```js
  do {
    statements
  } while (condition);
  ```

  **switch**

  ```js
  switch (expression) {
    case expression:
      statements
    default:
      statements
  }
  ```

  **try**

  ```js
  try {
    statements
  } catch (variable) {
    statements
  }
  try {
    statements
  } catch (variable) {
    statements
  } finally {
    statements
  }
  ```

- **ç©ºæ ¼**ï¼šæœºæ™ºçš„é€šè¿‡ç©ºæ ¼æ”¹å–„ä»£ç å¯è¯»æ€§ï¼šåœ¨å…³é”®å­—å’Œ `(` ä¸­æ’å…¥ä¸€ä¸ªç©ºæ ¼ï¼›åœ¨äºŒè¿›åˆ¶è¿ç®—ç¬¦ï¼ˆ`+`, `-`, `/` ,`*`, `&&` ...ï¼‰å‰é¢å’Œåé¢æ’å…¥ä¸€ä¸ªç©ºæ ¼ï¼›åœ¨è¯­å¥å†…ï¼Œæ¯ä¸ª `;` åæ’å…¥ä¸€ä¸ªç©ºæ ¼å°†æ¯ä¸ªè¯­å¥åˆ†å¼€ï¼›åœ¨æ¯ä¸ª `,` åæ’å…¥ä¸€ä¸ªç©ºæ ¼ã€‚

- **æ–°è¡Œ**ï¼šä½¿ç”¨æ–°è¡Œåˆ†éš”æ‰§è¡Œé€»è¾‘ç›¸å…³æ“ä½œçš„ä»£ç å—ã€‚

- **å¼•å·**ï¼šä½¿ç”¨å•å¼•å· `'` ä»£æ›¿åŒå¼•å· `"`ã€‚åŒå¼•å·æ˜¯ HTML çš„æ ‡å‡†å±æ€§ï¼Œæ‰€ä»¥ä½¿ç”¨å•å¼•å·é¿å…åœ¨å¤„ç† HTML å­—ç¬¦ä¸²æ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜ã€‚é€‚å½“æ—¶ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è€Œä¸æ˜¯å˜é‡æ’å€¼ã€‚

## è¯æ±‡ç»“æ„

ç°åœ¨æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨JavaScriptçš„æ„å»ºæ¨¡å—ï¼šunicodeï¼Œåˆ†å·ï¼Œç©ºæ ¼ï¼Œå¤§å°å†™æ•æ„Ÿï¼Œæ³¨é‡Šï¼Œå­—é¢é‡ï¼Œæ ‡è¯†ç¬¦å’Œä¿ç•™å­—ã€‚

### Unicode

JavaScript ç”¨ Unicode ç¼–å†™ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨ Emojis ä½œä¸ºå˜é‡åã€‚ğŸ˜ƒ ğŸ˜§ ğŸ˜² æ›´é‡è¦çš„æ˜¯ï¼Œä½ å¯ä»¥ç”¨ä»»ä½•è¯­è¨€ä¹¦å†™æ ‡è¯†ç¬¦ï¼Œæ¯”å¦‚æ—¥æ–‡æˆ–è€…ä¸­æ–‡ï¼Œ[ç›¸å…³è§„åˆ™](https://mathiasbynens.be/notes/javascript-identifiers)ã€‚

### åˆ†å·

JavaScript è¯­æ³•å’Œ C è¯­è¨€ç±»ä¼¼ï¼Œä½ å¯èƒ½ä¼šåœ¨å¾ˆå¤šç¤ºä¾‹ä»£ç é‡Œçœ‹åˆ°æ¯è¡Œä»£ç æœ«å°¾éƒ½æœ‰åˆ†å·ã€‚

**åˆ†å·ä¸æ˜¯å¼ºåˆ¶æ€§çš„**ï¼ŒJavaScript ä¸ä½¿ç”¨åˆ†å·æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ç°åœ¨å¾ˆå¤šå¼€å‘è€…ï¼Œç‰¹åˆ«æ˜¯ä»ä¸éœ€è¦åˆ†å·çš„è¯­è¨€è½¬è¿‡æ¥çš„é‚£éƒ¨åˆ†å¼€å§‹é¿å…ä½¿ç”¨åˆ†å·ã€‚

ä½ åªéœ€è¦é¿å…ä¸€äº›å¥‡æ€ªçš„åšæ³•ï¼Œæ¯”å¦‚å°†è¯­å¥åˆ†å‰²æˆå¤šè¡Œï¼š

```js
return
variable
```

æˆ–è€…æ˜¯åœ¨ä¸€è¡Œå‰ä»¥ï¼ˆ`[` æˆ–è€… `(`ï¼‰å¼€å¤´ã€‚è¿™æ ·ä½ åœ¨ 99.9% çš„æ—¶é—´é‡Œéƒ½æ˜¯å®‰å…¨çš„ï¼ˆä½ çš„ linter ä¹Ÿä¼šè­¦å‘Šä½ ï¼‰ã€‚

è¿™å–å†³äºä¸ªäººå–œå¥½ï¼Œæœ€è¿‘æˆ‘å†³å®š**å†ä¹Ÿä¸åŠ æ— ç”¨çš„åˆ†å·**ï¼Œæ‰€ä»¥åœ¨è¿™ç¯‡æ–‡ç« é‡Œä½ çœ‹ä¸åˆ°ä»»ä½•åˆ†å·ã€‚

### ç©ºæ ¼

JavaScript ä¸è®¤ä¸ºç©ºæ ¼æœ‰æ„ä¹‰ã€‚ç©ºæ ¼å’Œæ–­è¡Œå¯ä»¥å‡­ä½ çš„å–œå¥½æ·»åŠ ï¼Œå³ä½¿*ç†è®ºä¸Š*æ˜¯å¯è¡Œçš„ã€‚

åœ¨å®è·µä¸­ï¼Œä½ å¾ˆå¯èƒ½éµå®ˆè‰¯å¥½çš„é£æ ¼å’Œäººä»¬ä¹ ä»¥ä¸ºå¸¸çš„è§„åˆ™ï¼Œå¼ºåˆ¶ä½¿ç”¨ linter æˆ–è€… *Prettier* è¿™æ ·çš„é£æ ¼å·¥å…·ã€‚

æ¯”å¦‚ï¼Œæˆ‘å–œæ¬¢ç¼©è¿›ä¸¤ä¸ªå­—ç¬¦ã€‚

### å¤§å°å†™æ•æ„Ÿ

JavaScript æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚å˜é‡ `something` å’Œ `Somethin` æ˜¯ä¸åŒçš„ã€‚è¿™åœ¨ä»»ä½•æ ‡è¯†ç¬¦é‡Œéƒ½æ˜¯ä¸€è‡´çš„ã€‚

### æ³¨é‡Š

åœ¨ JavaScript é‡Œï¼Œæœ‰ä¸¤ç§æ³¨é‡Šæ–¹å¼ï¼š

```js
/* */
//
```

ç¬¬ä¸€ä¸ªå¯ä»¥è¿›è¡Œå¤šè¡Œæ³¨é‡Šå¹¶ä¸”éœ€è¦é—­åˆã€‚

ç¬¬äºŒä¸ªä¼šæ³¨é‡Šæ‰å½“å‰è¡Œä½äºå…¶å³ä¾§çš„æ‰€æœ‰å†…å®¹ã€‚

### å­—é¢é‡å’Œæ ‡è¯†ç¬¦

æˆ‘ä»¬å°†æºç é‡Œçš„å€¼å®šä¹‰ä¸º**å­—é¢é‡**ï¼Œä¾‹å¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼æˆ–è€…æ›´é«˜çº§çš„æ„é€ ï¼Œåƒå¯¹è±¡å­—é¢é‡æˆ–è€…æ•°ç»„å­—é¢é‡ï¼š

```js
5
'Test'
true
['a', 'b']
{color: 'red', shape: 'Rectangle'}
```

ä¸€ä¸ª**æ ‡è¯†ç¬¦**å¯ä»¥ç”¨æ¥è¯†åˆ«ä¸€ä¸ªå˜é‡ï¼Œä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªå¯¹è±¡ã€‚å®ƒå¯ä»¥ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å· `$`æˆ–è€…ä¸€ä¸ªä¸‹åˆ’çº¿ `_` å¼€å¤´ï¼Œå®ƒä¹Ÿå¯ä»¥åŒ…å«æ•°å­—ã€‚ä½¿ç”¨ Unicodeï¼Œå­—æ¯å¯ä»¥æ˜¯ä»»ä½•è¢«å…è®¸çš„å­—ç¬¦ï¼Œæ¯”å¦‚ emoji :smile:ã€‚

```js
Test
test
TEST
_test
Test1
$test
```

ç¾å…ƒç¬¦å·é€šå¸¸è¢«ç”¨æ¥åŒºåˆ† DOM å…ƒç´ ã€‚

### ä¿ç•™å­—

ä½ ä¸èƒ½ä½¿ç”¨ä¸‹åˆ—æ ‡è¯†ç¬¦ï¼Œå› ä¸ºä»–ä»¬æ˜¯è¯­è¨€ä¿ç•™å­—ã€‚

```js
break
do
instanceof
typeof
case
else
new
var
catch
finally
return
void
continue
for
switch
while
debugger
function
this
with
default
if
throw
delete
in
try
class
enum
extends
super
const
export
import
implements
let
private
public
interface
package
protected
static
yield
```

## å˜é‡

å˜é‡æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ç»‘å®šäº†ä¸€ä¸ªå­—é¢é‡ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨åç»­çš„ä»£ç é‡Œå¼•ç”¨å’Œä½¿ç”¨å®ƒã€‚æˆ‘ä»¬å°†ä¼šå­¦ä¹ å¦‚æœåœ¨ JavaScript é‡Œå£°æ˜ä¸€ä¸ªå˜é‡ã€‚

### ä»‹ç» JavaScript å˜é‡

å˜é‡æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ç»‘å®šäº†ä¸€ä¸ªå­—é¢é‡ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨åç»­çš„ä»£ç é‡Œå¼•ç”¨å’Œä½¿ç”¨å®ƒã€‚åœ¨ JavaScript é‡Œï¼Œå˜é‡æ²¡æœ‰ç»‘å®šä»»ä½•ç±»å‹ã€‚å³ä½¿ä½ ä¸ºä¸€ä¸ªå˜é‡ç»‘å®šäº†ä¸€ä¸ªç‰¹å®šçš„ç±»å‹ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨åé¢é‡æ–°ç»‘å®šå…¶å®ƒä»»ä½•ç±»å‹ï¼Œè¿™ä¸ä¼šé€ æˆç±»å‹é”™è¯¯æˆ–è€…å…¶å®ƒé—®é¢˜ã€‚

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™æåˆ° JavaScript ä¼šè¢«è®¤ä¸ºæ˜¯ â€œæ— ç±»å‹çš„â€ã€‚

å˜é‡å¿…é¡»åœ¨ä½ ç”¨åˆ°ä¹‹å‰å£°æ˜ã€‚æœ‰ä¸‰ç§å£°æ˜æ–¹æ³•ï¼šä½¿ç”¨ `var`, `let` æˆ–è€… `const`ã€‚è¿™ä¸‰ç§æ–¹å¼çš„ä¸åŒåœ¨äºåç»­ä½ å¦‚ä½•å’Œè¿™ä¸ªå˜é‡è¿›è¡Œäº¤äº’ã€‚

### ä½¿ç”¨ var

ç›´åˆ° ES2015, `var` æ˜¯å®šä¹‰å˜é‡çš„å”¯ä¸€æ–¹æ³•ã€‚

```js
var a = 0
```

å¦‚æœä½ å¿˜äº†åŠ  `var`ï¼Œä½ å°†ç»™æœªå£°æ˜çš„å˜é‡ç»‘å®šå€¼ï¼Œè¿™ä¸ªç»“æœå¯èƒ½ä¼šæœ‰ä¸åŒï¼šåœ¨ç°ä»£ç¯å¢ƒé‡Œï¼Œå¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ ·ä¼šæŠ¥é”™ã€‚åœ¨æ—§ç¯å¢ƒé‡Œï¼ˆæˆ–è€…å…³é—­ä¸¥æ ¼æ¨¡å¼ï¼‰ï¼Œè¿™æ ·ä¼šåˆå§‹åŒ–ä¸€ä¸ªå˜é‡å¹¶æŠŠå®ƒç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚

å¦‚æœä½ å£°æ˜å˜é‡æ—¶æ²¡æœ‰åˆå§‹åŒ–ï¼Œå®ƒä¼šè·å¾—ä¸€ä¸ª `undefined` å€¼ç›´åˆ°ä½ ä¸ºå®ƒç»‘å®šä¸€ä¸ªå€¼ã€‚

```js
var a //typeof a === 'undefined'
```

ä½ å¯ä»¥é‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ï¼Œé‡å†™å®ƒçš„å€¼ï¼š

```js
var a = 1
var a = 2
```

ä½ å¯ä»¥ä¸€æ¬¡æ€§å£°æ˜å¤šä¸ªå˜é‡ï¼š

```js
var a = 1, b = 2
```

ä»£ç çš„**ä½œç”¨åŸŸ**æ˜¯å˜é‡å¯è§çš„èŒƒå›´ã€‚

åœ¨ä»»ä½•å‡½æ•°å¤–éƒ¨é€šè¿‡ `var` åˆå§‹åŒ–çš„å˜é‡ä¼šç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼Œæ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸï¼Œåœ¨ä»»ä½•ä½ç½®éƒ½å¯ç”¨ã€‚åœ¨å‡½æ•°å†…éƒ¨é€šè¿‡ `var` åˆå§‹åŒ–çš„å˜é‡ä¼šç»‘å®šåœ¨è¿™ä¸ªå‡½æ•°å†…ï¼Œä»…åœ¨å‡½æ•°å†…éƒ¨å¯ç”¨ï¼Œå°±å’Œå‡½æ•°çš„å‚æ•°ä¸€æ ·ã€‚

é‡è¦çš„æ˜¯è¦äº†è§£ä¸€ä¸ªå—ï¼ˆç”¨ä¸€å¯¹èŠ±æ‹¬å·åŒºåˆ†ï¼‰æ²¡æœ‰å®šä¹‰ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸã€‚æ–°ä½œç”¨åŸŸåªä¼šéšç€å‡½æ•°çš„åˆ›å»ºè¢«åˆ›å»ºï¼Œå› ä¸º `var` æ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œåªæœ‰å‡½æ•°ä½œç”¨åŸŸã€‚

åœ¨å‡½æ•°å†…éƒ¨ï¼Œå…¶ä¸­å®šä¹‰çš„ä»»ä½•å˜é‡åœ¨å‡½æ•°ä»£ç é‡Œéƒ½æ˜¯å¯è§çš„ï¼Œå³ä½¿æ˜¯å®šä¹‰åœ¨å°¾éƒ¨çš„å˜é‡ä¹Ÿä¼šåœ¨å‡½æ•°å¤´éƒ¨è¢«å¼•å…¥ï¼Œè¿™æ˜¯å› ä¸º JavaScript ä¼š*è‡ªåŠ¨å°†æ‰€æœ‰å˜é‡ç§»åŠ¨åˆ°é¡¶éƒ¨*ï¼ˆå³**å˜é‡æå‡**ï¼‰ã€‚ä¸ºäº†é¿å…é€ æˆå›°æ‰°ï¼Œå§‹ç»ˆåœ¨å‡½æ•°å¤´éƒ¨å£°æ˜å˜é‡ã€‚

### ä½¿ç”¨ let

`let` æ˜¯ ES2015 é‡Œå¼•å…¥çš„æ–°ç‰¹æ€§ï¼Œæœ¬è´¨ä¸Šæ˜¯æ‹¥æœ‰å—çº§ä½œç”¨åŸŸçš„ `var`ã€‚ä»–çš„ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨å®šä¹‰å®ƒçš„å—ï¼Œè¯­å¥æˆ–è€…è¡¨è¾¾å¼ï¼Œä»¥åŠæ‰€æœ‰åŒ…å«çš„å†…éƒ¨å—ã€‚

ç°ä»£ JavaScript å¼€å‘è€…å¯èƒ½ä¼šåªç”¨ `let` è€Œå®Œå…¨æ”¾å¼ƒä½¿ç”¨ `var`ã€‚

> å¦‚æœ `let` çœ‹èµ·æ¥æ˜¯ä¸ªæ¨¡ç³Šçš„æœ¯è¯­ï¼Œå°±çœ‹çœ‹ `let color = 'red'`ï¼Œè®©é¢œè‰²å˜æˆçº¢è‰²ï¼Œè¿™æ ·å®¹æ˜“æ˜ç™½å¾—å¤šã€‚

åœ¨å‡½æ•°å¤–éƒ¨ä½¿ç”¨ `let`ï¼Œå’Œ `var` ç›¸åï¼Œæ²¡æœ‰åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚

### ä½¿ç”¨ const

ç”¨ `var` æˆ–è€… `let` å£°æ˜çš„å˜é‡å¯ä»¥åœ¨åé¢è¿›è¡Œæ›´æ”¹å’Œé‡ç»‘å®šã€‚ä¸€æ—¦ `const` è¢«åˆå§‹åŒ–ï¼Œå®ƒçš„å€¼å°†ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä¹Ÿä¸èƒ½ç»‘å®šå…¶å®ƒçš„å€¼ã€‚

```js
const a = 'test'
```

æˆ‘ä»¬ä¸èƒ½ä¸º `a` ç»‘å®šä¸åŒçš„å€¼ã€‚ç„¶è€Œï¼Œå¦‚æœ `a` æ˜¯ä¸€ä¸ªæä¾›æ”¹å˜å…¶å†…å®¹çš„æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æ”¹å˜å®ƒã€‚

`const` ä¸æä¾›ä¸å˜æ€§ï¼Œåªèƒ½ç¡®ä¿ä¸ä¼šæ›´æ”¹å¼•ç”¨ã€‚

`const` å’Œ `let` ä¸€æ ·ï¼Œæä¾›å—çº§ä½œç”¨åŸŸã€‚

ç°åœ¨ JavaScript å¼€å‘è€…å¯èƒ½ä¼šé€‰æ‹© `const` ä½œä¸ºå£°æ˜å°†æ¥ä¸éœ€è¦é‡æ–°ç»‘å®šçš„å˜é‡çš„æ ‡è¯†ç¬¦ã€‚

> ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬åº”è¯¥å§‹ç»ˆä½¿ç”¨æœ€ç®€å•çš„æ„é€ å˜é‡é¿å…å‘ç”Ÿé”™è¯¯ã€‚

## ç±»å‹

æœ‰æ—¶ä½ ä¼šè¯»åˆ° JS æ˜¯æ— ç±»å‹çš„ï¼Œä½†æ˜¯è¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ä½ å¯ä»¥ä¸ºä¸€ä¸ªå˜é‡ç»‘å®šä¸åŒçš„ç±»å‹æ˜¯ç¡®å®å­˜åœ¨çš„ï¼Œä½†æ˜¯ JavaScript æ˜¯æœ‰ç±»å‹çš„ã€‚å®ƒæä¾›äº†åŸºæœ¬ç±»å‹å’Œå¯¹è±¡ç±»å‹ã€‚

### åŸºæœ¬ç±»å‹

åŸå§‹ç±»å‹æœ‰ï¼š

- Numbers
- Strings
- Booleans

è¿˜æœ‰ä¸¤ä¸ªç‰¹åˆ«ç±»å‹ï¼š

- null
- undefined

è®©æˆ‘ä»¬åœ¨ä¸‹ä¸ªç« èŠ‚æ·±å…¥äº†è§£ä»–ä»¬ã€‚

#### Numbers

åœ¨è¯­è¨€å†…éƒ¨ï¼ŒJavaScript åªæœ‰ä¸€ç§æ•°å­—ç±»å‹ï¼šæ‰€æœ‰æ•°å­—éƒ½æ˜¯æµ®ç‚¹å‹ã€‚

ä¸€ä¸ªæ•°å­—å­—é¢é‡æ˜¯æºç é‡Œè¡¨ç¤ºçš„æ•°å­—ï¼Œamd å–å†³äºå®ƒçš„ç¼–å†™æ–¹å¼ï¼Œå®ƒå¯ä»¥æ˜¯æ•´å‹å­—é¢é‡æˆ–è€…æ˜¯æµ®ç‚¹å‹å­—é¢é‡ã€‚

æ•´å‹ï¼š

```js
10
5354576767321
0xCC //hex
```

æµ®ç‚¹å‹ï¼š

```js
3.14
.1234
5.2e4 //5.2 * 10^4
```

#### strings

å­—ç¬¦ä¸²ç±»å‹æ˜¯ä¸€ç³»åˆ—å­—ç¬¦ã€‚åœ¨æºç é‡Œï¼Œå®ƒè¢«å®šä¹‰æˆå­—ç¬¦ä¸²å­—é¢é‡ï¼Œç”¨å•å¼•å·æˆ–è€…åŒå¼•å·åŒ…è£¹ã€‚

```js
'A string'
"Another string"
```

å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡åæ–œæ è·¨è¶Šå¤šè¡Œï¼š

```js
"A \
string"
```

å­—ç¬¦ä¸²å¯ä»¥åŒ…å«è½¬ä¹‰åºåˆ—ï¼Œåœ¨æ‰“å°å­—ç¬¦ä¸²æ—¶è§£é‡Šï¼Œä¾‹å¦‚ \n ç”¨æ¥æ¢è¡Œã€‚å½“ä½ éœ€è¦é˜²æ­¢å­—ç¬¦è¢«è¯¯è§£ä¸ºé—­åˆå¼•å·æ—¶ï¼Œåæ–œæ ä¹Ÿå¾ˆæœ‰ç”¨ï¼š

```js
'I\'m a developer'
```

å­—ç¬¦ä¸²å¯ä»¥ç”¨ + æ“ä½œç¬¦æ‹¼æ¥ï¼š

```js
"A " + "string"
```

#### æ¨¡æ¿å­—ç¬¦ä¸²

åœ¨ ES2015 å¼•å…¥ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å…è®¸ç”¨æ›´å¼ºå¤§çš„æ–¹æ³•å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ã€‚

```js
`a string`
```

ä½ å¯ä»¥åµŒå…¥ä»»ä½• JavaScript è¡¨è¾¾å¼å¹¶æ›¿æ¢æ‰§è¡Œåçš„ç»“æœï¼š

```js
`a string with ${something}`
`a string with ${something+somethingElse}`
`a string with ${obj.something()}`
```

ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„è·å¾—å¤šè¡Œå­—ç¬¦ä¸²ï¼š

```js
`a string
with
${something}`
```

#### Booleans

å¯¹äºå¸ƒå°”å‹ï¼ŒJavaScript æœ‰ä¸¤ä¸ªä¿ç•™å­—ï¼štrue å’Œ falseã€‚å¤§å¤šæ•°æ¯”è¾ƒè¿ç®—ç¬¦ `==` `===` `>` `<` ç­‰ç­‰éƒ½è¿”å›å…¶ä¸­çš„ä¸€ä¸ªã€‚

`if`ï¼Œ`while` è¯­å¥å’Œå…¶å®ƒæ§åˆ¶ç»“æ„ä½¿ç”¨å¸ƒå°”å€¼å†³å®šç¨‹åºçš„æµç¨‹ã€‚

ä»–ä»¬ä¸ä»…æ¥å— true å’Œ fasleï¼Œä¹Ÿä¼šæ¥å— **truthy** å’Œ **falsy** çš„å€¼ã€‚

Falsyï¼Œå€¼è¢«è§£é‡Šä¸º **false**ï¼š

```js
0
-0
NaN
undefined
null
'' //empty string
```

å…¶ä½™çš„éƒ½å±äº **truthy**ã€‚

#### null

`null` æ˜¯ä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œè¡¨ç¤ºæ²¡æœ‰å€¼ã€‚è¿™åœ¨å…¶å®ƒè¯­è¨€é‡Œä¹Ÿæ˜¯æ™®éçš„è§‚å¿µï¼Œæ¯”å¦‚ `nil` æˆ–è€… Python é‡Œçš„ `None`ã€‚

#### undefined

`undefined` è¡¨ç¤ºå˜é‡è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œå€¼ä¸ºç©ºã€‚

å‡½æ•°é‡Œæ²¡æœ‰ `return` å€¼æ—¶å°±ä¼šè¿”å› `undefined`ã€‚å½“å‡½æ•°å‚æ•°æ²¡æœ‰è¢«è°ƒç”¨è€…èµ‹å€¼æ—¶ï¼Œä¹Ÿæ˜¯ undefinedã€‚

æ£€æµ‹ä¸€ä¸ªå€¼æ˜¯å¦ä¸º `undefined`ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼š

```js
typeof variable === 'undefined'
```

### å¯¹è±¡ç±»å‹

æ‰€æœ‰ä¸æ˜¯åŸºæœ¬ç±»å‹çš„éƒ½æ˜¯å¯¹è±¡ç±»å‹ã€‚

å‡½æ•°ï¼Œæ•°ç»„å’Œæˆ‘ä»¬å«åšå¯¹è±¡çš„éƒ½æ˜¯å¯¹è±¡ç±»å‹ã€‚å®ƒä»¬æœ¬èº«æ˜¯ç‰¹æ®Šçš„ï¼Œä½†æ˜¯å®ƒä»¬ç»§æ‰¿äº† objects çš„å¾ˆå¤šç‰¹æ€§ï¼Œæ¯”å¦‚å…·æœ‰ç‰¹æ€§å’Œä½¿ç‰¹æ€§ç”Ÿæ•ˆçš„æ–¹æ³•ã€‚

## è¡¨è¾¾å¼

è¡¨è¾¾å¼æ˜¯å¯ä»¥æ‰§è¡Œå¹¶è§£æä¸ºå€¼çš„ä»£ç å•å…ƒã€‚JS ä¸­çš„è¡¨è¾¾å¼å¯ä»¥åˆ†ä¸ºå‡ ç±»ã€‚

### ç®—æœ¯è¡¨è¾¾å¼

è¿™ä¸ªåˆ†ç±»ä¸‹æ‰€æœ‰è¡¨è¾¾å¼å¯¹æ•°å­—è¿›è¡Œæ±‚å€¼ï¼š

```js
1 / 2
i++
i -= 2
i * 2
```

### å­—ç¬¦ä¸²è¡¨è¾¾å¼

å¯¹å­—ç¬¦ä¸²æ±‚å€¼ï¼š

```js
'A ' + 'string'
'A ' += 'string'
```

### åŸå§‹è¡¨è¾¾å¼

è¿™ä¸ªåˆ†ç±»ä¸‹ï¼Œæ˜¯å˜é‡å¼•ç”¨ï¼Œå­—é¢é‡å’Œå¸¸é‡ï¼š

```js
2
0.02
'something'
true
false
this //the current object
undefined
i //where i is a variable or a constant
```

ä¹Ÿæœ‰ä¸€äº›è¯­è¨€å…³é”®å­—ï¼š

```js
function
class
function* //the generator function
yield //the generator pauser/resumer
yield* //delegate to another generator or iterator
async function* //async function expression
await //async function pause/resume/wait for completion
/pattern/i //regex
() // grouping
```

### æ•°ç»„å’Œå¯¹è±¡åˆå§‹è¡¨è¾¾å¼

```js
[] //array literal
{} //object literal
[1,2,3]
{a: 1, b: 2}
{a: {b: 1}}
```

### é€»è¾‘è¡¨è¾¾å¼

é€»è¾‘è¡¨è¾¾å¼ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ï¼Œè·å¾—ä¸€ä¸ªå¸ƒå°”å€¼ï¼š

```js
a && b
a || b
!a
```

### Left-hand-side è¡¨è¾¾å¼

```js
new //create an instance of a constructor
super //calls the parent constructor
...obj //expression using the spread operator
```

### å±æ€§è®¿é—®è¡¨è¾¾å¼

```js
object.property //reference a property (or method) of an object
object[property]
object['property']
```

### å¯¹è±¡æ„é€ è¡¨è¾¾å¼

```js
new object()
new a(1)
new MyRectangle('name', 2, {a: 4})
```

### å‡½æ•°å®šä¹‰è¡¨è¾¾å¼

```js
function() {}
function(a, b) { return a * b }
(a, b) => a * b
a => a * 2
() => { return 2 }
```

### è°ƒç”¨è¡¨è¾¾å¼

```js
a.x(2)
window.resize()
```

## åŸå‹ç»§æ‰¿

JavaScript åœ¨æµè¡Œç¼–ç¨‹è¯­è¨€é¢†åŸŸæ˜¯ä¸€ä¸ªéå¸¸ç‹¬ç‰¹çš„å­˜åœ¨ï¼ŒåŸå› åœ¨äºå¯¹åŸå‹ç»§æ‰¿çš„ä½¿ç”¨ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆæ„æ€ã€‚

å¤§å¤šæ•°é¢å‘å¯¹è±¡è¯­è¨€éƒ½æ˜¯åŸºäºç±»ç»§æ‰¿æ¨¡å¼ï¼ŒJavaScript åŸºäºåŸå‹ç»§æ‰¿ã€‚

è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

æ¯ä¸€ä¸ª JavaScript å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œç§°ä½œ `prototype`ï¼ŒæŒ‡å‘ä¸åŒçš„å¯¹è±¡ã€‚

è¿™ä¸ªä¸åŒçš„å¯¹è±¡å°±æ˜¯**åŸå‹å¯¹è±¡**ã€‚

æˆ‘ä»¬çš„å¯¹è±¡ä¼šç»§æ‰¿åŸå‹å¯¹è±¡çš„ç‰¹æ€§å’Œæ–¹æ³•ã€‚

å‡è®¾ä½ é€šè¿‡å¯¹è±¡å­—é¢é‡è¯­æ³•åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼š

```js
const car = {}
```

æˆ–è€…é€šè¿‡ `new Object` åˆ›å»ºï¼š

```js
const car = new Object()
```

æ— è®ºå“ªä¸€ç§æ–¹æ³•ï¼Œ`car` çš„åŸå‹éƒ½æ˜¯ `Object`ã€‚

åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼š

```js
const list = []
//or
const list = new Array()
```

è¿™ä¸ªçš„åŸå‹æ˜¯ `Array`ã€‚

ä½ å¯ä»¥é€šè¿‡ `__proto__` å±æ€§éªŒè¯ï¼š

```js
car.__proto__ == Object.prototype //true
car.__proto__ == new Object().__proto__ //true
list.__proto__ == Object.prototype //false
list.__proto__ == Array.prototype //true
list.__proto__ == new Array().__proto__ //true
```

> è¿™é‡Œçš„ `__proto__` å±æ€§ä¸æ˜¯æ ‡å‡†çš„ä½†æ˜¯åœ¨æµè§ˆå™¨é‡Œè¢«å¹¿æ³›å®ç°ã€‚ä¸€ä¸ªæ›´å¯é çš„è·å¾—åŸå‹çš„æ–¹æ³•æ˜¯ `Object.getPrototypeOf(new Object())`ã€‚

åŸå‹ä¸Šæ‰€æœ‰çš„ç‰¹æ€§å’Œæ–¹æ³•åœ¨å…·æœ‰è¯¥åŸå‹çš„å¯¹è±¡ä¸Šéƒ½æ˜¯å¯ç”¨çš„ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d77c10146138?w=587&h=481&f=png&s=27828)

`Object.prototype` æ˜¯æ‰€æœ‰å¯¹è±¡çš„åŸå‹ã€‚

```js
Array.prototype.__proto__ == Object.prototype
```

å¦‚æœä½ æƒ³çŸ¥é“ Object.prototype çš„åŸå‹æ˜¯ä»€ä¹ˆï¼Œå®ƒæ²¡æœ‰åŸå‹ã€‚è¿™æ˜¯ä¸€ç‰‡ç‰¹æ®Šçš„é›ªèŠ±ã€‚â„ï¸

ä¸Šé¢çš„ä¾‹å­æ˜¯**åŸå‹é“¾**çš„ç¤ºä¾‹ã€‚

æˆ‘å¯ä»¥åˆ›å»ºä¸€ä¸ªæ‰©å±• Array å’Œä»»ä½•å®ä¾‹åŒ–å¯¹è±¡çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šä¼šæœ‰ Array å’Œ Objectï¼Œå®ƒä¼šç»§æ‰¿æ‰€æœ‰ç¥–å…ˆçš„ç‰¹æ€§å’Œæ–¹æ³•ã€‚

é™¤äº†ç”¨ `new` åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…ç”¨å¯¹è±¡å’Œæ•°ç»„çš„å­—é¢é‡è¯­æ³•ï¼Œä½ è¿˜å¯ä»¥ç”¨ `Object.create()` å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ã€‚

ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå¯¹è±¡çš„åŸå‹ï¼š

```js
const car = Object.create({})
const list = Object.create(Array)
```

ä½ å¯ä»¥ç”¨ `isPrototypeOf()` æ–¹æ³•æ£€æŸ¥è¿™ä¸ªå¯¹è±¡çš„åŸå‹ï¼š

```js
Array.isPrototypeOf(list) //true
```

æ³¨æ„ï¼Œå› ä¸ºä½ å¯ä»¥è¿™æ ·å®ä¾‹åŒ–æ•°ç»„ï¼š

```js
const list = Object.create(Array.prototype)
```

å› æ­¤ï¼Œ`Array.isPrototypeOf(list)` ç­‰äº falseï¼Œè€Œ `Array.prototype.isPrototypeOf(list)` ç­‰äº trueã€‚

## ç±»

åœ¨ 2015 å¹´å‘å¸ƒçš„ ECMAScript 6 (ES6) æ ‡å‡†å¼•å…¥äº†ç±»ã€‚

åœ¨é‚£ä¹‹å‰ï¼ŒJavaScript åªèƒ½é€šè¿‡ä¸€ä¸ªååˆ†å¥‡æ€ªçš„æ–¹æ³•å®ç°ç»§æ‰¿ã€‚é‚£å°±æ˜¯åŸå‹ç»§æ‰¿ï¼Œæˆ‘è®¤ä¸ºè¿™å¾ˆç¥å¥‡ï¼Œå’Œå…¶å®ƒçš„æµè¡Œè¯­è¨€éƒ½ä¸åŒã€‚

ä» Java æˆ–è€… Python æˆ–è€…å…¶å®ƒè¯­è¨€æ¥çš„äººä»¬å¾ˆéš¾ç†è§£åŸå‹ç»§æ‰¿çš„å¤æ‚æ€§ï¼Œå› æ­¤ï¼ŒECMAScript å§”å‘˜ä¼šå†³å®šåŸºäºæ­¤å¼•å…¥è¯­æ³•ç³–ï¼Œç±»ä¼¼äºå…¶å®ƒè¯­è¨€çš„å®ç°æ–¹æ³•ã€‚

è¿™å¾ˆé‡è¦ï¼šJavaScript åº•å±‚ä»ç„¶å’Œä¹‹å‰ä¸€æ ·ï¼Œä½ å¯ä»¥ä»¥ä¸€ç§æ™®é€‚çš„æ–¹æ³•è®¿é—®åŸå‹å¯¹è±¡ã€‚

### å®šä¹‰ç±»

ç±»çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š

```js
class Person {
  constructor(name) {
    this.name = name
  }
  hello() {
    return 'Hello, I am ' + this.name + '.'
  }
}
```

ç±»æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡ `new ClassIdentifier()` åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚

å½“è¿™ä¸ªå¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä¼šè°ƒç”¨ `constructor` æ–¹æ³•ï¼Œå¯ä»¥ä¼ é€’ä»»ä½•å‚æ•°ã€‚

ä¸€ä¸ªç±»å¯ä»¥æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ `hello` æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€æœ‰ä»è¿™ä¸ªç±»æ´¾ç”Ÿçš„å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨å®ƒï¼š

```js
const flavio = new Person('Flavio')
flavio.hello()
```

### ç±»ç»§æ‰¿

ç±»å¯ä»¥æ‰©å±•å¦ä¸€ä¸ªç±»ï¼Œä½¿ç”¨è¯¥ç±»åˆå§‹åŒ–çš„å¯¹è±¡ç»§æ‰¿è¿™ä¸¤ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚

å¦‚æœç»§æ‰¿çš„ç±»å’Œæ›´é«˜ä¸€çº§çš„ç±»æœ‰åŒåçš„æ–¹æ³•ï¼Œåˆ™æŒ‰æœ€è¿‘ä¼˜å…ˆçš„åŸåˆ™è°ƒç”¨ï¼š

```js
class Programmer extends Person {
  hello() {
    return super.hello() + ' I am a programmer.'
  }
}
const flavio = new Programmer('Flavio')
flavio.hello()
```

ä¸Šé¢çš„ç¨‹åºä¼šæ‰“å°å‡ºï¼šâ€œ*Hello, I am Flavio. I am a programmer.*â€ã€‚

ç±»æ²¡æœ‰æ˜¾å¼åœ°å£°æ˜å˜é‡ï¼Œä½†æ˜¯å¿…é¡»è¦åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–å˜é‡ã€‚

åœ¨ç±»ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨ `super()` å¼•å…¥çˆ¶ç±»ã€‚

### é™æ€æ–¹æ³•

é€šå¸¸æ¥è®²ï¼Œæ–¹æ³•å®šä¹‰åœ¨å®ä¾‹ä¸Šï¼Œè€Œä¸æ˜¯ç±»ä¸Šã€‚

è€Œé™æ€æ–¹æ³•èƒ½åœ¨ç±»ä¸Šæ‰§è¡Œï¼š

```js
class Person {
  static genericHello() {
    return 'Hello'
  }
}
Person.genericHello() //Hello
```

### ç§æœ‰æ–¹æ³•

JavaScript æ²¡æœ‰å†…ç½®å®šä¹‰ç§æœ‰æ–¹æ³•æˆ–è€…ä¿æŠ¤æ–¹æ³•çš„æ‰‹æ®µã€‚æœ‰è§£å†³æ–¹æ³•ï¼Œä½†æ˜¯è¿™é‡Œå°†ä¸å†èµ˜è¿°ã€‚

### Getters å’Œ Setters

ä½ å¯ä»¥æ·»åŠ  `get` æˆ–è€… `set` å‰ç¼€åˆ›å»ºä¸€ä¸ª getter å’Œ setterï¼Œç”¨å“ªä¸€ç§æ–¹æ³•å–å†³äºä½ æƒ³åšä»€ä¹ˆï¼šè®¿é—®å˜é‡æˆ–è€…ä¿®æ”¹å˜é‡çš„å€¼ã€‚

```js
class Person {
  constructor(name) {
    this.name = name
  }
  set name(value) {
    this.name = value
  }
  get name() {
    return this.name
  }
}
```

å¦‚æœå±æ€§åªæœ‰ä¸€ä¸ª getterï¼Œè¿™ä¸ªå±æ€§å°±ä¸èƒ½è¢«è®¾ç½®ï¼Œæ‰€æœ‰çš„ä¿®æ”¹éƒ½ä¼šè¢«å¿½ç•¥ï¼š

```js
class Person {
  constructor(name) {
    this.name = name
  }
  get name() {
    return this.name
  }
}
```

å¦‚æœå±æ€§åªæœ‰ä¸€ä¸ª setterï¼Œä½ å¯ä»¥éšæ„ä¿®æ”¹å®ƒçš„å€¼ï¼Œä½†æ˜¯ä¸èƒ½ä»å¤–éƒ¨è®¿é—®å®ƒï¼š

```js
class Person {
  constructor(name) {
    this.name = name
  }
  set name(value) {
    this.name = value
  }
}
```

## å¼‚å¸¸

å½“ä»£ç å‘ç”Ÿæ„å¤–é”™è¯¯æ—¶ï¼ŒJavaScript ä¹ æƒ¯é€šè¿‡ exceptions å¤„ç†é”™è¯¯ã€‚

### åˆ›å»ºå¼‚å¸¸

é€šè¿‡å…³é”®å­— `throw` åˆ›å»ºå¼‚å¸¸ï¼š

```js
throw value
```

`value` å¯ä»¥æ˜¯ä»»æ„çš„ JavaScript å€¼ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ï¼Œæ•°å­—æˆ–è€…ä¸€ä¸ªå¯¹è±¡ã€‚

å½“ JavaScript ä»£ç æ‰§è¡Œåˆ°è¿™ä¸€è¡Œï¼Œå°±ä¼šæš‚åœæ­£å¸¸çš„ç¨‹åºæµç¨‹ï¼Œæ§åˆ¶ä¼šè·³è½¬åˆ°æœ€è¿‘çš„**å¼‚å¸¸å¤„ç†å™¨**ã€‚

### å¤„ç†å¼‚å¸¸

å¼‚å¸¸å¤„ç†å™¨æ˜¯ `try/catch` è¯­å¥ã€‚

`try` ä»£ç å—å†…æŠ›å‡ºçš„å¼‚å¸¸éƒ½ä¼šåœ¨ç›¸åº”çš„ `catch` ä¸­å¤„ç†ï¼š

```js
try {
  //lines of code
} catch (e) {

}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`e` ä»£è¡¨å¼‚å¸¸å€¼ã€‚

ä½ å¯ä»¥æ·»åŠ å¤šä¸ªå¤„ç†å™¨ï¼Œå®ƒä»¬å¯ä»¥æ•æ‰ä¸åŒçš„é”™è¯¯ã€‚

### finally

ä¸ºäº†å®Œæˆæ•´ä¸ªä»£ç è¯­å¥ï¼ŒJavaScript æœ‰å¦ä¸€ä¸ªè¯­å¥ï¼Œ`finally`ï¼Œä¸ç®¡ç¨‹åºæµç¨‹å¦‚ä½•ï¼Œå¼‚å¸¸æ˜¯å¦è¢«å¤„ç†ï¼Œæ˜¯å¦äº§ç”Ÿå¼‚å¸¸ï¼Œå…¶ä¸­çš„ä»£ç éƒ½ä¼šæ‰§è¡Œï¼š

```js
try {
  //lines of code
} catch (e) {

} finally {

}
```

ä½ ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰ `catch` çš„æƒ…å†µä¸‹ä½¿ç”¨ `finally`ï¼Œä»¥æ¸…é™¤å¯èƒ½åœ¨ `try`ä¸­æ‰“å¼€çš„ä»»ä½•èµ„æºï¼Œæ¯”å¦‚æ–‡ä»¶æˆ–è€…ç½‘ç»œè¯·æ±‚ï¼š

```js
try {
  //lines of code
} finally {
}
```

### åµŒå¥— try ä»£ç å—

`try` å¯ä»¥è¢«åµŒå¥—ä½¿ç”¨ï¼Œå¼‚å¸¸å§‹ç»ˆåœ¨æœ€è¿‘çš„ catch å—ä¸­è¢«å¤„ç†ï¼š

```js
try {
  //lines of code
  try {
    //other lines of code
  } finally {
    //other lines of code
  }
} catch (e) {

}
```

å¦‚æœåœ¨å†…éƒ¨çš„ `try`ä¸­å‘ç°å¼‚å¸¸ï¼Œå®ƒä¼šåœ¨å¤–éƒ¨çš„ `catch`ä¸­è¢«å¤„ç†ã€‚

## åˆ†å·

JavaScript åˆ†å·æ˜¯å¯é€‰çš„ï¼Œæˆ‘ä¸ªäººå€¾å‘äºä¸å†™åˆ†å·ï¼Œä½†æ˜¯å¾ˆå¤šäººå–œæ¬¢å¸¦ä¸Šåˆ†å·ã€‚

åˆ†å·åœ¨ JavaScript ç¤¾åŒºä¸­äº§ç”Ÿäº†å¾ˆå¤§çš„åˆ†æ­§ã€‚ä¸€äº›äººä¸è®ºåœ¨ä»€ä¹ˆæƒ…å†µéƒ½å¾ˆå–œæ¬¢ç”¨å®ƒï¼Œè€Œå¦ä¸€éƒ¨åˆ†åˆ™ç›¸åã€‚

åœ¨ç”¨äº†å‡ å¹´åˆ†å·ä¹‹åï¼Œ2017 å¹´ç§‹å¤©æˆ‘å†³å®šå°è¯•é¿å…ä½¿ç”¨åˆ†å·ï¼Œæˆ‘é€šè¿‡ Prettier è‡ªåŠ¨ç§»é™¤ä»£ç ä¸­çš„åˆ†å·ï¼Œé™¤éæœ‰ç‰¹å®šçš„ä»£ç æ„é€ éœ€è¦å®ƒã€‚

ç°åœ¨æˆ‘å¾ˆè‡ªç„¶å°±ä¼šé¿å…åˆ†å·ï¼Œæˆ‘è®¤ä¸ºä»£ç çœ‹èµ·æ¥æ›´ä¼˜ç§€ï¼Œä¹Ÿæ›´æ˜“è¯»äº†ã€‚

å› ä¸º JavaScript ä¸å¼ºåˆ¶è¦æ±‚ä½¿ç”¨åˆ†å·ï¼Œæ‰€ä»¥ä¸‡äº‹çš†æœ‰å¯èƒ½ã€‚å½“ä¸€ä¸ªä½ç½®éœ€è¦åˆ†å·ï¼Œå®ƒä¼šè‡ªåŠ¨æ·»åŠ ã€‚

æ‰§è¡Œæ­¤æ“ä½œçš„è¿‡ç¨‹æˆä¸º**è‡ªåŠ¨æ’å…¥åˆ†å·**ã€‚

äº†è§£ä½¿ç”¨åˆ†å·çš„è§„åˆ™éå¸¸é‡è¦ï¼Œå¯ä»¥é¿å…ç¼–å†™ä¸é¢„æœŸè¡Œä¸ºä¸ä¸€è‡´çš„é”™è¯¯ä»£ç ã€‚

### JavaScript è‡ªåŠ¨æ’å…¥åˆ†å·è§„åˆ™

åœ¨è§£é‡Šæºç æœŸé—´ï¼Œå‘ç°ä¸€ä¸‹ç‰¹å®šæƒ…å†µï¼ŒJavaScript è§£é‡Šå™¨ä¼šè‡ªåŠ¨æ·»åŠ åˆ†å·ï¼š

- å½“ä¸‹ä¸€è¡Œçš„èµ·å§‹ä»£ç æ‰“æ–­äº†å½“å‰è¡Œï¼ˆä»£ç å¯èƒ½æ˜¯å¤šè¡Œçš„ï¼‰
- å½“ä¸‹ä¸€è¡Œä»£ç ä»¥ `}` å¼€å¤´ï¼Œé—­åˆäº†å½“å‰ä»£ç å—
- å½“æ‰§è¡Œåˆ°æºä»£ç æœ«å°¾
- å½“å‰è¡Œæœ‰ `return` è¯­å¥
- å½“å‰è¡Œæœ‰ `break` è¯­å¥
- å½“å‰è¡Œæœ‰ `throw` è¯­å¥
- å½“å‰è¡Œæœ‰ `continue` è¯­å¥

### ä»£ç è¡Œä¸ºä¸ä¸€è‡´çš„ä¾‹å­

åŸºäºä¸Šé¢çš„è§„åˆ™ï¼Œè¿™æœ‰ä¸€äº›å…¶å®ƒä¾‹å­ï¼Œæ¯”å¦‚ï¼š

```js
const hey = 'hey'
const you = 'hey'
const heyYou = hey + ' ' + you
['h', 'e', 'y'].forEach((letter) => console.log(letter))
```

ä½ ä¼šçœ‹åˆ°é”™è¯¯ `Uncaught TypeError: Cannot read property 'forEach' of undefined`ï¼Œå› ä¸ºè§„åˆ™ `1` å°è¯•æŠŠä»£ç è§£é‡Šä¸ºï¼š

```js
const hey = 'hey';
const you = 'hey';
const heyYou = hey + ' ' + you['h', 'e', 'y'].forEach((letter) => console.log(letter))
```

è¿˜æœ‰ï¼š

```js
(1 + 2).toString() // 3
```

```js
const a = 1
const b = 2
const c = a + b
(a + b).toString()
```

ç›¸åï¼Œä¸Šé¢çš„ä»£ç æŠ›å‡º `TypeError: b is not a function` å¼‚å¸¸ï¼Œå› ä¸º JavaScript å°è¯•æŠŠå®ƒè§£é‡Šä¸ºï¼š

```js
const a = 1
const b = 2
const c = a + b(a + b).toString()
```

å¦ä¸€ä¸ªå…³äºè§„åˆ™ 4 çš„ä¾‹å­ï¼š

```js
(() => {
  return
  {
    color: 'white'
  }
})()
```

ä½ å¸Œæœ›è¿™ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªåŒ…å« `color` å±æ€§çš„å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰ã€‚å®ƒè¿”å›çš„æ˜¯ `undefined`ï¼Œå› ä¸º JavaScript ä¼šåœ¨ `return` åæ’å…¥ä¸€ä¸ªåˆ†å·ã€‚

æ­£ç¡®çš„åšæ³•æ˜¯æŠŠèŠ±æ‹¬å·æ”¾åœ¨ `return` çš„åé¢ï¼š

```js
(() => {
  return {
    color: 'white'
  }
})()
```

ä½ è®¤ä¸ºè¿™ä¸ªä»£ç ä¼šå¼¹å‡º 0ï¼š

```js
1 + 1
-1 + 1 === 0 ? alert(0) : alert(2)
```

ä½†æ˜¯å®ƒæ˜¾ç¤ºçš„æ˜¯ 2ï¼Œå› ä¸ºè§„åˆ™ 1 æŠŠå®ƒè§£é‡Šæˆï¼š

```js
1 + 1 -1 + 1 === 0 ? alert(0) : alert(2)
```

å°å¿ƒç‚¹ã€‚æœ‰äº›äººå¯¹å¾…åˆ†å·å¾ˆåæ‰§ï¼Œæˆ‘æ˜¯æ— æ‰€è°“ï¼Œè¿™ä¸ªå·¥å…·æ—¢ç„¶ç»™äº†æˆ‘ä»¬ä¸ç”¨åˆ†å·çš„é€‰é¡¹ï¼Œæˆ‘ä»¬å°±åº”è¯¥é¿å…ä½¿ç”¨åˆ†å·ã€‚æˆ‘ä¸æ˜¯åœ¨æ¨èä»€ä¹ˆï¼Œä½ è‡ªå·±é€‰æ‹©ã€‚

æˆ‘ä»¬åªéœ€è¦ç¨å¾®æ³¨æ„ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œå³ä½¿è¿™äº›å¾ˆå°‘ä¼šå‡ºç°åœ¨ä½ çš„ä»£ç ä¸­ã€‚

è®°ä½è¿™äº›è§„åˆ™ï¼š

- å°å¿ƒä½¿ç”¨ `return` è¯­å¥ã€‚å¦‚æœä½ æƒ³è¿”å›ä¸€äº›ä¸œè¥¿ï¼Œåº”è¯¥å’Œ return æ”¾åœ¨åŒä¸€è¡Œï¼ˆ`break`, `throw`, `continue` åŒç†ï¼‰
- æ°¸è¿œä¸è¦ç”¨åœ†æ‹¬å·å¼€å¤´ï¼Œè¿™å¯èƒ½ä¼šå’Œä¸Šä¸€è¡Œè¿æ¥å½¢æˆå‡½æ•°è°ƒç”¨æˆ–è€…æ•°ç»„å…ƒç´ å¼•ç”¨

æœ€åï¼Œå§‹ç»ˆæµ‹è¯•ä½ çš„ä»£ç ï¼Œç¡®ä¿å®ƒæ˜¯ä½ æƒ³è¦çš„ã€‚

## å¼•å·

ç°åœ¨æˆ‘ä»¬å°†è°ˆè°ˆ JavaScript é‡Œçš„å¼•å·å’Œç‰¹æ®Šçš„åŠŸèƒ½ã€‚

JavaScript å…è®¸ä¸‰ç§å½¢å¼çš„å¼•å·ï¼š

- å•å¼•å·
- åŒå¼•å·
- åå¼•å·

å‰ä¸¤ç§å·®ä¸å¤šï¼š

```js
const test = 'test'
const bike = "bike"
```

ä½¿ç”¨å…¶ä¸­ä¸€ç§æ²¡æœ‰ä»€ä¹ˆå¤§çš„å·®åˆ«ã€‚å”¯ä¸€çš„ä¸åŒåœ¨äºå¿…é¡»è½¬ç§»ç”¨äºåˆ†éš”å­—ç¬¦ä¸²çš„å¼•å·å­—ç¬¦ï¼š

```js
const test = 'test'
const test = 'te\'st'
const test = 'te"st'
const test = "te\"st"
const test = "te'st"
```

æœ‰å¾ˆå¤šä¸åŒçš„é£æ ¼æŒ‡å—ï¼Œå»ºè®®å§‹ç»ˆä½¿ç”¨å…¶ä¸­ä¸€ç§ã€‚

æˆ‘ä¸ªäººä¸€ç›´éƒ½ç”¨å•å¼•å·ï¼Œåªåœ¨ HTML ä¸­ä½¿ç”¨åŒå¼•å·ã€‚

åå¼•å·æ˜¯å¦ä¸€ä¸ªé€‰é¡¹ï¼Œåœ¨ 2015 å¹´çš„ ES6 ä¸­å¼•å…¥ã€‚

å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åŠŸèƒ½ - å…è®¸å¤šè¡Œå­—ç¬¦ä¸²ã€‚

å¤šè¡Œå­—ç¬¦ä¸²å¯èƒ½æ˜¯å¸¸è§„å­—ç¬¦ä¸²åŠ ä¸Šè½¬ä¹‰å­—ç¬¦ï¼š

```js
const multilineString = 'A string\non multiple lines'
```

ä½¿ç”¨åå¼•å·ï¼ˆé”®ç›˜å·¦ä¸Šè§’çš„æ•°å­— 1 é”®ï¼‰ï¼Œä½ å¯ä»¥ä¸ç”¨è½¬ä¹‰å­—ç¬¦ï¼š

```js
const multilineString = `A string
on multiple lines`
```

ä¸ä»…å¦‚æ­¤ã€‚ä½ å¯ä»¥ç”¨ `${}` è§£æå˜é‡ï¼š

```js
const multilineString = `A string
on ${1+1} lines`
```

è¿™ä¹Ÿå«åš**æ¨¡æ¿å­—ç¬¦ä¸²**ã€‚

## æ¨¡æ¿å­—ç¬¦ä¸²

ES2015ï¼Œå³ES6å¼•å…¥ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²æä¾›äº†ä¸€ä¸ªæ–°çš„æ–¹å¼å±•ç¤ºå­—ç¬¦ä¸²ï¼Œä¸€äº›æ–°çš„æœ‰è¶£çš„æ„é€ å·²ç»è¢«å¹¿æ³›ä½¿ç”¨ã€‚

ä¸ ES5 åŠæ›´ä½ç‰ˆæœ¬ç›¸æ¯”ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²ä½œä¸º ES2015/ES6 çš„åŠŸèƒ½å…è®¸ä½ ç”¨æ›´æ–°é¢–çš„æ–¹å¼å¤„ç†å­—ç¬¦ä¸²ã€‚

ä¹ä¸€çœ‹ï¼Œåå¼•å·è¯­æ³•å’Œå•å¼•å·ï¼ŒåŒå¼•å·ç›¸æ¯”å¾ˆç®€å•ï¼š

```js
const a_string = `something`
```

å®ƒä»¬å’Œæ™®é€šçš„å­—ç¬¦ä¸²ç›¸æ¯”æä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯ï¼š

- æä¾›äº†ä¼˜ç§€çš„è¯­æ³•å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²
- æä¾›äº†ç®€å•çš„æ–¹å¼è§£é‡Šå­—ç¬¦ä¸²ä¸­çš„å˜é‡å’Œè¡¨è¾¾å¼
- å…è®¸é€šè¿‡æ¨¡æ¿æ ‡ç­¾åˆ›å»º DSLs

è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™äº›åŠŸèƒ½ã€‚

### å¤šè¡Œå­—ç¬¦ä¸²

åœ¨ ES6 ä¹‹å‰ï¼Œåˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²éœ€è¦åœ¨æ¯è¡Œè¡Œå°¾æ·»åŠ  `\` å­—ç¬¦ï¼š

```js
const string = 'first part \
second part'
```

è¿™æ ·çœ‹æ˜¯ä¸¤è¡Œå­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ¸²æŸ“æ—¶ä¼šå˜æˆä¸€è¡Œï¼š

```js
"first part second part"
```

ä¸ºäº†èƒ½å¤Ÿæ¸²æŸ“å¤šè¡Œå­—ç¬¦ä¸²ï¼Œä½ éœ€è¦åœ¨æ¯è¡Œæœ«å°¾æ·»åŠ  `\n`ï¼š

```js
const string = 'first line\n \
second line'
```

æˆ–è€…

```js
const string = 'first line\n' +
               'second line'
```

æ¨¡æ¿å­—ç¬¦ä¸²ä½¿åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²å˜å¾—å¾ˆç®€å•ï¼š

ä½¿ç”¨åå¼•å·å¼€å§‹å¤šè¡Œå­—ç¬¦ä¸²ï¼Œä½ åªç”¨æŒ‰ä¸‹å›è½¦é”®å°±èƒ½åˆ›å»ºä¸€ä¸ªæ–°è¡Œï¼Œä¸ç”¨ä»€ä¹ˆç‰¹åˆ«çš„å­—ç¬¦ï¼Œåƒè¿™æ ·ï¼š

```js
const string = `Hey
this

string
is awesome!`
```

æ³¨æ„ï¼šç©ºæ ¼ä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ï¼Œè¿™æ ·åšï¼š

```js
const string = `First
                Second`
```

å°†ä¼šåˆ›å»ºä¸€ä¸ªè¿™æ ·çš„å­—ç¬¦ä¸²ï¼š

```js
First
                Second
```

è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸€ä¸ªç®€å•çš„åŠæ³•ï¼šè®©ç¬¬ä¸€è¡Œæ˜¯ç©ºçš„ï¼Œåœ¨é—­åˆåå¼•å·åé¢åŠ ä¸Š `trim()` æ–¹æ³•ï¼Œè¿™æ ·ä¼šå¿½ç•¥æ‰æ‰€æœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦å‰çš„ç©ºæ ¼ï¼š

```js
const string = `
First
Second`.trim()
```

### æ’å€¼

æ¨¡æ¿å­—ç¬¦ä¸²æä¾›äº†ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥å˜é‡å’Œè¡¨è¾¾å¼çš„ç®€å•æ–¹æ³•ã€‚

ä½ ç”¨å¯ä»¥ä½¿ç”¨ `${...}` è¯­æ³•ï¼š

```js
const var = 'test'
const string = `something ${var}` //something test
```

åœ¨ `${}` é‡Œä½ å¯ä»¥æ·»åŠ ä»»ä½•ä¸œè¥¿ï¼Œç”šè‡³æ˜¯è¡¨è¾¾å¼ï¼š

```js
const string = `something ${1 + 2 + 3}`
const string2 = `something ${foo() ? 'x' : 'y' }`
```

### æ¨¡æ¿æ ‡ç­¾

æ¨¡æ¿æ ‡ç­¾æ˜¯ä¸€ä¸ªæœ€åˆå¬èµ·æ¥å¯èƒ½ä¸é‚£ä¹ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒè¢«å¾ˆå¤šæµè¡Œåº“ä½¿ç”¨ï¼Œæ¯”å¦‚[Styled Components](https://flaviocopes.com/styled-components)ã€[Apollo](https://flaviocopes.com/apollo/)ã€[GraphQL](https://flaviocopes.com/graphql/)å®¢æˆ·ç«¯/æœåŠ¡ç«¯åº“ï¼Œæ‰€ä»¥ç†è§£å®ƒçš„åŸç†ä¹Ÿå¾ˆé‡è¦ã€‚

åœ¨ Styled Components ä¸­ï¼Œæ¨¡æ¿æ ‡ç­¾è¢«ç”¨æ¥å®šä¹‰ CSSï¼š

```js
const Button = styled.button`
  font-size: 1.5em;
  background-color: black;
  color: white;
`;
```

åœ¨ Apollo ä¸­ï¼Œæ¨¡æ¿æ ‡ç­¾è¢«ç”¨æ¥å®šä¹‰ GraphQL æŸ¥è¯¢è¡¨ï¼š

```js
const query = gql`
  query {
    ...
  }
`
```

è¿™äº›ä¾‹å­ä¸­é«˜äº®çš„ `styled button` å’Œ `gql` æ¨¡æ¿æ ‡ç­¾éƒ½æ˜¯ **å‡½æ•°**ï¼š

```js
function gql(literals, ...expressions) {

}
```

è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å¯ä»¥æ˜¯*ä»»ä½•*è®¡ç®—ç»“æœã€‚

`literals` æ˜¯ä¸€ä¸ªåŒ…å«è¢«è¡¨è¾¾å¼æ’å€¼æ ‡è®°çš„æ¨¡æ¿æ ‡ç­¾æ•°ç»„ã€‚

`expressions` åŒ…å«æ‰€æœ‰çš„æ’å€¼ã€‚

æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼š

```js
const string = `something ${1 + 2 + 3}`
```

`literals` æ•°ç»„åŒ…å«ä¸¤é¡¹ã€‚ç¬¬ä¸€ä¸ªä» `something`å¼€å§‹ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªæ’å€¼å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªæ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ’å€¼æœ«å°¾ï¼ˆæˆ‘ä»¬åªæœ‰ä¸€ä¸ªï¼‰å’Œæ•´ä¸ªå­—ç¬¦ä¸²æœ«å°¾ä¹‹é—´çš„ç©ºæ ¼ã€‚

ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­æ˜¯ï¼š

```js
const string = `something
another ${'x'}
new line ${1 + 2 + 3}
test`
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`literals` æ•°ç»„ä¸­ç¬¬ä¸€é¡¹æ˜¯ï¼š

```js
`something
another `
```

ç¬¬äºŒé¡¹æ˜¯ï¼š

```js
`
new line `
```

ç¬¬ä¸‰é¡¹æ˜¯ï¼š

```js
`
test`
```

`expressions` æ˜¯åŒ…å« `x` å’Œ `6` çš„æ•°ç»„ã€‚

ä¼ é€’è¿™äº›å€¼çš„å‡½æ•°å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œä»»ä½•æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸ªåŠŸèƒ½çš„å¼ºå¤§ä¹‹å¤„ã€‚

æœ€ç®€å•çš„ä¾‹å­å°±æ˜¯èµ‹å€¼æ’å€¼å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œé€šè¿‡åŠ å…¥ `literals` å’Œ `expressions`ï¼š

```js
const interpolated = interpolate`I paid ${10}â‚¬`
```

`interpolate` æ˜¯è¿™æ ·ï¼š

```js
function interpolate(literals, ...expressions) {
  let string = ``
  for (const [i, val] of expressions) {
    string += literals[i] + val
  }
  string += literals[literals.length - 1]
  return string
}
```

## JavaScript å‡½æ•°

ç°åœ¨æˆ‘ä»¬ç”±é¢åŠç‚¹åœ°äº†è§£æ‰€æœ‰å‡½æ•°åŠŸèƒ½ï¼Œå¸®åŠ©ä½ ä½¿ç”¨å®ƒä»¬ã€‚

JavaScript é‡Œçš„ä¸€åˆ‡éƒ½æ˜¯å‡½æ•°ã€‚

å‡½æ•°æ˜¯ä¸€ä¸ªè‡ªåŒ…å«çš„ä»£ç å—ï¼Œå®šä¹‰ä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨æ— æ•°æ¬¡ã€‚

å‡½æ•°å‚æ•°æ˜¯å¯é€‰çš„ï¼Œåªèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚

JavaScript é‡Œçš„å‡½æ•°ä¹Ÿæ˜¯**å¯¹è±¡**ï¼Œä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼š**å‡½æ•°å¯¹è±¡**ã€‚å®ƒä»¬çš„è¶…èƒ½åŠ›åœ¨äºå®ƒä»¬å¯ä»¥è¢«è°ƒç”¨ã€‚

å¦å¤–ï¼Œå‡½æ•°è¢«ç§°ä¸º**å¤´ç­‰å‡½æ•°ï¼ˆfirst class functionsï¼‰**ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥ç»‘å®šå€¼ï¼Œå¯ä»¥ä¼ é€’å‚æ•°ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå€¼ã€‚

è®©æˆ‘ä»¬å…ˆä»â€œæ—§â€çš„ ES6 ä¹‹å‰çš„è¯­æ³•å¼€å§‹ã€‚è¿™æ˜¯ä¸€ä¸ª**å‡½æ•°å£°æ˜å¼**ï¼š

```js
function dosomething(foo) {
  // do something
}
```

ç°åœ¨ï¼Œåœ¨ ES6/ES2015 é‡Œï¼Œå±äº**å¸¸è§„å‡½æ•°**ã€‚

å‡½æ•°å¯ä»¥ç»‘å®šç»™ä¸€ä¸ªå˜é‡ï¼ˆè¿™å«åš**å‡½æ•°è¡¨è¾¾å¼**ï¼‰ï¼š

```js
const dosomething = function(foo) {
  // do something
}
```

**å‘½åå‡½æ•°è¡¨è¾¾å¼**å¾ˆç®€å•ï¼Œä½†åœ¨å †æ ˆè°ƒç”¨è·Ÿè¸ªä¸­å¾ˆå¥½ç”¨ï¼Œå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºè¿™ä¸ªå‡½æ•°çš„åå­—ï¼š

```js
const dosomething = function dosomething(foo) {
  // do something
}
```

ES6/ES2015 å¼•å…¥äº†**ç®­å¤´å‡½æ•°**ï¼Œåœ¨ä½œä¸ºå‚æ•°æˆ–è€…å›è°ƒçš„è¡Œå†…å‡½æ•°æ—¶å¾ˆå¥½ç”¨ï¼š

```js
const dosomething = foo => {
  //do something
}
```

ç®­å¤´å‡½æ•°å’Œä¸Šé¢å…¶å®ƒå‡½æ•°æœ‰ä¸€ä¸ªå·¨å¤§çš„å·®å¼‚ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„è¯é¢˜ä¸­æ·±å…¥å®ƒã€‚

### å‚æ•°

ä¸€ä¸ªå‡½æ•°å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚

```js
const dosomething = () => {
  //do something
}

const dosomethingElse = foo => {
  //do something
}

const dosomethingElseAgain = (foo, bar) => {
  //do something
}
```

ES6/ES2015 å¼€å§‹ï¼Œå‡½æ•°å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼š

```js
const dosomething = (foo = 1, bar = 'hey') => {
  //do something
}
```

è¿™è®©ä½ ä¸ç”¨å¡«æ»¡å‚æ•°ä¹Ÿå¯ä»¥è°ƒç”¨è°ƒç”¨å‡½æ•°ï¼š

```js
dosomething(3)
dosomething()
```

ES2018 å¯ä»¥ä¸ºå‚æ•°æ·»åŠ å°¾é€—å·ï¼Œå¸®åŠ©å‡å°‘ç§»åŠ¨å‚æ•°æ—¶æ¼æ‰é€—å·çš„ bugï¼ˆæ¯”å¦‚æŠŠæœ€åä¸€ä¸ªå‚æ•°ç§»åˆ°ä¸­é—´ï¼‰ï¼š

```js
const dosomething = (foo = 1, bar = 'hey') => {
  //do something
}
dosomething(2, 'ho!')
```

ä½ å¯ä»¥ç”¨æ•°ç»„åŒ…è£¹æ‰€æœ‰å‚æ•°ï¼Œç„¶ååœ¨è°ƒç”¨æ—¶ç”¨æ‰©å±•è¿ç®—ç¬¦å±•å¼€ï¼š

```js
const dosomething = (foo = 1, bar = 'hey') => {
  //do something
}
const args = [2, 'ho!']
dosomething(...args)
```

è®°ä½ï¼šå‡½æ•°å‚æ•°æ˜¯æœ‰åºçš„ã€‚ä½¿ç”¨å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¯ä»¥è·å¾—å‚æ•°çš„åå­—ï¼š

```js
const dosomething = ({ foo = 1, bar = 'hey' }) => {
  //do something
  console.log(foo) // 2
  console.log(bar) // 'ho!'
}
const args = { foo: 2, bar: 'ho!' }
dosomething(args)
```

### è¿”å›å€¼

æ¯ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œé»˜è®¤æ˜¯ `undefined`ã€‚

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d78a07462c4f?w=681&h=216&f=png&s=22618)

æ‰€æœ‰å‡½æ•°éƒ½ä¼šåœ¨æœ€åä¸€è¡Œä»£ç æ‰§è¡Œå®Œåç»ˆæ­¢ï¼Œæˆ–è€…æ‰§è¡Œåˆ° `return` å…³é”®å­—ã€‚å½“ JavaScript é‡åˆ°è¿™ä¸ªå…³é”®å­—æ—¶ä¼šè‡ªåŠ¨ç»ˆæ­¢å‡½æ•°æ‰§è¡Œï¼Œå¹¶æŠŠæ§åˆ¶æƒäº¤ç»™è°ƒç”¨è€…ã€‚

å¦‚æœä½ ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼å°±ä¼šä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚

```js
const dosomething = () => {
  return 'test'
}
const result = dosomething() // result === 'test'
```

ä½ åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼š

ä¸ºäº†*æ¨¡æ‹Ÿ*è¿”å›å¤šä¸ªå€¼ï¼Œä½ å¯ä»¥è¿”å›ä¸€ä¸ª**å¯¹è±¡å­—é¢é‡**æˆ–ä¸€ä¸ª**æ•°ç»„**ï¼Œè°ƒç”¨å‡½æ•°æ—¶ç”¨è§£æ„ç»‘å®šå•ä¸€å€¼ã€‚

ä½¿ç”¨æ•°ç»„ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d79c6972b527?w=687&h=380&f=png&s=33003)

ä½¿ç”¨å¯¹è±¡ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7a210c0a668?w=725&h=375&f=png&s=36833)

### åµŒå¥—å‡½æ•°

å‡½æ•°å¯ä»¥å®šä¹‰åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨ï¼š

```js
const dosomething = () => {
  const dosomethingelse = () => {}
  dosomethingelse()
  return 'test'
}
```

åµŒå¥—çš„å‡½æ•°åœ¨å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸé‡Œï¼Œä¸èƒ½åœ¨é™¤æ­¤ä¹‹å¤–çš„ä½ç½®è°ƒç”¨ã€‚

### å¯¹è±¡æ–¹æ³•

ä½œä¸ºå¯¹è±¡ç‰¹æ€§æ—¶ï¼Œå‡½æ•°ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼š

```js
const car = {
  brand: 'Ford',
  model: 'Fiesta',
  start: function() {
    console.log(`Started`)
  }
}
car.start()
```

### ç®­å¤´å‡½æ•°ä¸­çš„â€œthisâ€

ä½œä¸ºå¯¹è±¡æ–¹æ³•ï¼Œç®­å¤´å‡½æ•°å’Œå¸¸è§„å‡½æ•°â€œthisâ€çš„æŒ‡å‘å¾ˆé‡è¦ã€‚çœ‹çœ‹è¿™ä¸ªä¾‹å­ï¼š

```js
const car = {
  brand: 'Ford',
  model: 'Fiesta',
  start: function() {
    console.log(`Started ${this.brand} ${this.model}`)
  },
  stop: () => {
    console.log(`Stopped ${this.brand} ${this.model}`)
  }
}
```

è¿™ä¸ª `stop()` æ–¹æ³•ä¸ä¼šåƒä½ é¢„æœŸçš„å·¥ä½œã€‚

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7a8a75105a1?w=800&h=421&f=png&s=74716)

è¿™æ˜¯å› ä¸ºä¸¤ç§å‡½æ•°é£æ ¼ä¸­çš„ `this` ä¸ä¸€æ ·ã€‚ç®­å¤´å‡½æ•°ä¸­çš„ ` this` æŒ‡å‘å°é—­çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ `window` å¯¹è±¡ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7afe14440f4?w=800&h=649&f=png&s=137648)

ä½¿ç”¨ `function()` ï¼Œ`this` æŒ‡å‘å®¿ä¸»å¯¹è±¡ã€‚

è¿™æ„å‘³ç€**ç®­å¤´å‡½æ•°ä¸é€‚åˆç”¨äºå¯¹è±¡æ–¹æ³•**å’Œæ„é€ å‡½æ•°ï¼ˆç®­å¤´æ„é€ å‡½æ•°ä¼šåœ¨è°ƒç”¨ä¸­è·‘å‡º `TypeError`é”™è¯¯ï¼‰ã€‚

### IIFE, ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼

IIFE åœ¨å£°æ˜ä¹‹åä¼šç«‹å³æ‰§è¡Œï¼š

```js
;(function dosomething() {
  console.log('executed')
})()
```

ä½ å¯ä»¥å°†ç»“æœèµ‹å€¼ç»™å˜é‡ï¼š

```js
const something = (function dosomething() {
  return 'something'
})()
```

å®ƒä»¬éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºä½ æ— éœ€åœ¨å®šä¹‰åå•ç‹¬è°ƒç”¨è¯¥å‡½æ•°ã€‚

### å‡½æ•°æå‡

åœ¨æ‰§è¡Œä»£ç ä¹‹å‰ï¼ŒJavaScript ä¼šæ ¹æ®è§„åˆ™å°†å…¶é‡æ–°æ’åºã€‚

æ¯”å¦‚å°†å‡½æ•°ç§»åŠ¨åˆ°ä½œç”¨åŸŸçš„é¡¶éƒ¨ã€‚è¿™å°±æ˜¯è¿™æ ·å†™åˆæ³•çš„åŸå› ï¼š

```js

```

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7c67af1c974?w=800&h=182&f=png&s=35984)

åœ¨åº•å±‚ï¼ŒJavaScript æŠŠè¿™ä¸ªå‡½æ•°ç§»åŠ¨åˆ°è°ƒç”¨è¯­å¥ä¹‹å‰ï¼Œå’Œå…¶å®ƒå‡½æ•°å¤„äºåŒä¸€ä½œç”¨åŸŸä¸­ï¼š

```js
function dosomething() {
  console.log('did something')
}
dosomething()
```

ç°åœ¨ï¼Œå¦‚æœä½ ä½¿ç”¨å‘½åå‡½æ•°è¡¨è¾¾å¼ï¼Œå› ä¸ºä½ ç”¨äº† [variables](https://flaviocopes.com/javascript-variables/)ï¼Œäº‹æƒ…ä¼šæœ‰æ‰€ä¸åŒã€‚å˜é‡è¢«æå‡äº†ï¼Œä½†æ˜¯å€¼æ²¡æœ‰ï¼Œä¹Ÿå°±ä¸æ˜¯ä¸€ä¸ªå‡½æ•°äº†ã€‚

```js
dosomething()
const dosomething = function dosomething() {
  console.log('did something')
}
```

ä¸ä¼šå·¥ä½œï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7cd4780abd8?w=800&h=198&f=png&s=54264)

è¿™æ˜¯å› ä¸ºå†…éƒ¨å˜æˆäº†ï¼š

```js
const dosomething
dosomething()
dosomething = function dosomething() {
  console.log('did something')
}
```

è¿™åœ¨ `let` å£°æ˜ï¼Œ`var` å£°æ˜ä¹Ÿä¸€æ ·ä¸ä¼šå·¥ä½œï¼Œä½†æ˜¯æŠ›å‡ºçš„é”™è¯¯ä¸åŒï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7d1bc5e6dc7?w=800&h=358&f=png&s=98183)

è¿™æ˜¯å› ä¸º `var` å£°æ˜è¢«æå‡å¹¶åˆå§‹åŒ–å€¼ä¸º `undefined`ï¼Œè€Œ` const` å’Œ `let` ä»…ä»…åªä¼šè¢«æå‡ã€‚

### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æ˜¯ ES6/ES2015 ä¸­æœ€é‡è¦çš„æ”¹å˜ï¼Œç°åœ¨è¢«å¹¿æ³›ä½¿ç”¨ã€‚å®ƒä»¬å’Œå¸¸è§„å‡½æ•°ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆã€‚

åœ¨ä¸Šé¢æˆ‘å·²ç»ä»‹ç»äº†ç®­å¤´å‡½æ•°ï¼Œä½†æ˜¯å®ƒä»¬å¾ˆé‡è¦ï¼Œæ‰€ä»¥å•ç‹¬ä»‹ç»ä¸€ä¸‹å®ƒä»¬ã€‚

ç®­å¤´å‡½æ•°åœ¨ ES6/ES2015 ä¸­å¼•å…¥ï¼Œå®ƒä»¬çš„å­˜åœ¨æ°¸è¿œçš„æ”¹å˜äº† JavaScript ä»£ç çš„å†™æ³•ï¼ˆå’Œå·¥ä½œï¼‰ã€‚

åœ¨æˆ‘çš„è§‚ç‚¹ä¸­ï¼Œè¿™ä¸ªæ”¹å˜å¾ˆå—æ¬¢è¿ï¼Œä»¥è‡´äºç°ä»£ä»£ç å¾ˆå°‘ç”¨ `function` å…³é”®å­—ã€‚

åœ¨è§†è§‰ä¸Šï¼Œå®ƒæ˜¯ä¸ªå—æ¬¢è¿å’Œç®€å•çš„å˜åŒ–ï¼Œè®©ä½ å¯ä»¥ç”¨æ›´ç®€å•çš„è¯­æ³•å†™ä¸€ä¸ªå‡½æ•°ï¼Œä»ï¼š

```js
const myFunction = function foo() {
  //...
}
```

å˜æˆï¼š

```js
const myFunction = () => {
  //...
}
```

å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€ä¸ªè¯­å¥ï¼Œä½ å¯ä»¥å¿½ç•¥èŠ±æ‹¬å·ï¼Œç„¶åæŠŠæ‰€æœ‰å†…å®¹å†™åœ¨ä¸€è¡Œï¼š

```js
const myFunction = () => doSomething()
```

åœ¨åœ†æ‹¬å·ä¸­ä¼ é€’å‚æ•°ï¼š

```js
const myFunction = (param1, param2) => doSomething(param1, param2)
```

å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä½ å¯ä»¥å¿½ç•¥åœ†æ‹¬å·ï¼š

```js
const myFunction = param => doSomething(param)
```

å¤šè°¢è¿™ä¸ªè¯­æ³•ï¼Œç®­å¤´å‡½æ•°**é¼“åŠ±ä½¿ç”¨çŸ­å‡½æ•°**ã€‚

#### éšæ€§è¿”å›

ç®­å¤´å‡½æ•°å¯ä»¥éšæ€§è¿”å›å€¼ï¼šä¸ç”¨ä½¿ç”¨ `return` å…³é”®å­—è¿”å›ã€‚

å®ƒåœ¨å‡½æ•°ä½“åªæœ‰ä¸€ä¸ªè¯­å¥æ—¶æœ‰æ•ˆï¼š

```js
const myFunction = () => 'test'

myFunction() //'test'
```

å¦ä¸€ä¸ªä¾‹å­ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ˆè®°ä½ç”¨åœ†æ‹¬å·åŒ…è£¹è¿”å›å€¼ï¼Œé¿å…è§£é‡Šå™¨æŠŠå®ƒçœ‹ä½œå‡½æ•°ä½“ï¼‰ï¼š

```js
const myFunction = () => ({value: 'test'})

myFunction() //{value: 'test'}
```

### ç®­å¤´å‡½æ•°ä¸­ this å¦‚ä½•å·¥ä½œ

`this` æ˜¯ä¸€ä¸ªå¾ˆéš¾æŒæ¡çš„ç†å¿µï¼Œä¸Šä¸‹æ–‡é€ æˆäº†å®ƒçš„ä¸åŒï¼Œä¹Ÿå— JavaScript æ¨¡å¼ï¼ˆæ˜¯å¦æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼‰çš„å½±å“ã€‚

ç†æ¸…è¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦ï¼Œå› ä¸ºç®­å¤´å‡½æ•°çš„è¡¨ç°å’Œå¸¸è§„å‡½æ•°ä¸åŒã€‚

å½“å®šä¹‰äº†å¯¹è±¡é‡Œçš„æŸä¸€æ–¹æ³•ï¼Œåœ¨å¸¸è§„å‡½æ•°é‡Œ `this` æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä½ å¯ä»¥ï¼š

```js
const car = {
  model: 'Fiesta',
  manufacturer: 'Ford',
  fullName: function() {
    return `${this.manufacturer} ${this.model}`
  }
}
```

è°ƒç”¨ `car.fullname()` ä¼šè¿”å› `Ford Fiesta`ã€‚

ç®­å¤´å‡½æ•°çš„ `this` ç»§æ‰¿è‡ªæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ç®­å¤´å‡½æ•°æ ¹æœ¬ä¸ä¼šÂ·ç»‘å®š `this`ï¼Œæ‰€ä»¥å®ƒçš„å€¼ä¼šåœ¨è°ƒç”¨æ ˆé‡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªä»£ç é‡Œ `car.fullName()`æ— æ„ä¹‰ï¼Œç„¶åè¿”å› `undefined undefined`ï¼š

```js
const car = {
  model: 'Fiesta',
  manufacturer: 'Ford',
  fullName: () => {
    return `${this.manufacturer} ${this.model}`
  }
}
```

å› ä¸ºæ­¤ï¼Œç®­å¤´å‡½æ•°ä¸é€‚åˆç”¨äºå¯¹è±¡æ–¹æ³•ã€‚

ç®­å¤´å‡½æ•°ä¹Ÿä¸èƒ½ç”¨äºåˆå§‹åŒ–å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå®ƒä¼šæŠ›å‡º `TypeError`ã€‚

**å½“ä¸éœ€è¦åŠ¨æ€ä¸Šä¸‹æ–‡**ï¼Œåº”è¯¥ä½¿ç”¨å¸¸è§„å‡½æ•°æ›¿ä»£ã€‚

å¤„ç†äº‹ä»¶æ—¶ä¹Ÿä¼šæœ‰é—®é¢˜ã€‚DOM äº‹ä»¶ç›‘å¬å™¨ä¼šè®¾ç½® `this`ä¸ºç›®æ ‡å…ƒç´ ï¼Œå¦‚æœä½ éœ€è¦äº‹ä»¶å¤„ç†å™¨çš„  `this`ï¼Œåº”è¯¥ç”¨å¸¸è§„å‡½æ•°ï¼š

```js
const link = document.querySelector('#link')
link.addEventListener('click', () => {
  // this === window
})

const link = document.querySelector('#link')
link.addEventListener('click', function() {
  // this === link
})
```

### é—­åŒ…

è¿™æ˜¯å¯¹é—­åŒ…è¯é¢˜å¾ˆå‹å¥½çš„ä»‹ç»ï¼Œæ˜¯ç†è§£ JavaScript å‡½æ•°å¦‚ä½•å·¥ä½œçš„å…³é”®ã€‚

å¦‚æœä½ å†™è¿‡ JavaScript å‡½æ•°ï¼Œä½ å·²ç»ä½¿ç”¨äº† **é—­åŒ…**ã€‚è¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„å…³é”®ä¸»é¢˜ï¼Œå®ƒä¼šå½±å“ä½ æ‰€åšçš„äº‹æƒ…ã€‚å½“ä¸€ä¸ªå‡½æ•°è¿è¡Œæ—¶ï¼Œå®ƒè¿è¡Œåœ¨**å®šä¹‰å®ƒçš„ä½œç”¨åŸŸ**ä¸­ï¼Œè€Œä¸æ˜¯**æ‰§è¡Œ**å®ƒçš„ä½ç½®ã€‚

ä½œç”¨åŸŸåŸºæœ¬ä¸Šæ˜¯å¯è§çš„å˜é‡åˆé›†ã€‚å‡½æ•°ä¼šè®°ä½å®ƒçš„è¯æ³•ä½œç”¨åŸŸï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¿é—®åœ¨çˆ¶ä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå‡½æ•°æœ‰ä¸€æ•´å¥—å¯ä»¥è®¿é—®çš„å˜é‡ã€‚

æˆ‘ä»¬èµ¶ç´§é€šè¿‡ä¾‹å­éªŒè¯ä¸€ä¸‹ï¼š

```js
const bark = dog => {
  const say = `${dog} barked!`
  ;(() => console.log(say))()
}

bark(`Roger`)
```

è¿™ä¸ªé¢„æœŸä¸€æ ·æ‰“å°å‡ºï¼š`Roger barked!`ã€‚

å¦‚æœä½ æƒ³è¦è¿”å›æ“ä½œï¼Œè¿™æ ·åšï¼š

```js
const prepareBark = dog => {
  const say = `${dog} barked!`
  return () => console.log(say)
}

const bark = prepareBark(`Roger`)

bark()
```

è¿™ä¸ªä»£ç æ®µä¼šæ‰“å°å‡º `Roger barked!`ã€‚

æœ€åä¸€ä¸ªä¾‹å­ï¼Œè®©ä¸¤ç§ä¸åŒçš„ç‹— `prepareBark`ï¼š

```js
const prepareBark = dog => {
  const say = `${dog} barked!`
  return () => {
    console.log(say)
  }
}

const rogerBark = prepareBark(`Roger`)
const sydBark = prepareBark(`Syd`)

rogerBark()
sydBark()
```

æ‰“å°ï¼š

```js
Roger barked!
Syd barked!
```

æ­£å¦‚ä½ æ‰€è§ï¼Œå˜é‡ `say` çš„ç»“æœå’Œå‡½æ•° `prepareBark` è¿”å›çš„æ˜¯ç›¸å…³çš„ã€‚

ç¬¬äºŒä¸ªè°ƒç”¨ `prepareBark()` æ—¶é‡æ–°å®šä¹‰äº†æ–°çš„ `say` å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šå½±å“ç¬¬ä¸€æ¬¡ `prepareBark()` çš„ä½œç”¨åŸŸã€‚

è¿™å°±æ˜¯é—­åŒ…çš„åŸç†ï¼šè¿”å›çš„å‡½æ•°ä¿æŒä½œç”¨åŸŸé‡Œçš„åˆå§‹çŠ¶æ€ã€‚

## æ•°ç»„

éšç€ä¸æ–­åœ°å‘å±•ï¼ŒJavaScript æ•°ç»„æœ‰äº†è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ï¼Œæœ‰äº›æ—¶å€™çŸ¥é“ä»€ä¹ˆä½¿ç”¨ä»€ä¹ˆæ–¹æ³•æ˜¯å¾ˆæ£˜æ‰‹çš„ã€‚æœ¬ç« èŠ‚æ—¨åœ¨è§£é‡Šæˆªè‡³ 2018 å¹´ä½ åº”è¯¥ä½¿ç”¨ä»€ä¹ˆã€‚

### åˆå§‹åŒ–æ•°ç»„

```js
const a = []
const a = [1, 2, 3]
const a = Array.of(1, 2, 3)
const a = Array(6).fill(1) //init an array of 6 items of value 1
```

ä¸è¦ä½¿ç”¨æ—§è¯­æ³•ï¼ˆé™¤äº†ç±»å‹æ•°ç»„ï¼‰ï¼š

```js
const a = new Array() //never use
const a = new Array(1, 2, 3) //never use
```

### è·å–æ•°ç»„é•¿åº¦

```js
const l = a.length
```

### é€šè¿‡ `every` éå†æ•°ç»„

```js
a.every(f)
```

éå† `a` ç›´åˆ° `f()` è¿”å› falseã€‚

### é€šè¿‡ `some` éå†æ•°ç»„

```js
a.some(f)
```

éå† `a` ç›´åˆ° `f()` è¿”å› trueã€‚

### éå†æ•°ç»„å¹¶è¿”å›å‡½æ•°ç»“æœç»„æˆçš„æ–°æ•°ç»„

```js
const b = a.map(f)
```

éå† `a`ï¼Œè¿”å›æ¯ä¸€ä¸ª `a` å…ƒç´ æ‰§è¡Œ `f()` äº§ç”Ÿçš„ç»“æœæ•°ç»„ã€‚

### è¿‡æ»¤æ•°ç»„

```js
const b = a.filter(f)
```

éå† `a`ï¼Œè¿”å›æ¯ä¸€ä¸ª `a` å…ƒç´ æ‰§è¡Œ `f()` éƒ½ä¸º true çš„æ–°æ•°ç»„ã€‚

### Reduce

```js
a.reduce((accumulator, currentValue, currentIndex, array) => {
  //...
}, initialValue)
```

`reduce()` å¯¹æ•°ç»„ä¸­æ¯ä¸€é¡¹éƒ½è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶é€æ­¥è®¡ç®—è®¡ç®—ç»“æœã€‚å¦‚æœ `initaiValue` å­˜åœ¨ï¼Œ`accumulator`åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶ç­‰äºè¿™ä¸ªå€¼ã€‚

ä¾‹å­ï¼š

```js

```

### foreach

> ES6

```js
a.forEach(f)
```

éå† `a` æ‰§è¡Œ `f`ï¼Œä¸èƒ½ä¸­é€”åœæ­¢ã€‚

ä¾‹å­ï¼š

```js
a.forEach(v => {
  console.log(v)
})
```

### for...of

> ES6

```js
for (let v of a) {
  console.log(v)
}
```

### for

```js
for (let i = 0; i < a.length; i += 1) {
  //a[i]
}
```

éå† `a`ï¼Œå¯ä»¥é€šè¿‡ `return` æˆ–è€… `break` ä¸­æ­¢å¾ªç¯ï¼Œé€šè¿‡ `continue` è·³å‡ºå¾ªç¯ã€‚

### @@iterator

> ES6

è·å–æ•°ç»„è¿­ä»£å™¨çš„å€¼ï¼š

```js
const a = [1, 2, 3]
let it = a[Symbol.iterator]()

console.log(it.next().value) //1
console.log(it.next().value) //2
console.log(it.next().value) //3
```

`.entries()` è¿”å›ä¸€ä¸ªé”®å€¼å¯¹çš„è¿­ä»£å™¨ï¼š

```js
let it = a.entries()

console.log(it.next().value) //[0, 1]
console.log(it.next().value) //[1, 2]
console.log(it.next().value) //[2, 3]
```

`.keys()` è¿”å›åŒ…å«æ‰€æœ‰é”®åçš„è¿­ä»£å™¨ï¼š

```js
let it = a.keys()

console.log(it.next().value) //0
console.log(it.next().value) //1
console.log(it.next().value) //2
```

æ•°ç»„ç»“æŸæ—¶ `.next()` è¿”å› `undefined`ã€‚ä½ å¯ä»¥é€šè¿‡ `it.next()` è¿”å›çš„ `value, done` å€¼æ£€æµ‹è¿­ä»£æ˜¯å¦ç»“æŸã€‚å½“è¿­ä»£åˆ°æœ€åä¸€ä¸ªå…ƒç´ æ—¶ `done` çš„å€¼å§‹ç»ˆä¸º `true`ã€‚ 

### åœ¨æ•°ç»„æœ«å°¾è¿½åŠ å€¼

```js
a.push(4)
```

### åœ¨æ•°ç»„å¼€å¤´æ·»åŠ å€¼

```js
a.unshift(0)
a.unshift(-2, -1)
```

### ç§»é™¤æ•°ç»„ä¸­çš„å€¼

#### åˆ é™¤æœ«å°¾çš„å€¼

```js
a.pop()
```

#### åˆ é™¤å¼€å¤´çš„å€¼

```js
a.shift()
```

#### åˆ é™¤ä»»æ„ä½ç½®çš„å€¼

```js
a.splice(0, 2) // get the first 2 items
a.splice(3, 2) // get the  2 items starting from index 3
```

ä¸è¦ä½¿ç”¨ `remove()`ï¼Œå› ä¸ºå®ƒä¼šç•™ä¸‹æœªå®šä¹‰çš„å€¼ã€‚

### ç§»é™¤å¹¶æ’å…¥å€¼

```js
a.splice(2, 3, 2, 'a', 'b') //removes 3 items starting from
//index 2, and adds 2 items,
// still starting from index 2
```

### åˆå¹¶å¤šä¸ªæ•°ç»„

```js
const a = [1, 2]
const b = [3, 4]
a.concat(b) // 1, 2, 3, 4
```

### æŸ¥æ‰¾æ•°ç»„ä¸­ç‰¹å®šå…ƒç´ 

#### ES5

```js
a.indexOf()
```

è¿”å›åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå…ƒç´ ä¸å­˜åœ¨è¿”å› -1ã€‚

```js
a.lastIndexOf()
```

è¿”å›åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå…ƒç´ ä¸å­˜åœ¨è¿”å› -1ã€‚

#### ES6

```js
a.find((element, index, array) => {
  //return true or false
})
```

è¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› undefinedã€‚

é€šå¸¸è¿™ä¹ˆç”¨ï¼š

```js
a.find(x => x.id === my_id)
```

ä¸Šé¢çš„ä¾‹å­ä¼šè¿”å›æ•°ç»„ä¸­ `id === my_id`çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚

`findIndex` è¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› `undefined`ï¼š

```js
a.findIndex((element, index, array) => {
  //return true or false
})
```

#### ES7

```js
a.includes(value)
```

å¦‚æœ `a` åŒ…å« `value` è¿”å› trueã€‚

```js
a.includes(value, i)
```

å¦‚æœ `a` ä»ä½ç½® `i` ååŒ…å« `value` è¿”å› trueã€‚

### è·å–æ•°ç»„çš„ä¸€éƒ¨åˆ†

```js
a.slice()
```

### æ•°ç»„æ’åº

æŒ‰å­—æ¯é¡ºåºæ’åºï¼ˆæŒ‰ç…§ ASCII å€¼ - `0-9A-Za-z`ï¼‰ï¼š

```js
const a = [1, 2, 3, 10, 11]
a.sort() //1, 10, 11, 2, 3

const b = [1, 'a', 'Z', 3, 2, 11]
b = a.sort() //1, 11, 2, 3, Z, a
```

è‡ªå®šä¹‰æ’åº

```js
const a = [1, 10, 3, 2, 11]
a.sort((a, b) => a - b) //1, 2, 3, 10, 11
```

é€†åº

```js
a.reverse()
```

### æ•°ç»„è½¬å­—ç¬¦ä¸²

```js
a.toString()
```

è¿”å›å­—ç¬¦ä¸²ç±»å‹çš„å€¼

```js
a.join()
```

è¿”å›æ•°ç»„å…ƒç´ æ‹¼æ¥çš„å­—ç¬¦ä¸²ã€‚ä¼ é€’å‚æ•°ä»¥è‡ªå®šä¹‰åˆ†éš”ç¬¦ï¼š

```js
a.join(',')
```

### å¤åˆ¶æ‰€æœ‰å€¼

```js
const b = Array.from(a)
const b = Array.of(...a)
```

### å¤åˆ¶éƒ¨åˆ†å€¼

```js
const b = Array.from(a, x => x % 2 == 0)
```

### å°†å€¼å¤åˆ¶åˆ°æœ¬èº«å…¶å®ƒä½ç½®

```js
const a = [1, 2, 3, 4]
a.copyWithin(0, 2) // [3, 4, 3, 4]
const b = [1, 2, 3, 4, 5]
b.copyWithin(0, 2) // [3, 4, 5, 4, 5]
//0 is where to start copying into,
// 2 is where to start copying from
const c = [1, 2, 3, 4, 5]
c.copyWithin(0, 2, 4) // [3, 4, 3, 4, 5]
//4  is an end index
```

## å¾ªç¯

JavaScript æä¾›äº†è®¸å¤šç§å¾ªç¯æ–¹æ³•ã€‚è¿™ä¸ªç« èŠ‚é€šè¿‡å°ä¾‹å­å’Œä¸»è¦å±æ€§è®²è§£ç°ä»£ JavaScript ä¸­çš„æ‰€æœ‰å¾ªç¯æ–¹æ³•ã€‚

### for

```js
const list = ['a', 'b', 'c']
for (let i = 0; i < list.length; i++) {
  console.log(list[i]) //value
  console.log(i) //index
}
```

- å¯ä»¥é€šè¿‡ `break` ä¸­æ–­ `for` å¾ªç¯
- å¯ä»¥é€šè¿‡ `continue` è·³è¿‡å½“å‰ `for` å¾ªç¯

### forEach

ES5 ä¸­å¼•å…¥ã€‚ç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œä½ å¯ä»¥é€šè¿‡ `list.forEach()` éå†å®ƒçš„å±æ€§ï¼š

```js
const list = ['a', 'b', 'c']
list.forEach((item, index) => {
  console.log(item) //value
  console.log(index) //index
})
//index is optional
list.forEach(item => console.log(item))
```

ä¸å¹¸çš„æ˜¯ï¼Œä½ ä¸èƒ½ä¸­æ–­è¿™ä¸ªå¾ªç¯ã€‚

### do...while

```js
const list = ['a', 'b', 'c']
let i = 0
do {
  console.log(list[i]) //value
  console.log(i) //index
  i = i + 1
} while (i < list.length)
```

å¯ä»¥é€šè¿‡ `break` ä¸­æ–­ `do...while` å¾ªç¯ï¼š

```js
do {
  if (something) break
} while (true)
```

å¯ä»¥é€šè¿‡ `continue` è·³è¿‡å½“å‰ `do...while` å¾ªç¯ï¼š

```js
do {
  if (something) continue
  //do something else
} while (true)
```

### while

```js
const list = ['a', 'b', 'c']
let i = 0
while (i < list.length) {
  console.log(list[i]) //value
  console.log(i) //index
  i = i + 1
}
```

å¯ä»¥é€šè¿‡ `break` ä¸­æ–­ `while` å¾ªç¯ï¼š

```js
while (true) {
  if (something) break
}
```

å¯ä»¥é€šè¿‡ `continue` è·³è¿‡å½“å‰ `while` å¾ªç¯ï¼š

```js
while (true) {
  if (something) continue
  //do something else
}
```

å’Œ `do...while` ä¸åŒçš„æ˜¯ `do...while` è‡³å°‘ä¼šå¾ªç¯ä¸€æ¬¡ã€‚

### for...in

éå†å¯¹è±¡çš„æ‰€æœ‰å¯è¿­ä»£å±æ€§åã€‚

```js
for (let property in object) {
  console.log(property) //property name
  console.log(object[property]) //property value
}
```

### for...of

ES2015 ä¸­å¼•å…¥äº† `for...of` å¾ªç¯ï¼Œå®ƒç»“åˆäº† forEach çš„æ˜“ç”¨æ€§å’Œä¸èƒ½ä¸­æ–­çš„ç‰¹æ€§ï¼š

```js
//iterate over the value
for (const value of ['a', 'b', 'c']) {
  console.log(value) //value
}

//get the index as well, using `entries()`
for (const [index, value] of ['a', 'b', 'c'].entries()) {
  console.log(index) //index
  console.log(value) //value
}
```

æ³¨æ„ä½¿ç”¨ `const`ã€‚è¿™ä¸ªå¾ªç¯åœ¨æ¯æ¬¡è¿­ä»£éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®‰å…¨çš„ä½¿ç”¨å®ƒæ›¿ä»£ `let`ã€‚

### for...in vs for...of

å’Œ `for...in` ä¸åŒçš„æ˜¯ï¼š

- `for...of` è¿­ä»£å±æ€§å€¼
- `for...in` è¿­ä»£å±æ€§å

## äº‹ä»¶

æµè§ˆå™¨ä¸­çš„ JavaScript ä½¿ç”¨äº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ¨¡å‹ã€‚ä¸‡ç‰©å§‹äºäº‹ä»¶ã€‚è¿™ä¸ªç« èŠ‚ä»‹ç»äº† JavaScript äº‹ä»¶ä»¥äº‹ä»¶å¤„ç†å™¨çš„å·¥ä½œåŸç†ã€‚

äº‹ä»¶å¯èƒ½æ˜¯ DOM åŠ è½½å®Œæˆï¼Œæˆ–è€…æ˜¯å¼‚æ­¥è¯·æ±‚ç»“æŸï¼Œæˆ–è€…æ˜¯ç”¨æˆ·ç‚¹å‡»äº†å…ƒç´ æˆ–æ˜¯æ»šåŠ¨äº†é¡µé¢ï¼Œæˆ–è€…æ˜¯ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜ã€‚

æœ‰å¾ˆå¤šç§ä¸åŒçš„äº‹ä»¶ã€‚

### äº‹ä»¶å¤„ç†å™¨

ä½ å¯ä»¥é€šè¿‡**äº‹ä»¶å¤„ç†å™¨**å“åº”æ‰€æœ‰äº‹ä»¶ï¼Œå°±æ˜¯äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨å¯¹åº”å‡½æ•°ã€‚

ä½ å¯ä»¥å¯¹åŒä¸€ä¸ªäº‹ä»¶æ³¨å†Œå¤šä¸ªå¤„ç†å™¨ï¼Œå®ƒä»¬éƒ½ä¼šåœ¨äº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚

JavaScript æä¾›äº†ä¸‰ç§æ–¹æ³•æ³¨å†Œäº‹ä»¶å¤„ç†å™¨ï¼š

#### è¡Œå†…äº‹ä»¶å¤„ç†å™¨

è¿™ç§æ–¹æ³•ç”±äºè‡ªèº«é™åˆ¶ç°åœ¨å·²ç»å¾ˆå°‘ä½¿ç”¨ï¼Œä½†åœ¨æ—©æœŸçš„ JavaScript ä¸­æ˜¯å”¯ä¸€çš„æ–¹æ³•ï¼š

```js
<a href="site.com" onclick="dosomething();">A link</a>
```

#### DOM äº‹ä»¶å¤„ç†å™¨

å½“ä¸€ä¸ªå¯¹è±¡åªæœ‰ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨æ—¶è¿™ç§æ–¹æ³•å¾ˆå¸¸ç”¨ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ²¡åŠæ³•æ·»åŠ å¤šä¸ªå¤„ç†å™¨ï¼š

```js
window.onload = () => {
  //window loaded
}
```

åœ¨å¤„ç† XHR è¯·æ±‚æ—¶è¿™ä¹Ÿå¾ˆå¸¸è§ï¼š

```js
const xhr = new XMLHttpRequest()
xhr.onreadystatechange = () => {
  //.. do something
}
```

ä½ å¯ä»¥é€šè¿‡ `if ('onsomething' in window) {}` æ£€æŸ¥å¤„ç†å™¨æ˜¯å¦å·²ç»åˆ†é…ç»™æŸä¸ªå±æ€§ã€‚

#### ä½¿ç”¨ addEventListener()

è¿™æ˜¯*å¾ˆç°ä»£çš„æ–¹æ³•*ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸æˆ‘ä»¬æŒ‰éœ€æ³¨å†Œå¤šä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œä½ ä¼šå‘ç°å®ƒæ˜¯æœ€æµè¡Œçš„ï¼š

```js
window.addEventListener('load', () => {
  //window loaded
})
```

> æ³¨æ„ï¼šIE8 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸æ”¯æŒè¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ `attachEvent()` ä»£æ›¿ã€‚å¦‚æœä½ éœ€è¦å…¼å®¹æ—§æµè§ˆå™¨è¿™å¾ˆé‡è¦ã€‚

#### ç›‘å¬ä¸åŒçš„å…ƒç´ 

ä½ å¯ä»¥ç›‘å¬ `window` æ‹¦æˆªâ€œå…¨å±€â€äº‹ä»¶ï¼Œæ¯”å¦‚é”®ç›˜çš„ä½¿ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥ç›‘å¬ç‰¹å®šå…ƒç´ ä¸Šå‘ç”Ÿçš„äº‹ä»¶ï¼Œæ¯”å¦‚é¼ æ ‡ç‚¹å‡»äº†æŸä¸ªæŒ‰é’®ã€‚

è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ `addEventListener` æœ‰æ—¶å€™åœ¨ `window` ä¸Šè°ƒç”¨ï¼Œæœ‰æ—¶é—´åœ¨æŸä¸ª DOM å…ƒç´ ä¸Šã€‚

### äº‹ä»¶å¯¹è±¡

äº‹ä»¶å¤„ç†å™¨ä¼šè·å¾—ä¸€ä¸ª `Event` å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼š

```js
const link = document.getElementById('my-link')
link.addEventListener('click', event => {
  // link clicked
})
```

è¿™ä¸ªå¯¹è±¡åŒ…å«å¾ˆå¤šæœ‰ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ¯”å¦‚ï¼š

- `target`ï¼Œäº‹ä»¶å‘ç”Ÿçš„ç›®æ ‡ DOM å…ƒç´ 
- `type`ï¼Œäº‹ä»¶ç±»å‹
- `stopPropagation()`ï¼Œè°ƒç”¨ä»¥é˜»æ­¢ DOM äº‹ä»¶ä¼ æ’­

([æŸ¥çœ‹å®Œæ•´æ¸…å•](https://developer.mozilla.org/en-US/docs/Web/API/Event))

å…¶å®ƒå±æ€§æä¾›ç»™ç‰¹å®šçš„äº‹ä»¶ï¼Œ`Event` åªæ˜¯ä¸åŒäº‹ä»¶çš„ä¸€ä¸ªæ¥å£ï¼š

- [MouseEvent](https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent)
- [KeyboardEvent](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent)
- [DragEvent](https://developer.mozilla.org/en-US/docs/Web/API/DragEvent)
- [FetchEvent](https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent)
- ç­‰ç­‰

ä¸Šé¢çš„æ¯ä¸€ä¸ªéƒ½é“¾æ¥åˆ°äº† MDN é¡µé¢ï¼Œä½ å¯ä»¥åœ¨é‚£æŸ¥çœ‹å®ƒä»¬æ‰€æœ‰çš„å±æ€§ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä¸€ä¸ªé”®ç›˜äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä½ å¯ä»¥æ£€æŸ¥å“ªä¸ªé”®è¢«æŒ‰ä¸‹ï¼Œé€šè¿‡ `key` å±æ€§å€¼å¾—åˆ°ä¸€ä¸ªæ˜“è¯»çš„å€¼ï¼ˆ`Escape`, `Enter` ç­‰ç­‰ï¼‰ï¼š

```js
window.addEventListener('keydown', event => {
  // key pressed
  console.log(event.key)
})
```

åœ¨é¼ æ ‡äº‹ä»¶ä¸­æˆ‘ä»¬å¯ä»¥ç›´åˆ°å“ªä¸ªæŒ‰é’®è¢«æŒ‰ä¸‹ï¼š

```js
const link = document.getElementById('my-link')
link.addEventListener('mousedown', event => {
  // mouse button pressed
  console.log(event.button) //0=left, 2=right
})
```

### äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•æ‰

äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•æ‰æ˜¯äº‹ä»¶ä¼ æ’­çš„ä¸¤ä¸ªæ¨¡å‹ã€‚

å‡è®¾ä½ çš„ DOMç»“æ„æ˜¯è¿™æ ·çš„ï¼š

```js
<div id="container">
  <button>Click me</button>
</div>
```

ä½ å¸Œæœ›è·Ÿè¸ªç”¨æˆ·ä»€ä¹ˆæ—¶å€™ç‚¹å‡»äº†è¿™ä¸ªæŒ‰é’®ï¼Œä½ æœ‰ä¸¤ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œä¸€ä¸ªåœ¨ `button` ä¸Šï¼Œä¸€ä¸ªåœ¨ `#container` ä¸Šã€‚è®°ä½ï¼Œå­å…ƒç´ ä¸Šçš„ç‚¹å‡»äº‹ä»¶ä¹Ÿä¼šä¼ æ’­åˆ°å®ƒçš„çˆ¶å…ƒç´ ä¸Šï¼Œé™¤éä½ é˜»æ­¢äº†äº‹ä»¶ä¼ æ’­ï¼ˆç¨åè¯¦è§£ï¼‰ã€‚

è¿™äº›äº‹ä»¶å¤„ç†å™¨ä¼šæŒ‰ç…§é¡ºåºè°ƒç”¨ï¼Œè¿™ä¸ªé¡ºåºé€šè¿‡äº‹ä»¶å†’æ³¡/äº‹ä»¶æ•æ‰æ¨¡å‹å†³å®šã€‚

**å†’æ³¡**æ„å‘³ç€äº‹ä»¶ä»è¢«ç‚¹å‡»çš„å…ƒç´ ï¼ˆå­å…ƒç´ ï¼‰ä¸€ç›´å‘ä¸Šä¼ æ’­åˆ°æ‰€æœ‰ç¥–å…ˆå…ƒç´ ï¼Œä»æœ€è¿‘çš„ä¸€ä¸ªå¼€å§‹ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ`button` ä¸Šçš„å¤„ç†å™¨ä¼šåœ¨ `#container` ä¹‹å‰å‘ç”Ÿã€‚

**æ•æ‰**æ°æ°ç›¸åï¼šæœ€å¤–éƒ¨çš„äº‹ä»¶ä¼šåœ¨ç‰¹å®šå¤„ç†å™¨ä¹‹å‰å‘ç”Ÿï¼Œæ¯”å¦‚ `button`ã€‚

**é»˜è®¤é‡‡ç”¨äº‹ä»¶å†’æ³¡æ¨¡å‹ã€‚**

ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨äº‹ä»¶æ•æ‰ï¼Œé€šè¿‡å°† addEventListener çš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ä¸º `true`ï¼š

```js
document.getElementById('container').addEventListener(
  'click',
  () => {
    //window loaded
  },
  true
)
```

æ³¨æ„ï¼š**é¦–å…ˆè¿è¡Œçš„æ˜¯æ•æ‰é˜¶æ®µçš„äº‹ä»¶å¤„ç†å™¨**ï¼Œç„¶åæ‰æ˜¯å†’æ³¡çš„äº‹ä»¶å¤„ç†å™¨ã€‚

è¿™ä¸ªé¡ºåºéµå¾ªè¿™ä¸ªåŸåˆ™ï¼šDOM ä» Window å¯¹è±¡å¼€å§‹éå†æ‰€æœ‰å…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°è¢«ç‚¹å‡»çš„å¯¹è±¡ã€‚æ‰§è¡Œæ­¤æ“ä½œæ—¶ï¼Œä¼šè°ƒç”¨ä»»ä½•ç»‘å®šçš„äº‹ä»¶å¤„ç†å™¨ï¼ˆæ•æ‰é˜¶æ®µï¼‰ã€‚ä¸€æ—¦æ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œå®ƒä¼šé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°å›åˆ° Window å¯¹è±¡ï¼Œæ­¤æ—¶è°ƒç”¨ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨ï¼ˆå†’æ³¡é˜¶æ®µï¼‰ã€‚

### é˜»æ­¢ä¼ æ’­

DOM å…ƒç´ äº‹ä»¶ä¼šä¸€ç›´åœ¨å®ƒçš„æ¯æ ‘ä¸Šä¼ æ’­ï¼Œé™¤éæ‰‹åŠ¨é˜»æ­¢å®ƒï¼š

```js
<html>
  <body>
    <section>
      <a id="my-link" ...>
```

`a` ä¸Šçš„ç‚¹å‡»äº‹ä»¶ä¼šä¼ æ’­åˆ° `section` ç„¶åæ˜¯ `body`ã€‚

ä½ å¯ä»¥è°ƒç”¨ `stopPropagation()` æ–¹æ³•é˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼Œä¸€èˆ¬æ”¾åœ¨äº‹ä»¶å¤„ç†å™¨çš„æœ«å°¾ï¼š

```js
const link = document.getElementById('my-link')
link.addEventListener('mousedown', event => {
  // process the event
  // ...

  event.stopPropagation()
})
```

### å¸¸è§äº‹ä»¶

è¿™æ˜¯ä¸€ä¸ªä½ ç»å¸¸ä¼šç”¨åˆ°çš„äº‹ä»¶æ¸…å•ã€‚

#### load

`window` å’Œ `body` å…ƒç´ çš„ `load` äº‹ä»¶åœ¨é¡µé¢åŠ è½½å®Œæˆæ—¶è§¦å‘ã€‚

#### é¼ æ ‡äº‹ä»¶

`click` äº‹ä»¶åœ¨é¼ æ ‡å•å‡»æ—¶è§¦å‘ã€‚`dbclick` äº‹ä»¶åœ¨åŒå‡»é¼ æ ‡æ—¶è§¦å‘ï¼Œå½“ç„¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šå…ˆè§¦å‘ `click` äº‹ä»¶ã€‚`mousedown`ï¼Œ`mousemove`å’Œ `mouseup`å¯ä»¥å’Œæ‹–åŠ¨äº‹ä»¶ç»“åˆåœ¨ä¸€èµ·ã€‚å°å¿ƒä½¿ç”¨ `mousemove`ï¼Œå®ƒä¼šåœ¨é¼ æ ‡ç§»åŠ¨è¿‡ç¨‹ä¸­è§¦å‘å¾ˆå¤šæ¬¡ï¼ˆç¨åä¼šçœ‹åˆ°*èŠ‚æµ*ï¼‰ã€‚

#### é”®ç›˜äº‹ä»¶

`keydown`äº‹ä»¶åœ¨æŒ‰ä¸‹é”®ç›˜æ—¶è§¦å‘ï¼ˆå¹¶åœ¨*å¤„äºæŒ‰ä¸‹çŠ¶æ€*æ—¶æŒç»­è§¦å‘ï¼‰ã€‚`keyup` äº‹ä»¶åœ¨æ¾å¼€é”®ç›˜æ—¶è§¦å‘ã€‚

#### æ»šåŠ¨

`scroll` äº‹ä»¶åœ¨æ¯ä¸€æ¬¡æ»šåŠ¨é¡µé¢æ—¶è§¦å‘ã€‚åœ¨è¿™ä¸ªäº‹ä»¶å¤„ç†å™¨å†…éƒ¨ï¼Œä½ å¯ä»¥é€šè¿‡ `window.scrollY`ï¼ˆYè½´ï¼‰æŸ¥çœ‹å½“å‰æ»šåŠ¨ä½ç½®ã€‚

æ³¨æ„è¿™ä¸ªäº‹ä»¶ä¸æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå®ƒä¼šåœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­æŒç»­å‘ç”Ÿï¼Œä¸ä»…ä»…æ˜¯åœ¨æ»šåŠ¨å¼€å§‹å’Œæ»šåŠ¨ç»“æŸï¼Œæ‰€ä»¥ä¸è¦åœ¨å¤„ç†äº‹ä»¶æ—¶è¿›è¡Œå¤§é‡è®¡ç®—å’Œæ“ä½œ - ä½¿ç”¨*èŠ‚æµ*ä»£æ›¿ã€‚

### èŠ‚æµ

æ­£å¦‚ä¸Šé¢æåˆ°çš„ï¼Œ`mousemove` å’Œ `scroll`éƒ½ä¸æ˜¯ä¸€æ¬¡æ€§äº‹ä»¶ï¼Œå®ƒä»¬åœ¨æ“ä½œå‘ç”ŸæœŸé—´æŒç»­è°ƒç”¨äº‹ä»¶å¤„ç†å™¨ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬éœ€è¦æä¾›ä½ éœ€è¦çŸ¥é“çš„åæ ‡ã€‚

å¦‚æœä½ åœ¨è¿™äº›äº‹ä»¶å¤„ç†å™¨ä¸­è¿›è¡Œå¤æ‚çš„æ“ä½œï¼Œå°†ä¼šå½±å“æ€§èƒ½ç»™ä½ çš„ç½‘é¡µç”¨æˆ·å¸¦æ¥ç³Ÿç³•çš„ä½“éªŒã€‚

åƒ [Lodash](https://lodash.com/docs/4.17.11#throttle) è¿™æ ·çš„åº“æä¾›äº† 100 è¡Œä»£ç å®ç°çš„èŠ‚æµå‡½æ•°æ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¸€ä¸ªç®€å•åˆå®¹æ˜“ç†è§£çš„å®ç°æ˜¯ä½¿ç”¨å®šæ—¶å™¨æ¯éš” 100ms ç¼“å­˜ä¸€æ¬¡æ»šåŠ¨äº‹ä»¶ï¼š

```js
let cached = null
window.addEventListener('scroll', event => {
  if (!cached) {
    setTimeout(() => {
      //you can access the original event at `cached`
      cached = null
    }, 100)
  }
  cached = event
})
```

## äº‹ä»¶å¾ªç¯

äº‹ä»¶å¾ªç¯æ˜¯ JavaScript ä¸­æœ€é‡è¦çš„å†…å®¹ã€‚

> æˆ‘å·²ç»ä½¿ç”¨ JavaScript å¥½å¤šå¹´äº†ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰*å®Œå…¨*ç†è§£å®ƒçš„å·¥ä½œåŸç†ã€‚å½“ç„¶ä¸äº†è§£è¿™äº›ç»†ææœ«èŠ‚ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä½†é€šå¸¸æ¥è®²ï¼ŒçŸ¥é“å®ƒçš„å·¥ä½œåŸç†æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œä½ å¯èƒ½ä¹Ÿå¾ˆå¥½å¥‡è¿™ä¸ªå†…å®¹ã€‚

è¿™ä¸ªç« èŠ‚è‡´åŠ›äºè§£é‡Š JavaScript å¦‚ä½•æ˜¯å•çº¿ç¨‹å·¥ä½œä»¥åŠå¦‚ä½•å¤„ç†å¼‚æ­¥å‡½æ•°çš„å†…åœ¨ç»†èŠ‚ã€‚

ä½ çš„ JavaScript ä»£ç è¿è¡Œåœ¨å•çº¿ç¨‹ï¼ŒåŒä¸€æ—¶é—´åªä¼šå‘ç”Ÿä¸€ä»¶äº‹æƒ…ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„é™åˆ¶ï¼Œå®ƒç®€åŒ–äº†å¾ˆå¤šç¨‹åºï¼Œä½ ä¸ç”¨å†ä¸ºå¹¶å‘é—®é¢˜æ‹…å¿§ã€‚ä½ åªéœ€è¦å…³æ³¨äº

å¦‚ä½•ä¹¦å†™ä»£ç ï¼Œé¿å…é€ æˆçº¿ç¨‹å µå¡çš„å†…å®¹ï¼Œæ¯”å¦‚åŒæ­¥ç½‘ç»œè¯·æ±‚æˆ–è€…æ— é™[å¾ªç¯](https://flaviocopes.com/javascript-loops/)ã€‚

é€šå¸¸ï¼Œå¤§å¤šæ•°æµè§ˆå™¨çš„æ¯ä¸€ä¸ªæµè§ˆæ ‡ç­¾éƒ½æœ‰ç‹¬ç«‹çš„äº‹ä»¶å¾ªç¯ï¼Œä»¥ä½¿è¿›ç¨‹éš”ç¦»é¿å…æœ‰æ— é™å¾ªç¯æˆ–è€…ç¹é‡å¤„ç†çš„é¡µé¢é˜»å¡æ•´ä¸ªæµè§ˆå™¨ã€‚æµè§ˆå™¨ç®¡ç†å¤šä¸ªå¹¶å‘çš„äº‹ä»¶å¾ªç¯æ¥è§£å†³ API çš„è°ƒç”¨ã€‚Web Workers ä¹Ÿè¿è¡Œåœ¨è‡ªå·±çš„äº‹ä»¶å¾ªç¯é‡Œã€‚

ä½ åªéœ€è¦æ˜ç™½*ä½ çš„ä»£ç *è¿è¡Œåœ¨å•ä¸€äº‹ä»¶å¾ªç¯ï¼Œå¹¶åœ¨å†™ä»£ç æ—¶è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œé¿å…é˜»å¡å®ƒã€‚

### é˜»å¡äº‹ä»¶å¾ªç¯

ä»»ä½•æ‰§è¡Œæ—¶é—´è¿‡é•¿ä¸èƒ½å°†æ§åˆ¶æƒè¿”å›ç»™äº‹ä»¶å¾ªç¯çš„ JavaScript ä»£ç éƒ½ä¼šé˜»å¡é¡µé¢å†…å…¶å®ƒä»£ç çš„æ‰§è¡Œï¼Œç”šè‡³é˜»å¡ UI çº¿ç¨‹ï¼Œå¯¼è‡´ç”¨æˆ·ä¸èƒ½ç‚¹å‡»ã€æ»šåŠ¨é¡µé¢ç­‰ç­‰ã€‚

å¤§å¤šæ•° JavaScript åŸè¯­æ˜¯éé˜»å¡çš„ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼ŒNode.jsæ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰ç­‰ã€‚å‘ç”Ÿé˜»å¡æ˜¯æ„å¤–çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ JavaScript åŸºäºå¤§é‡çš„å›è°ƒä»¥åŠæœ€è¿‘çš„ promises å’Œ async/awaitã€‚

### è°ƒç”¨å †æ ˆ

è°ƒç”¨å †æ ˆæ˜¯ LIFO é˜Ÿåˆ—ï¼ˆLast In, First Outï¼‰ã€‚

äº‹ä»¶å¾ªç¯ä¸æ–­æ£€æŸ¥**è°ƒç”¨å †æ ˆ**é‡Œæ˜¯å¦ä»æœ‰å‡½æ•°éœ€è¦è¿è¡Œã€‚äºæ­¤åŒæ—¶ï¼Œå®ƒå°†æ‰¾åˆ°çš„å‡½æ•°åŠ å…¥è°ƒç”¨å †æ ˆï¼Œç„¶åæŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚

ä½ äº†è§£è°ƒè¯•å™¨æˆ–è€…æµè§ˆå™¨æ§åˆ¶å°é‡Œçš„é”™è¯¯å †æ ˆè·Ÿè¸ªä¿¡æ¯å—ï¼Ÿæµè§ˆå™¨åœ¨è°ƒç”¨å †æ ˆä¸­æŸ¥è¯¢å‡½æ•°åå­—ï¼Œç„¶åæ ‡è®°å‡ºå½“å‰è°ƒç”¨ç”±å“ªä¸ªå‡½æ•°è§¦å‘ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7dc3c8bf178?w=592&h=615&f=png&s=51368)

### ä¸€ä¸ªç®€å•çš„äº‹ä»¶å¾ªç¯è¯´æ˜

ä¸¾ä¸ªä¾‹å­ï¼š

```js
const bar = () => console.log('bar')
const baz = () => console.log('baz')

const foo = () => {
  console.log('foo')
  bar()
  baz()
}

foo()
```

è¿™ä¸ªä»£ç æ‰“å°å‡ºï¼š

```js
foo
bar
baz
```

å’Œé¢„æœŸä¸€æ ·ã€‚

å½“è¿™ä¸ªä»£ç è¿è¡Œæ—¶ï¼Œæœ€å¼€å§‹ `foo()` è¢«è°ƒç”¨ï¼Œåœ¨  `foo()` å†…éƒ¨å…ˆè°ƒç”¨ `bar()`ï¼Œç„¶åè°ƒç”¨ `baz()`ã€‚

è¿™æ—¶æˆ‘ä»¬çš„è°ƒç”¨æ ˆçœ‹èµ·æ¥å°±æ˜¯è¿™æ ·ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7e41d307208?w=800&h=835&f=png&s=102556)

æ¯æ¬¡è¿­ä»£çš„äº‹ä»¶å¾ªç¯éƒ½ä¼šæŸ¥çœ‹è°ƒç”¨å †æ ˆä¸­æ˜¯å¦è¿˜æœ‰å†…å®¹ï¼Œå¹¶æ‰§è¡Œå®ƒï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7eb2caa076a?w=466&h=769&f=png&s=26416)

ç›´åˆ°æ•´ä¸ªè°ƒç”¨å †æ ˆæ˜¯ç©ºçš„ã€‚

### å‡½æ•°æ‰§è¡Œé˜Ÿåˆ—

ä¸Šé¢çš„ä¾‹å­å¾ˆæ™®é€šï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šä¹‹å¤„ï¼šJavaScript å‘ç°éœ€è¦æ‰§è¡Œçš„å†…å®¹ç„¶åæŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å»¶è¿Ÿå‡½æ•°æ‰§è¡Œç›´åˆ°æ¸…ç©ºè°ƒç”¨æ ˆã€‚

ä½¿ç”¨ `setTimeout(() => {}, 0)`è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä¼šåœ¨å…¶å®ƒå‡½æ•°å…¨éƒ¨æ‰§è¡Œå®Œæ¯•é‚£ä¸€åˆ»æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
const bar = () => console.log('bar')
const baz = () => console.log('baz')

const foo = () => {
  console.log('foo')
  setTimeout(bar, 0)
  baz()
}

foo()
```

ç»“æœä»¤äººæƒŠè®¶ï¼š

```js
foo
baz
bar
```

å½“è¿™ä¸ªä»£ç è¿è¡Œæ—¶ï¼Œ`foo()` å…ˆè¢«è°ƒç”¨ã€‚`foo()` å†…éƒ¨å…ˆè°ƒç”¨ setTimeoutï¼Œå°† `bar` ä½œä¸ºå‚æ•°ä¼ å…¥å®šæ—¶å™¨ï¼Œæˆ‘ä»¬ä¼ å…¥ 0 æŒ‡ç¤ºå®ƒç«‹å³æ‰§è¡Œï¼Œç„¶åè°ƒç”¨ `baz()`ã€‚

è¿™æ—¶è°ƒç”¨æ ˆæ—¶è¿™æ ·çš„ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7f0d4101f4c?w=800&h=762&f=png&s=96234)

æˆ‘ä»¬çš„ç¨‹åºä¸­æ‰€æœ‰å‡½æ•°çš„æ‰§è¡Œé¡ºåºï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7f44089f49d?w=470&h=851&f=png&s=30295)

ä¸ºä»€ä¹ˆè¿™æ ·ï¼Ÿ

### æ¶ˆæ¯é˜Ÿåˆ—

å½“ setTimeout() è°ƒç”¨æ—¶ï¼Œæµè§ˆå™¨æˆ–è€… Node.js å¼€å§‹è®¡æ—¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°† 0 ä½œä¸ºå»¶æ—¶æ—¶é—´ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œå›è°ƒå‡½æ•°å°±ä¼šè¢«æ¨å…¥**æ¶ˆæ¯é˜Ÿåˆ—**ã€‚

æ¶ˆæ¯é˜Ÿåˆ—ä¹ŸåŒ…å«ç”¨æˆ·å‘å‡ºçš„ç‚¹å‡»æˆ–è€…é”®ç›˜äº‹ä»¶ï¼Œæˆ–è€…æ˜¯åœ¨ä½ çš„ä»£ç ä¹‹å‰å·²ç»å­˜åœ¨çš„è·å–å“åº”çš„é˜Ÿåˆ—ï¼Œæˆ–è€…æ˜¯åƒ `onLoad` è¿™æ ·çš„ DOM äº‹ä»¶ã€‚

**æ•´ä¸ªå¾ªç¯ä¼šä¼˜å…ˆè¿›è¡Œè°ƒç”¨å †æ ˆï¼Œå®ƒä¼šå…ˆå¤„ç†è°ƒç”¨å †æ ˆé‡Œæ‰¾åˆ°çš„æ‰€æœ‰å†…å®¹ï¼Œä¸€æ—¦æ²¡æœ‰å†…å®¹ï¼Œå®ƒå°±ä¼šåœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œæ‹¾å–å†…å®¹ã€‚**

æˆ‘ä»¬ä¸å¿…ç­‰å¾…åƒ `setTimeout`ï¼Œfetchç­‰å…¶å®ƒè‡ªå·±å®Œæˆå·¥ä½œçš„å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬ç”±æµè§ˆå™¨æä¾›ï¼Œå…·æœ‰è‡ªå·±çš„çº¿ç¨‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ è®¾ç½®ä¸€ä¸ªå»¶æ—¶ 2 ç§’çš„ `setTimeout` å®šæ—¶å™¨ï¼Œä½ ä¸ç”¨ç­‰å¾… 2 ç§’ - ç­‰å¾…åœ¨åˆ«çš„åœ°æ–¹å®Œæˆã€‚

### ES6 å·¥ä½œé˜Ÿåˆ—ï¼ˆJob Queue)

ECMASciprt 2015 å¼•å…¥äº†å·¥ä½œé˜Ÿåˆ—æ¦‚å¿µï¼Œç”¨åœ¨ Promisesï¼ˆåŒæ ·åœ¨ ES6/ES2015 ä¸­å¼•å…¥ï¼‰ä¸­ã€‚è¿™æ˜¯ä¸€ç§å°½å¿«æ‰§è¡Œå¼‚æ­¥å‡½æ•°çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯æ”¾åœ¨è°ƒç”¨å †æ ˆçš„æœ«å°¾ã€‚

åœ¨å½“å‰å‡½æ•°ç»“æŸå‰å®Œæˆçš„ Promises å°†ä¼šåœ¨å½“å‰å‡½æ•°ä¹‹åæ‰§è¡Œã€‚

æˆ‘å‘ç°åœ¨æ¸¸ä¹åœºåè¿‡å±±è½¦å¯ä»¥å¾ˆå¥½çš„è§£é‡Šè¿™ä¸ªå†…å®¹ï¼šæ¶ˆæ¯é˜Ÿåˆ—å°†ä½ æ”¾åœ¨å…¶å®ƒæ¸¸å®¢é˜Ÿåˆ—ä¹‹åï¼Œå·¥ä½œé˜Ÿåˆ—æ˜¯ä¸€å¼ å¿«é€Ÿé€šè¡Œè¯ï¼Œèƒ½è®©ä½ æ’é˜Ÿæå‰åä¸Šè¿‡å±±è½¦ã€‚

ä¾‹å­ï¼š

```js
const bar = () => console.log('bar')
const baz = () => console.log('baz')

const foo = () => {
  console.log('foo')
  setTimeout(bar, 0)
  new Promise((resolve, reject) =>
    resolve('should be right after baz, before bar')
  ).then(resolve => console.log(resolve))
  baz()
}

foo()
```

è¿™ä¼šæ‰“å°å‡ºï¼š

```js
foo
baz
should be right after baz, before bar
bar
```

è¿™æ˜¯ Promisesï¼ˆåŒ…æ‹¬åŸºäº promises çš„ Async/awaitï¼‰å’ŒåŸç”Ÿçš„æ—§å¼‚æ­¥å‡½æ•° `setTimeout()` æˆ–è€…å…¶å®ƒå¹³å° API ä¹‹é—´æœ€å¤§çš„ä¸åŒã€‚

## å¼‚æ­¥ç¼–ç¨‹å’Œå›è°ƒ

JavaScript é»˜è®¤å°±æ˜¯å¼‚æ­¥å’Œå•çº¿ç¨‹çš„ã€‚è¿™æ„å‘³ç€ä»£ç ä¸èƒ½åˆ›å»ºæ–°çº¿ç¨‹å¹¶ä¸”å¹¶è¡Œè¿è¡Œã€‚è®©æˆ‘ä»¬äº†è§£å¼‚æ­¥ä»£ç æ˜¯ä»€ä¹ˆã€‚

### ç¼–ç¨‹è¯­è¨€é‡Œçš„å¼‚æ­¥

è®¡ç®—æœºåœ¨è®¾è®¡ä¸Šæ˜¯å¼‚æ­¥çš„ã€‚

å¼‚æ­¥æ˜¯æŸäº›ä¸œè¥¿å¯ä»¥ç‹¬ç«‹äºä¸»ç¨‹åºæµç¨‹å‘ç”Ÿã€‚

åœ¨å½“å‰çš„æ¶ˆè´¹è®¡ç®—æœºä¸­ï¼Œæ¯ä¸€ä¸ªç¨‹åºéƒ½è¿è¡Œåœ¨ä¸€ä¸ªç‰¹æ®Šçš„æ—¶é—´æ®µï¼Œç„¶ååœæ­¢ä¹‹åè®©å…¶å®ƒç¨‹åºå¼€å§‹è¿è¡Œã€‚è¿™ä¸€åˆ‡å‘ç”Ÿçš„å¾ˆå¿«ä»¥è‡³äºæˆ‘ä»¬æ— æ³•æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬è®¤ä¸ºæˆ‘ä»¬çš„è®¡ç®—æœºåŒæ—¶è¿è¡Œè®¸å¤šç¨‹åºï¼Œä½†è¿™æ˜¯ä¸€ç§è¯¯è§£ï¼ˆé™¤äº†å¤šè¿›ç¨‹æœºå™¨ï¼‰ã€‚

ç¨‹åºå†…éƒ¨ä½¿ç”¨*ä¸­æ–­*ï¼Œä¸€ç§æäº¤ç»™å¤„ç†å™¨è·å¾—ç³»ç»Ÿæ³¨æ„çš„ä¿¡å·ã€‚

æˆ‘ä¸ä¼šæ·±å…¥ä»‹ç»å®ƒï¼Œä½†æ˜¯è¦è®°ä½è¿™å¯¹å¼‚æ­¥ç¨‹åºæ¥è¯´å¾ˆæ™®ä¾¿ï¼Œåœ¨å®ƒä»¬è¢«æ³¨æ„ä¹‹å‰åœæ­¢æ‰§è¡Œï¼ŒåŒæ—¶è®¡ç®—æœºå¯ä»¥æ‰§è¡Œå…¶å®ƒå†…å®¹ã€‚å½“ä¸€ä¸ªç¨‹åºç­‰å¾…ç½‘ç»œå“åº”æ—¶ï¼Œåªæœ‰ç­‰è¯·æ±‚ç»“æŸæ‰èƒ½ç»ˆæ­¢è¿è¡Œã€‚

ä¸€èˆ¬ï¼Œç¼–ç¨‹è¯­è¨€æ˜¯å¼‚æ­¥çš„ï¼Œå…¶ä¸­ä¸€äº›ä¹Ÿä¼šæä¾›å¼‚æ­¥æ“ä½œçš„åŠæ³•ï¼Œè¿™äº›è¯­è¨€æˆ–è€…åº“ï¼ŒC è¯­è¨€ï¼ŒJavaï¼ŒC#ï¼ŒPHPï¼ŒGoï¼ŒRubyï¼ŒSwiftï¼ŒPython é»˜è®¤éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå…¶ä¸­ä¸€äº›é€šè¿‡ä½¿ç”¨çº¿ç¨‹å¤„ç†å¼‚æ­¥ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°è¿›ç¨‹ã€‚

### JavaScript

JavaScript é»˜è®¤å°±æ˜¯å¼‚æ­¥å’Œå•çº¿ç¨‹çš„ã€‚è¿™æ„å‘³ç€ä»£ç ä¸èƒ½åˆ›å»ºæ–°çº¿ç¨‹å¹¶ä¸”å¹¶è¡Œè¿è¡Œã€‚

æ¯è¡Œä»£ç éƒ½æ˜¯ä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œï¼Œä¸¾ä¸ªä¾‹å­ï¼š

```js
const a = 1
const b = 2
const c = a * b
console.log(c)
doSomething()
```

ä½†æ˜¯ JavaScript æ˜¯ä¸ºäº†æµè§ˆå™¨è€Œç”Ÿçš„ï¼Œä¸€å¼€å§‹å®ƒçš„ä¸»è¦å·¥ä½œæ˜¯å“åº”ç”¨æˆ·çš„æ“ä½œï¼Œæ¯”å¦‚ `onClick`ï¼Œ`onMouseOver`ï¼Œ`onChnage`ï¼Œ`onSubmit` ç­‰ç­‰ã€‚å®ƒæ€ä¹ˆèƒ½ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ï¼Ÿ

ç­”æ¡ˆåœ¨å®ƒçš„ç¯å¢ƒä¸­ã€‚**æµè§ˆå™¨**é€šè¿‡æä¾›ä¸€ç³»åˆ—å¯ä»¥å¤„ç†è¿™ç§åŠŸèƒ½çš„ API è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

å°¤å…¶æœ€è¿‘ Node.js å¼•å…¥äº†éé˜»å¡ I/O ç¯å¢ƒå°†è¿™ä¸ªç†å¿µæ‰©å±•åˆ°æ–‡ä»¶è®¿é—®ï¼Œç½‘ç»œè°ƒç”¨ç­‰ç­‰æ–¹é¢ã€‚

### å›è°ƒå‡½æ•°

ä½ æ— æ³•çŸ¥é“ç”¨æˆ·ä½•æ—¶è¦å•å‡»æŒ‰é’®ï¼Œå› æ­¤ä½ **è¦ä¸º click äº‹ä»¶å®šä¹‰äº‹ä»¶å¤„ç†ç¨‹åº**ã€‚æ­¤äº‹ä»¶å¤„ç†ç¨‹åºæ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨è§¦å‘äº‹ä»¶æ—¶è°ƒç”¨ï¼š

```js
document.getElementById('button').addEventListener('click', () => {
  //item clicked
})
```

è¿™ä¹Ÿè¢«å«åš**å›è°ƒå‡½æ•°**ã€‚

å›è°ƒæ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œä½œä¸ºå€¼ä¼ å…¥å…¶å®ƒå‡½æ•°ï¼Œåªä¼šåœ¨äº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ˜¯å› ä¸º JavaScript çš„å¤´ç­‰å‡½æ•°å¯ä»¥å’Œå˜é‡ç»‘å®šå¹¶ä¼ å…¥å…¶å®ƒå‡½æ•°ï¼ˆç§°ä½œ**é«˜é˜¶å‡½æ•°**ï¼‰ã€‚

æŠŠä½ æ‰€æœ‰çš„ä»£ç åŒ…è£¹åœ¨ `window` å¯¹è±¡ä¸Šçš„ `load` äº‹ä»¶ç›‘å¬å™¨é‡Œæ˜¯å¾ˆå¸¸è§çš„ï¼Œè¿™æ ·ä»£ç åªä¼šåœ¨é¡µé¢å‡†å¤‡å¥½æ—¶è¿è¡Œï¼š

```js
window.addEventListener('load', () => {
  //window loaded
  //do what you want
})
```

å›è°ƒå‡½æ•°ä»»ä½•åœ°æ–¹éƒ½ä¼šç”¨åˆ°ï¼Œä¸ä»…ä»…æ˜¯ DOM äº‹ä»¶ã€‚

ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯ä½¿ç”¨å®šæ—¶å™¨ï¼š

```js
setTimeout(() => {
  // runs after 2 seconds
}, 2000)
```

XHR è¯·æ±‚åŒæ ·æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†ä¸€ä¸ªå‡½æ•°åˆ†é…ç»™ä¸€ä¸ªå±æ€§ï¼Œè¿™æ ·å½“ç‰¹å®šäº‹ä»¶ï¼ˆè¿™é‡Œæ˜¯è¯·æ±‚çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼‰å‘ç”Ÿæ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼š

```js
const xhr = new XMLHttpRequest()
xhr.onreadystatechange = () => {
  if (xhr.readyState === 4) {
    xhr.status === 200 ? console.log(xhr.responseText) : console.error('error')
  }
}
xhr.open('GET', 'https://yoursite.com')
xhr.send()
```

### å¤„ç†å›è°ƒä¸­çš„é”™è¯¯

ä½ å¦‚ä½•å¤„ç†å›è°ƒé”™è¯¯ï¼Ÿä¸€ä¸ªå¸¸è§çš„ç­–ç•¥æ˜¯é‡‡ç”¨ Node.js çš„æ–¹æ³•ï¼šå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆæ˜¯é”™è¯¯å¯¹è±¡ï¼š**é”™è¯¯ä¼˜å…ˆå›è°ƒ**ã€‚

å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¿™ä¸ªå¯¹è±¡ä¸º `null`ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå®ƒåŒ…å«æè¿°é”™è¯¯å’Œå…¶å®ƒä¿¡æ¯çš„å†…å®¹ã€‚

```js
fs.readFile('/file.json', (err, data) => {
  if (err !== null) {
    //handle error
    console.log(err)
    return
  }
  //no errors, process data
  console.log(data)
})
```

### å›è°ƒä¼´éšçš„é—®é¢˜

å›è°ƒè®©ç®€å•ä»£ç æ›´ç®€å•ï¼

ç„¶è€Œæ¯ä¸€ä¸ªå›è°ƒå‡½æ•°éƒ½ä¼šæ·»åŠ ä¸€çº§åµŒå¥—ï¼Œå¦‚æœä½ æœ‰å¾ˆå¤šä¸ªå›è°ƒå‡½æ•°ï¼Œä»£ç ä¼šå˜å¾—ååˆ†å¤æ‚ï¼š

```js
window.addEventListener('load', () => {
  document.getElementById('button').addEventListener('click', () => {
    setTimeout(() => {
      items.forEach(item => {
        //your code here
      })
    }, 2000)
  })
})
```

è¿™ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„å››çº§ä»£ç ï¼Œä½†æ˜¯æˆ‘çœ‹åˆ°å¾ˆå¤šå±‚åµŒå¥—ï¼Œè¿™å¹¶ä¸æœ‰è¶£ã€‚

æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

### å›è°ƒçš„æ›¿ä»£æ–¹æ¡ˆ

ä» ES6 å¼€å§‹ï¼ŒJavaScript å¼•å…¥äº†å¾ˆå¤šåŠŸèƒ½è®©æˆ‘ä»¬ä¸ç”¨å›è°ƒå°±èƒ½ä¼˜é›…çš„å†™å¼‚æ­¥ä»£ç ï¼š

- Promisesï¼ˆES6)
- Async/Awaitï¼ˆES8)

## Promises

Promises æ˜¯ JavaScript è§£å†³å¼‚æ­¥ä»£ç ä¸­éœ€è¦å†™å¤ªå¤šå›è°ƒå‡½æ•°çš„ä¸€ç§æ–¹æ³•ã€‚

Promises é€šå¸¸è¢«å®šä¹‰ä¸º**ä¸€ä¸ªæœ€ç»ˆå¯ç”¨çš„å€¼çš„ä»£ç†ï¼ˆa proxy for a value that will eventually become availableï¼‰ã€‚**

Promises æ˜¯ä¸€ä¸ªè§£å†³å¼‚æ­¥ä»£ç çš„æ–¹æ³•ï¼Œä¸ç”¨åœ¨ä»£ç ä¸­å†™å¤ªå¤šå›è°ƒå‡½æ•°ã€‚å°½ç®¡è¿™äº›å¹´å·²ç»å˜å¾—å¾ˆæµè¡Œï¼Œä¹Ÿåœ¨ ES2015 ä¸­è¢«å¼•å…¥å¹¶æˆä¸ºæ ‡å‡†ï¼Œåœ¨ ES2017 ä¸­ä¹Ÿè¢«å¼‚æ­¥å‡½æ•°ï¼ˆasync functionsï¼‰ä»£æ›¿ã€‚

### promises å·¥ä½œåŸç†ï¼ˆç®€çŸ­ï¼‰

ä¸€æ—¦ä¸€ä¸ª promise è¢«è°ƒç”¨ï¼Œå®ƒå°±ä¼šå˜æˆ **pending çŠ¶æ€**ã€‚è¿™æ„å‘³è°ƒç”¨è€…ä¼šæŒç»­æ‰§è¡Œï¼ŒåŒæ—¶ç­‰å¾…è‡ªèº«å¤„ç†ç»“æœï¼Œç„¶åç»™è°ƒç”¨å‡½æ•°ä¸€äº›åé¦ˆã€‚

æ­¤æ—¶ï¼Œè¯¥è°ƒç”¨å‡½æ•°ç­‰å¾…è¿™ä¸ª promise è¿”å› **resolved çŠ¶æ€** æˆ–è€… **rejected çŠ¶æ€**ï¼Œä½†æ˜¯ä½ çŸ¥é“ [JavaScript](https://flaviocopes.com/javascript/) æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥*è¿™ä¸ªå‡½æ•°ä¼šåœ¨  promise å·¥ä½œæ—¶ç»§ç»­æ‰§è¡Œå…¶å®ƒä»£ç *ã€‚

### å“ªäº› JS API ä½¿ç”¨ promisesï¼Ÿ

é™¤äº†ä½ è‡ªå·±çš„ä»£ç å’Œä¸€äº›åº“ä¹‹å¤–ï¼Œç°åœ¨ Web API ä¹Ÿä½¿ç”¨ promisesï¼š

- ç”µæ±  API
- [Fetch API](https://flaviocopes.com/fetch-api/)
- [Service Workers](https://flaviocopes.com/service-workers/)

åœ¨ç°ä»£ JavaScript ä¸­ä½ ä¸å¤ªå¯èƒ½*ä¸ä½¿ç”¨* promisesï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ·±æŒ–ä¸€ä¸‹å®ƒã€‚

### åˆ›å»º promise

Promise API æš´éœ²å‡ºä¸€ä¸ª Promise æ„é€ å‡½æ•°ï¼Œä½ å¯ä»¥é€šè¿‡ `new Promise()` åˆå§‹åŒ–ï¼š

```js
let done = true

const isItDoneYet = new Promise(
  (resolve, reject) => {
    if (done) {
      const workDone = 'Here is the thing I built'
      resolve(workDone)
    } else {
      const why = 'Still working on something else'
      reject(why)
    }
  }
)
```

ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ª promise åœ¨å…¨å±€å¸¸é‡ `done` ä¸º true æ—¶ï¼Œè¿”å›ä¸€ä¸ªå·²è§£å†³çš„ promiseï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªè¢«æ‹’ç»çš„ promiseã€‚

ä½¿ç”¨ `resolve` å’Œ `reject`æˆ‘ä»¬å¯ä»¥å›ä¼ ä¸€ä¸ªå€¼ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿”å›äº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚

### ä½¿ç”¨ promise

åœ¨ä¸Šä¸ªç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª promiseã€‚

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•*ä½¿ç”¨* promiseã€‚

```js
const isItDoneYet = new Promise(
  //...
)

const checkIfItsDone = () => {
  isItDoneYet
    .then((ok) => {
      console.log(ok)
    })
    .catch((err) => {
      console.error(err)
    })
}
```

è¿è¡Œ `checkIfItsDone()` ä¼šæ‰§è¡Œ `isItDoneYet()` promise ç„¶åç­‰å¾…å®ƒ resolve è°ƒç”¨ `then` å›è°ƒï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œä¼šåœ¨ `catch` å›è°ƒä¸­å¤„ç†é”™è¯¯ã€‚

### é“¾å¼ promise

promise å¯ä»¥è¿”å›å¦ä¸€ä¸ª promiseï¼Œå½¢æˆé“¾å¼ promiseã€‚

Fecth APIï¼ˆXMLHttpRequest API ä¸Šå±‚ APIï¼‰æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒè·å–èµ„æºå¹¶ç”¨ promise é“¾å¼æ“ä½œèµ„æºã€‚

Fetch API åŸºäº promise æœºåˆ¶ï¼Œè°ƒç”¨ `fetch()` ç­‰åŒäºæˆ‘ä»¬é€šè¿‡ `new promise()` å®šä¹‰ä¸€ä¸ª promiseã€‚

#### é“¾å¼ promise ä¾‹å­

```js
const status = (response) => {
  if (response.status >= 200 && response.status < 300) {
    return Promise.resolve(response)
  }
  return Promise.reject(new Error(response.statusText))
}

const json = (response) => response.json()
fetch('/todos.json')
  .then(status)
  .then(json)
  .then((data) => { console.log('Request succeeded with JSON response', data) })
  .catch((error) => { console.log('Request failed', error) })
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ `fetch()` ä»æ ¹åŸŸåä¸­çš„ `todos.json` æ–‡ä»¶è·å–ä¸€ä¸ª TODO æ¸…å•ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª promises é“¾ã€‚

è¿è¡Œ `fetch()` è¿”å›ä¸€ä¸ªåŒ…å«å¾ˆå¤šä¸ªå±æ€§çš„[å“åº”](https://fetch.spec.whatwg.org/#concept-response)ï¼Œæˆ‘ä»¬å¼•ç”¨äº†å…¶ä¸­çš„ï¼š

- `status`ï¼Œååº” HTTP çŠ¶æ€çš„æ•°å€¼
- `statusText`ï¼ŒçŠ¶æ€æ¶ˆæ¯ï¼Œè¯·æ±‚æˆåŠŸæ—¶ä¸º `OK`

`response` ä¹Ÿæœ‰ä¸€ä¸ª `json()` æ–¹æ³•ï¼Œå¯ä»¥å°†æˆåŠŸè·å–çš„å“åº”å†…å®¹è½¬åŒ–ä¸º JSON å¹¶ä½œä¸º promise è¿”å›ã€‚

åŸºäºæ­¤ï¼šé“¾ä¸­ç¬¬ä¸€ä¸ª promise æ˜¯æˆ‘ä»¬å®šä¹‰çš„å‡½æ•° `status()`ï¼Œå®ƒç”¨æ¥æ£€æŸ¥å“åº”çŠ¶æ€ï¼Œå½“ç»“æœä¸åœ¨ 200 å’Œ 299 ä¹‹é—´æ—¶æ‹’ç»è¿™ä¸ª promiseã€‚è¿™æ ·ä¼šå¯¼è‡´ promise é“¾è·³è¿‡æ‰€æœ‰é“¾è¡¨ç›´æ¥è¿›å…¥æœ«å°¾çš„ `catch()` è¯­å¥ï¼Œæ‰“å°å‡º `Request failed`å’Œé”™è¯¯ä¿¡æ¯ã€‚

å¦‚æœæˆåŠŸï¼Œå®ƒä¼šè°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„ `json()`å‡½æ•°ã€‚å½“æˆåŠŸæ—¶ï¼Œä¸Šä¸€ä¸ª promise è¿”å› `response` å¯¹è±¡ï¼Œä½œä¸ºç¬¬äºŒä¸ª promise çš„è¾“å…¥ã€‚

åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿”å›å¤„ç†è¿‡çš„ JSON æ•°æ®ï¼Œæ‰€ä»¥ç¬¬ä¸‰ä¸ª promise ç›´æ¥è·å¾— JSON å¯¹è±¡ï¼š

```js
.then((data) => {
  console.log('Request succeeded with JSON response', data)
})
```

åœ¨æ§åˆ¶å°ä¼šæ‰“å°å‡ºè¿™äº›å†…å®¹ã€‚

### å¤„ç†é”™è¯¯

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œpromises é“¾åé¢æœ‰ä¸€ä¸ª `catch` å—ã€‚å½“é“¾å¼ promises æœ‰ä»»ä½•é”™è¯¯å‘ç”Ÿï¼Œäº¦æˆ–æ‰‹åŠ¨è¿”å› rejectsï¼Œç¨‹åºæ§åˆ¶æƒä¼šäº¤ç»™é”™è¯¯ä»£ç åè·ç¦»æœ€è¿‘çš„ `catch()` è¯­å¥ã€‚

```js
new Promise((resolve, reject) => {
  throw new Error('Error')
})
  .catch((err) => { console.error(err) })

// or

new Promise((resolve, reject) => {
  reject('Error')
})
  .catch((err) => { console.error(err) })
```

### çº§è”é”™è¯¯

å¦‚æœåœ¨ `catch()` å†…éƒ¨åˆæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œä½ å¯ä»¥æ·»åŠ ç¬¬äºŒä¸ª `catch()` å¤„ç†å®ƒï¼Œä»¥æ­¤ç±»æ¨ã€‚

```js
new Promise((resolve, reject) => {
  throw new Error('Error')
})
  .catch((err) => { throw new Error('Error') })
  .catch((err) => { console.error(err) })
```

### ç¼–æ’ promises

#### Promise.all()

å¦‚æœä½ éœ€è¦åŒæ—¶å¤„ç†å¤šä¸ª promisesï¼Œ`Promise.all()` å¯ä»¥å¸®åŠ©ä½ å®šä¹‰ä¸€ç»„ promisesï¼Œç­‰å¾…å®ƒä»¬å…¨éƒ¨å®Œæˆä¹‹åå†æ‰§è¡ŒæŸäº›æ“ä½œã€‚æ¯”å¦‚ï¼š

```js
const f1 = fetch('/something.json')
const f2 = fetch('/something2.json')

Promise.all([f1, f2]).then((res) => {
    console.log('Array of results', res)
})
.catch((err) => {
  console.error(err)
})
```

ES2015 çš„ç»“æ„è¯­æ³•ä¹Ÿå…è®¸ä½ è¿™ä¹ˆåšï¼š

```js
Promise.all([f1, f2]).then(([res1, res2]) => {
    console.log('Results', res1, res2)
})
```

è¿™ä¸ä»…é™äº `fetch`ï¼Œ**ä»»ä½• promise éƒ½å¯ä»¥å¤„ç†**ã€‚

#### Promise.race()

å½“ä¼ å…¥çš„ promise æœ‰ä¸€ä¸ªå®Œæˆ `Promise.race()` å°±å¼€å§‹è¿è¡Œï¼Œä¸”åªä¼šè¿è¡Œä¸€æ¬¡é™„åŠ çš„å›è°ƒå‡½æ•°ï¼Œä¼ å…¥é¦–å…ˆè¿è¡Œå®Œçš„ promise è¿”å›çš„ç»“æœã€‚ä¾‹å­ï¼š

```js
const first = new Promise((resolve, reject) => {
    setTimeout(resolve, 500, 'first')
})
const second = new Promise((resolve, reject) => {
    setTimeout(resolve, 100, 'second')
})

Promise.race([first, second]).then((result) => {
  console.log(result) // second
})
```

## Async å’Œ Await

ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ¢è®¨ JavaScript ä¸­æ›´ç°ä»£çš„å¼‚æ­¥å‡½æ•°æ–¹æ³•ã€‚JavaScript ä»å›è°ƒå‡½æ•°å‘å±•ä¸º Promise åªç”¨äº†å¾ˆçŸ­çš„æ—¶é—´ï¼Œä» ES2017 å¼€å§‹ï¼Œasync å’Œ await è®©å¼‚æ­¥ JavaScript å˜å¾—æ›´åŠ ç®€å•ã€‚

å¼‚æ­¥å‡½æ•°ç»“åˆäº† promise å’Œç”Ÿæˆå™¨ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥çœ‹ä½œæ˜¯ promises ä¹‹ä¸Šçš„æŠ½è±¡æ–¹æ³•ã€‚æˆ‘å†é‡å¤ä¸€éï¼š**async å’Œ await åŸºäº promises**ã€‚

### ä¸ºä»€ä¹ˆå¼•å…¥ async å’Œ awaitï¼Ÿ

å®ƒä»¬å‡å°‘äº† promises çš„å›ºå®šæ ·æ¿å’Œé“¾å¼ promise â€œä¸èƒ½åˆ‡æ–­é“¾å¼â€çš„é™åˆ¶ã€‚

ES2015 å¼•å…¥ promises æ—¶ï¼Œåªæ˜¯ä¸ºäº†è§£å†³å¼‚æ­¥ä»£ç çš„é—®é¢˜ï¼Œè¿™ä¸€ç‚¹åšå¾—å¾ˆå¥½ï¼Œä½†æ˜¯ï¼ŒES2015 å’Œ ES2017 ä¹‹é—´çš„è¿™ä¸¤å¹´äººä»¬å‘ç° *promises å¹¶ä¸æ˜¯æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆ*ã€‚

å¼•å…¥ Promises æ˜¯ä¸ºäº†è§£å†³è‘—åçš„*å›è°ƒåœ°ç‹±*é—®é¢˜ï¼Œä½†å…¶è‡ªèº«ä¹Ÿå¾ˆå¤æ‚ï¼Œå¼•å…¥äº†æ›´å¤æ‚çš„è¯­æ³•ã€‚

å®ƒä»¬æ˜¯å¾ˆå¥½çš„å¼€å§‹ï¼Œä½†æ˜¯åº”è¯¥æœ‰æ›´å¥½çš„è¯­æ³•ä¾›å¼€å‘è€…ä½¿ç”¨ï¼Œæ‰€ä»¥**å¼‚æ­¥å‡½æ•°ï¼ˆasync functionsï¼‰**è¯ç”Ÿäº†ã€‚å®ƒè®©ä»£ç çœ‹èµ·æ¥æ˜¯åŒæ­¥çš„ï¼Œä½†å…¶å®å®ƒä»¬æ˜¯å¼‚æ­¥çš„å¹¶ä¸ä¼šé˜»å¡åé¢çš„ä»£ç ã€‚

### å·¥ä½œåŸç†

ä¸€ä¸ªå¼‚æ­¥å‡½æ•°è¿”å›ä¸€ä¸ª promiseï¼Œå°±åƒè¿™ä¸ªä¾‹å­ï¼š

```js
const doSomethingAsync = () => {
    return new Promise((resolve) => {
        setTimeout(() => resolve('I did something'), 3000)
    })
}
```

ä½ åœ¨å‰é¢åŠ ä¸Š `await` ç„¶å**è°ƒç”¨**è¿™ä¸ªå‡½æ•°ï¼Œè¿™æ ·**ä»£ç ä¼šæš‚åœæ‰§è¡Œç›´åˆ°è¿™ä¸ª promise å˜æˆ resolved æˆ–è€… rejected**ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå§”æ‰˜å‡½æ•°å¿…é¡»å®šä¹‰ä¸º `async`ã€‚ä¾‹å­ï¼š

```js
const doSomething = async () => {
    console.log(await doSomethingAsync())
}
```

### ä¾‹å­

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ async/await å¼‚æ­¥è¿è¡Œå‡½æ•°çš„ä¾‹å­ï¼š

```js
const doSomethingAsync = () => {
    return new Promise((resolve) => {
        setTimeout(() => resolve('I did something'), 3000)
    })
}

const doSomething = async () => {
    console.log(await doSomethingAsync())
}

console.log('Before')
doSomething()
console.log('After')
```

ä¸Šé¢çš„ä»£ç åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æ‰“å°å‡ºï¼š

```js
Before
After
I did something //after 3s
```

### ä¸€åˆ‡éƒ½æ˜¯ promise

åœ¨ä»»ä½•å‡½æ•°å‰åŠ ä¸Š `async` å‰ç¼€éƒ½ä½¿è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª promiseã€‚å³ä½¿å®ƒæ²¡æœ‰æ˜ç¡®è¿™ä¹ˆåšï¼Œå®ƒä¹Ÿä¼šåœ¨å†…éƒ¨è®©å®ƒè¿”å›ä¸€ä¸ª promiseã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªä»£ç æ˜¯åˆæ³•çš„ï¼š

```js
const aFunction = async () => {
  return 'test'
}

aFunction().then(alert) // This will alert 'test'
```

å®ƒå’Œè¿™ä¸ªç±»ä¼¼ï¼š

```js
const aFunction = async () => {
  return Promise.resolve('test')
}

aFunction().then(alert) // This will alert 'test'
```

### ä»£ç æ›´æ˜“è¯»

ä½ çœ‹æˆ‘ä»¬ä¸Šé¢çš„ä»£ç å’ŒåŸç”Ÿçš„ promise é“¾å¼å›è°ƒæ¯”èµ·æ¥æ˜¯å¤šä¹ˆçš„ç®€å•ã€‚è¿™ä»…ä»…æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼Œä»£ç è¶Šå¤æ‚ï¼Œè¶Šèƒ½å‡¸æ˜¾å®ƒçš„ä¼˜åŠ¿ã€‚

æ‹¿ promises ä¸¾ä¸ªä¾‹å­ï¼Œä½ éœ€è¦è·å–ä¸€ä¸ª JSON èµ„æºå¹¶ä¸”å¯¹å®ƒè¿›è¡Œè§£æï¼š

```js
const getFirstUserData = () => {
  return fetch('/users.json') // get users list
    .then(response => response.json()) // parse JSON
    .then(users => users[0]) // pick first user
    .then(user => fetch(`/users/${user.name}`)) // get user data
    .then(userResponse => response.json()) // parse JSON
}

getFirstUserData()
```

ç”¨ async/await å®ç°åŒæ ·çš„éœ€æ±‚ï¼š

```js
const getFirstUserData = async () => {
  const response = await fetch('/users.json') // get users list
  const users = await response.json() // parse JSON
  const user = users[0] // pick first user
  const userResponse = await fetch(`/users/${user.name}`) // get user data
  const userData = await user.json() // parse JSON
  return userData
}

getFirstUserData()
```

### ä¸²è”å¤šä¸ªå¼‚æ­¥å‡½æ•°

å¼‚æ­¥å‡½æ•°å¯ä»¥å¾ˆå®¹æ˜“çš„ä¸²è”èµ·æ¥ï¼Œè¯­æ³•ä¹Ÿæ¯”åŸç”Ÿ promise æ›´æ˜“è¯»ï¼š

```js
const promiseToDoSomething = () => {
    return new Promise(resolve => {
        setTimeout(() => resolve('I did something'), 10000)
    })
}
const watchOverSomeoneDoingSomething = async () => {
    const something = await promiseToDoSomething()
    return something + ' and I watched'
}
const watchOverSomeoneWatchingSomeoneDoingSomething = async () => {
    const something = await watchOverSomeoneDoingSomething()
    return something + ' and I watched as well'
}

watchOverSomeoneWatchingSomeoneDoingSomething().then((res) => {
    console.log(res)
})
```

æ‰“å°å‡ºï¼š

```js
I did something and I watched and I watched as well
```

### æ›´å®¹æ˜“è°ƒè¯•

è°ƒè¯• promise å¾ˆéš¾ï¼Œå› ä¸ºè°ƒè¯•å™¨ä¸èƒ½è·³è¿‡å¼‚æ­¥ä»£ç ã€‚

Async/await å°±å¾ˆç®€å•äº†ï¼Œå› ä¸ºå¯¹ç¼–è¯‘å™¨æ¥è¯´å®ƒå°±æ˜¯åŒæ­¥ä»£ç ã€‚

## å¾ªç¯ä½œç”¨åŸŸ

å¯¹å¼€å‘è€…æ¥è¯´ï¼ŒJavaScript çš„å¾ªç¯ä½œç”¨åŸŸå¯èƒ½ä¼šè®©äººæ„Ÿåˆ°å¤´ç–¼ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¾ªç¯ä½œç”¨åŸŸä¸­å’Œ varï¼Œlet æœ‰å…³çš„æŠ€å·§ã€‚

ä¾‹å­ï¼š

```js
const operations = []

for (var i = 0; i < 5; i++) {
  operations.push(() => {
    console.log(i)
  })
}

for (const operation of operations) {
  operation()
}
```

å®ƒéå† 5 æ¬¡ï¼Œæ¯æ¬¡æ·»åŠ ä¸€ä¸ªå‡½æ•°åˆ° operations æ•°ç»„ã€‚è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ‰“å°å‡ºå¾ªç¯æ—¶çš„ç´¢å¼•å˜é‡ `i`ã€‚ç¨åè¿è¡Œè¿™äº›å‡½æ•°ã€‚

æœŸæœ›çš„ç»“æœæ˜¯ï¼š

```js
0
1
2
3
4
```

ä½†çœŸå®ç»“æœå´æ˜¯ï¼š

```js
5
5
5
5
5
```

ä¸ºä»€ä¹ˆè¿™æ ·ï¼ŸåŸå› åœ¨äº `var`ã€‚

ç”±äº `var` å£°æ˜ä¼šè¢«æå‡ï¼Œä¸Šé¢çš„ä»£ç ç­‰åŒäºï¼š

```js
var i;
const operations = []

for (i = 0; i < 5; i++) {
  operations.push(() => {
    console.log(i)
  })
}

for (const operation of operations) {
  operation()
}
```

æ‰€ä»¥ï¼Œåœ¨ for-of å¾ªç¯ä¸­ï¼Œ`i` å§‹ç»ˆç­‰äº 5ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­æ¯ä¸€æ¬¡è°ƒç”¨ `i` éƒ½ç­‰äº 5ã€‚

æ‰€ä»¥æˆ‘ä»¬æ€ä¹ˆåšèƒ½è®©å®ƒæŒ‰ç…§æˆ‘ä»¬çš„éœ€è¦å·¥ä½œå‘¢ï¼Ÿ

æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç”¨ `let` å£°æ˜ã€‚åœ¨ ES2015 å¼•å…¥ï¼Œå®ƒå¯ä»¥é¿å… `var` å£°æ˜å¸¦æ¥ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ã€‚

æŠŠå¾ªç¯ä¸­çš„ `var` æ”¹æˆ `let` ä¸€åˆ‡å°±æ­£å¸¸äº†ï¼š

```js
const operations = []

for (let i = 0; i < 5; i++) {
  operations.push(() => {
    console.log(i)
  })
}

for (const operation of operations) {
  operation()
}
```

è¾“å‡ºï¼š

```js
0
1
2
3
4
```

è¿™æ€ä¹ˆå¯èƒ½ï¼ŸåŸå› æ˜¯æ¯ä¸€æ¬¡å¾ªç¯è¿­ä»£ `i` éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œæ¯ä¸ªæ·»åŠ åˆ° `operations` æ•°ç»„çš„å‡½æ•°éƒ½è·å–å½“æ—¶çš„ `i` å‰¯æœ¬ã€‚

å¦ä¸€ä¸ªè§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•åœ¨ ES6 ä¹‹å‰å¾ˆå¸¸ç”¨ï¼Œä½¿ç”¨**ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼**ï¼ˆIIFEï¼‰ã€‚

åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œä½ å¯ä»¥åŒ…è£¹æ•´ä¸ªå‡½æ•°å¹¶ç»‘å®š `i`ã€‚è¿™æ ·æ¯æ¬¡éƒ½åˆ›å»ºäº†ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„å‡½æ•°ï¼Œå¹¶è¿”å›äº†ä¸€ä¸ªæ–°å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¨åæ‰§è¡Œï¼š

```js
const operations = []

for (var i = 0; i < 5; i++) {
  operations.push(((j) => {
    return () => console.log(j)
  })(i))
}

for (const operation of operations) {
  operation()
}
```

## å®šæ—¶å™¨

å†™ JavaScript ä»£ç æ—¶ï¼Œä½ å¯èƒ½æƒ³è¦å»¶æ—¶æ‰§è¡ŒæŸä¸ªå‡½æ•°ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ setTimeout å’Œ setInterval å®‰æ’å°†æ¥çš„å‡½æ•°ã€‚

### setTimeout()

å†™ JavaScript ä»£ç æ—¶ï¼Œä½ å¯èƒ½æƒ³è¦å»¶æ—¶æ‰§è¡ŒæŸä¸ªå‡½æ•°ã€‚è¿™ä¸ªå·¥ä½œäº¤ç»™ `setTimeout`ã€‚ä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªå»¶æ—¶æ‰§è¡Œçš„å‡½æ•°å’Œéœ€è¦çš„å»¶æ—¶æ—¶é—´ï¼Œä»¥æ¯«ç§’è®¡ï¼š

```js
setTimeout(() => {
  // runs after 2 seconds
}, 2000)

setTimeout(() => {
  // runs after 50 milliseconds
}, 50)
```

è¿™ä¸ªè¯­æ³•å®šä¹‰äº†ä¸€ä¸ªæ–°å‡½æ•°ã€‚ä½ å¯ä»¥åœ¨ä»»ä½•ä½ç½®è°ƒç”¨å®ƒï¼Œä½ ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å‡½æ•°åï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸€äº›å‚æ•°ï¼š

```js
const myFunction = (firstParam, secondParam) => {
  // do something
}

// runs after 2 seconds
setTimeout(myFunction, 2000, firstParam, secondParam)
```

`setTimeout` è¿”å›ä¸€ä¸ªå®šæ—¶å™¨æ ‡è¯†ç¬¦ã€‚é€šå¸¸ä¸ä¼šç”¨åˆ°å®ƒï¼Œä½†æ˜¯ä½ å¯ä»¥ä¿å­˜è¿™ä¸ª idï¼Œåœ¨éœ€è¦åˆ é™¤è¿™ä¸ªå®šæ—¶å‡½æ•°æ—¶æ¸…ç©ºå®ƒï¼š

```js
const id = setTimeout(() => {
  // should run after 2 seconds
}, 2000)

// I changed my mind
clearTimeout(id)
```

#### é›¶å»¶æ—¶

å¦‚æœä½ æŒ‡å®šå»¶æ—¶æ—¶é—´ä¸º `0`ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°†ä¼šå°½å¯èƒ½å¿«çš„æ‰§è¡Œï¼Œä½†æ˜¯å¿…é¡»ç­‰å½“å‰å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼š

```js
setTimeout(() => {
  console.log('after ')
}, 0)

console.log(' before ')
```

ä¼šæ‰“å°å‡º `before after`ã€‚

é€šè¿‡å¯¹è°ƒåº¦ç¨‹åºä¸­çš„å‡½æ•°è¿›è¡Œæ’åºï¼Œè¿™å¯¹äºé¿å…åœ¨å¯†é›†å‹ä»»åŠ¡ä¸Šé˜»å¡ CPU å¹¶åœ¨æ‰§è¡Œç¹é‡è®¡ç®—æ—¶è®©å…¶ä»–å‡½æ•°èƒ½å¤Ÿæ‰§è¡Œç‰¹åˆ«æœ‰ç”¨ã€‚

> ä¸€äº›æµè§ˆå™¨ï¼ˆIE å’Œ Edgeï¼‰å®ç°äº† `setImmediate()` æ–¹æ³•è¾¾åˆ°ä¸Šè¿°ç›®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆä¸ºæ ‡å‡†ï¼Œ[ä¸èƒ½åœ¨å…¶å®ƒæµè§ˆå™¨ä¸­ä½¿ç”¨](https://caniuse.com/#feat=setimmediate)ã€‚ä½†åœ¨ Node.js å¯ç”¨ã€‚

### setInterval()

`setInterval` å’Œ `setTimeout` ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼šå’Œåªè¿è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ä¸åŒï¼Œå®ƒèƒ½å¤Ÿåœ¨æŒ‡å®šçš„ç‰¹å®šæ—¶é—´é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ä¸€ç›´è¿è¡Œå®ƒï¼š

```js
setInterval(() => {
  // runs every 2 seconds
}, 2000)
```

ä¸Šé¢çš„å‡½æ•°æ¯éš”ä¸¤ç§’è¿è¡Œä¸€æ¬¡ï¼Œé™¤éä½ ç”¨ `clearInterval` åœæ­¢å®ƒï¼Œä¼ å…¥ `setInterval`è¿”å›çš„é—´éš” idï¼š

```js
const id = setInterval(() => {
  // runs every 2 seconds
}, 2000)

clearInterval(id)
```

åœ¨ setInterval å›è°ƒå‡½æ•°ä¸­è°ƒç”¨ `clearInterval` å¾ˆå¸¸è§ï¼Œè¿™è®©å®ƒè‡ªå·±å†³å®šæ˜¯å¦éœ€è¦ç»§ç»­è¿è¡Œã€‚ä¾‹å­ä¸­çš„ä»£ç ä¼šä¸€ç›´è¿è¡Œï¼Œé™¤é App.somethingIWait çš„å€¼ç­‰äº `arrived`ï¼š

```js
const interval = setInterval(() => {
  if (App.somethingIWait === 'arrived') {
    clearInterval(interval)
    return
  }
  // otherwise do things
}, 100)
```

### é€’å½’ setTimeout

`setInterval` æ¯éš” n æ¯«ç§’æ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼Œä¸ä¼šè€ƒè™‘å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœå‡½æ•°æ‰§è¡Œéƒ½èŠ±è´¹ç›¸åŒçš„æ—¶é—´ï¼Œè¿™æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d7fbdb924800?w=800&h=116&f=png&s=13557)

ä½†å­˜åœ¨æ‰§è¡Œæ—¶é—´ä¸ä¸€è‡´çš„å¯èƒ½ï¼Œæ¯”å¦‚ç½‘ç»œæ¡ä»¶å¯¼è‡´çš„ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d800d01598c6?w=800&h=114&f=png&s=15415)

è¿˜æœ‰æ‰§è¡Œæ—¶é—´ä¸ä¸‹ä¸€ä¸ªé‡åˆï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d8043d1d839c?w=800&h=113&f=png&s=19271)

ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µï¼Œä½ å¯ä»¥ä½¿ç”¨é€’å½’ setTImeoutï¼Œåœ¨å›è°ƒå‡½æ•°ç»“æŸåè°ƒç”¨ï¼š

```js
const myFunction = () => {
  // do something
  setTimeout(myFunction, 1000)
}

setTimeout(
  myFunction()
}, 1000)
```

å®ç°è¿™ç§æƒ…å†µï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d8080be092a4?w=800&h=114&f=png&s=11590)

`setTimeout` å’Œ `setInterval` åœ¨ Node.js çš„ Timers æ¨¡å—é‡Œå¯ç”¨ã€‚

Node.js ä¹Ÿæä¾›äº† `setImmediate()`ï¼Œå’Œä½¿ç”¨ `setTimeout(() => {}, 0)` æ•ˆæœä¸€æ ·ï¼Œä¸»è¦ç”¨åœ¨ Node.js çš„äº‹ä»¶å¾ªç¯ã€‚

## This

`this` çš„å€¼å–å†³äºåœ¨å“ªé‡Œä½¿ç”¨å®ƒã€‚ä¸äº†è§£è¿™ä¸ªå°ç»†èŠ‚ä¼šè®©äººå¤´å¤§ï¼Œæ‰€ä»¥èŠ±äº”åˆ†é’Ÿæ—¶é—´å­¦ä¹ ä¸€ä¸‹å®ƒå§ã€‚

### ä¸¥æ ¼æ¨¡å¼çš„ this

**ä¸¥æ ¼æ¨¡å¼**ï¼Œåœ¨å¯¹è±¡å¤–çš„ `this` å§‹ç»ˆæ˜¯ `undefined`ã€‚

æ³¨æ„æˆ‘æåˆ°äº†ä¸¥æ ¼æ¨¡å¼ã€‚å¦‚æœä¸¥æ ¼æ¨¡å¼æ²¡æœ‰å¼€å¯ï¼ˆé»˜è®¤å…³é—­ï¼Œé™¤éä½ åœ¨æ–‡ä»¶å¤´éƒ¨æ˜¾å¼æ·»åŠ  `use strict`ï¼‰ï¼Œå³è‰ç‡æ¨¡å¼ï¼ˆ *sloppy mode*ï¼‰ï¼Œæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œä¸‹é¢æåˆ°çš„ `this` éƒ½æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒé‡Œæ˜¯ `window` å¯¹è±¡ã€‚

### æ–¹æ³•é‡Œçš„ this

æ–¹æ³•æ˜¯é™„åŠ åœ¨å¯¹è±¡é‡Œçš„å‡½æ•°ã€‚

ä½ å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ ¼å¼ï¼Œæ¯”å¦‚ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta',
  drive() {
    console.log(`Driving a ${this.maker} ${this.model} car!`)
  }
}

car.drive()
//Driving a Ford Fiesta car!
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½¿ç”¨äº†å¸¸è§„å‡½æ•°ï¼Œ`this` è‡ªåŠ¨ç»‘å®šäº†è¿™ä¸ªå¯¹è±¡ã€‚

æ³¨æ„ï¼šä¸Šé¢çš„æ–¹æ³•å£°æ˜å’Œ `drive: function() {..}` ç›¸åŒï¼Œåªæ˜¯æ›´çŸ­ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta',

  drive: function() {
    console.log(`Driving a ${this.maker} ${this.model} car!`)
  }
}
```

åœ¨è¿™ä¸ªä¾‹å­é‡Œä¹Ÿä¸€æ ·ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta'
}

car.drive = function() {
  console.log(`Driving a ${this.maker} ${this.model} car!`)
}

car.drive()
//Driving a Ford Fiesta car!
```

ç®­å¤´å‡½æ•°ä¸æ­¤ä¸åŒï¼Œå› ä¸ºå®ƒå±äºè¯æ³•ç»‘å®šï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta',

  drive: () => {
    console.log(`Driving a ${this.maker} ${this.model} car!`)
  }
}

car.drive()
//Driving a undefined undefined car!
```

### ç»‘å®šç®­å¤´å‡½æ•°

ä½ ä¸èƒ½åƒç»™æ™®é€šå‡½æ•°é‚£æ ·ç»™ç®­å¤´å‡½æ•°ç»‘å®šå€¼ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬çš„åŸç†ä¸åŒï¼Œ`this` æ˜¯è¯æ³•ç»‘å®šï¼Œè¿™æ„å‘³ç€å®ƒçš„å€¼æ¥è‡ªå®šä¹‰å®ƒä»¬çš„ä¸Šä¸‹æ–‡ã€‚

### æ˜¾å¼ä¼ é€’ this æŒ‡å‘çš„å¯¹è±¡

JavaScript æä¾›äº†ä¸€ç§æ˜ å°„ `this` å’Œå¯¹è±¡çš„æ–¹æ³•ã€‚

åœ¨**å‡½æ•°å£°æ˜**é˜¶æ®µä½¿ç”¨ `bind()`ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta'
}

const drive = function() {
  console.log(`Driving a ${this.maker} ${this.model} car!`)
}.bind(car)

drive()
//Driving a Ford Fiesta car!
```

ä½ ä¹Ÿå¯ä»¥é‡æ–°æ˜ å°„ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ä½œä¸º `this` å€¼ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta',
  drive() {
    console.log(`Driving a ${this.maker} ${this.model} car!`)
  }
}

const anotherCar = {
  maker: 'Audi',
  model: 'A4'
}

car.drive.bind(anotherCar)()
//Driving a Audi A4 car!
```

åœ¨**å‡½æ•°è°ƒç”¨**é˜¶æ®µä½¿ç”¨ `call()` å’Œ `apply()`ï¼š

```js
const car = {
  maker: 'Ford',
  model: 'Fiesta'
}

const drive = function(kmh) {
  console.log(`Driving a ${this.maker} ${this.model} car at ${kmh} km/h!`)
}

drive.call(car, 100)
//Driving a Ford Fiesta car at 100 km/h!

drive.apply(car, [100])
//Driving a Ford Fiesta car at 100 km/h!
```

ä¼ å…¥ `call()` æˆ–è€… `apply()` çš„ç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆç»‘å®š `this`ã€‚call() å’Œ apply() ä¸åŒä¹‹å¤„åœ¨äº apply() ä¼ å…¥çš„ä½œä¸ºå‡½æ•°å‚æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œ call() å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ã€‚

### æµè§ˆå™¨äº‹ä»¶å¤„ç†ä¸­çš„ç‰¹æ®Šæƒ…å†µ

åœ¨äº‹ä»¶å¤„ç†å™¨çš„å›è°ƒä¸­ã€‚`this` æŒ‡å‘æ”¶åˆ°äº‹ä»¶çš„ HTML å…ƒç´ ï¼š

```js
document.querySelector('#button').addEventListener('click', function(e) {
  console.log(this) //HTMLElement
})
```

ä½ å¯ä»¥è¿™æ ·ç»‘å®šï¼š

```js
document.querySelector('#button').addEventListener(
  'click',
  function(e) {
    console.log(this) //Window if global, or your context
  }.bind(this)
)
```

## ä¸¥æ ¼æ¨¡å¼

ä¸¥æ ¼æ¨¡å¼æ˜¯ ES5 çš„åŠŸèƒ½ï¼Œå®ƒä½¿ JavaScript è¡¨ç°å¾—æ›´å¥½ - å¼€å¯ä¸¥æ ¼æ¨¡å¼å¯ä»¥æ”¹å˜ JavaScript è¯­è¨€çš„è¯­ä¹‰ã€‚çŸ¥é“ä¸¥æ ¼æ¨¡å¼å’Œä¸€èˆ¬æ¨¡å¼ï¼Œä¹Ÿç»å¸¸è¢«ç§°ä½œè‰ç‡æ¨¡å¼ï¼Œåœ¨ JavaScript ä»£ç çš„ä¸åŒååˆ†é‡è¦ã€‚

ä¸¥æ ¼æ¨¡å¼ä¸»è¦ç§»é™¤äº† ES3 ä¸­å­˜åœ¨çš„åŠŸèƒ½ï¼Œä» ES5 å¼€å§‹å¼ƒç”¨è¿™äº›åŠŸèƒ½ï¼ˆè€ƒè™‘åˆ°å‘åå…¼å®¹çš„éœ€è¦æ²¡æœ‰è¢«åˆ é™¤ï¼‰ã€‚

### å¦‚ä½•å¼€å¯ä¸¥æ ¼æ¨¡å¼

ä¸¥æ ¼æ¨¡å¼æ˜¯å¯é€‰çš„ã€‚ä¼´éšç€ä¸å…¼å®¹çš„å˜åŒ–ï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•çš„æ”¹å˜è¯­è¨€çš„é»˜è®¤è¡Œä¸ºï¼Œè¿™ä¼šç ´åå¤§é‡çš„ JavaScript ä»£ç ï¼Œè€Œä¸” JavaScript èŠ±è´¹äº†å·¨å¤§çš„åŠªåŠ›ç¡®ä¿ 1996 å¹´çš„ä»£ç åœ¨ä»Šå¤©ä»ç„¶èƒ½å¤Ÿç”Ÿæ•ˆã€‚è¿™ä¹Ÿæ˜¯å®ƒèƒ½æˆåŠŸçš„å…³é”®ã€‚

æ‰€ä»¥åœ¨æˆ‘ä»¬éœ€è¦å¼€å¯ä¸¥æ ¼æ¨¡å¼çš„æ—¶å€™ï¼Œæœ‰äº† `use strict` æŒ‡ä»¤ã€‚ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼ŒæŠŠå®ƒåº”ç”¨åˆ°æ•´ä¸ªæ–‡ä»¶ï¼š

```js
'use strict'

const name = 'Flavio'
const hello = () => 'hey'

//...
```

ä½ ä¹Ÿå¯ä»¥åœ¨ç‹¬ç«‹çš„å‡½æ•°ä¸­å¯åŠ¨ä¸¥æ ¼æ¨¡å¼ï¼Œåªéœ€è¦æŠŠ `use strict` æ”¾åœ¨å‡½æ•°ä½“å¼€å§‹çš„ä½ç½®ï¼š

```js
function hello() {
  'use strict'

  return 'hey'
}
```

è¿™å¯¹æ“ä½œé‚£äº›ä½ æ²¡æœ‰æ—¶é—´æµ‹è¯•æˆ–è€…æ²¡æœ‰ä¿¡å¿ƒåœ¨æ•´ä¸ªæ–‡ä»¶å¼€å¯ä¸¥æ ¼æ¨¡å¼çš„å†å²é—ç•™ä»£ç å¾ˆæœ‰ç”¨ã€‚

### ä¸¥æ ¼æ¨¡å¼çš„å˜åŒ–

#### æ„å¤–çš„å…¨å±€å˜é‡

å¦‚æœä½ æŠŠå€¼ç»‘å®šåœ¨æœªå£°æ˜çš„å˜é‡ä¸Šï¼ŒJavaScript é»˜è®¤ä¼šåœ¨å…¨å±€å¯¹è±¡ä¸Šåˆ›å»ºè¿™ä¸ªå˜é‡ï¼š

```js
;(function() {
  variable = 'hey'
})()(() => {
  name = 'Flavio'
})()

variable //'hey'
name //'Flavio'
```

æ‰“å¼€ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ ·åšå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼š

```js
;(function() {
  'use strict'
  variable = 'hey'
})()(() => {
  'use strict'
  myname = 'Flavio'
})()
```

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d80c2a6b8de1?w=800&h=436&f=png&s=97533)

#### åˆ†é…é”™è¯¯

JavaScript é»˜é»˜å¤„ç†äº†ä¸€äº›è½¬æ¢é”™è¯¯ã€‚

åœ¨ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™äº›é”™è¯¯ä¼šè¢«å±•ç¤ºå‡ºæ¥ï¼š

```js
const undefined = 1(() => {
  'use strict'
  undefined = 1
})()
```

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d810c39e87ee?w=800&h=318&f=png&s=58079)

Infinityï¼ŒNaNï¼Œ`eval`ï¼Œ`arguments`ç­‰ç­‰åŒæ ·å¦‚æ­¤ã€‚

åœ¨ JavaScript ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸å¯å†™çš„å¯¹è±¡å±æ€§ï¼Œæ¯”å¦‚ï¼š

```js
const car = {}
Object.defineProperty(car, 'color', { value: 'blue', writable: false })
```

åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä½ ä¸èƒ½è¦†ç›–è¿™ä¸ªå€¼ï¼Œä½†åœ¨è‰ç‡æ¨¡å¼ä¸‹å¯ä»¥è¿™ä¹ˆåšï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d81594ac1945?w=800&h=366&f=png&s=84991)

å’Œ getters çš„åŸç†ä¸€æ ·ï¼š

```js

```

è‰ç‡æ¨¡å¼ä¸‹å¯ä»¥æ‰©å±•ä¸€ä¸ªä¸å¯æ‰©å±•å¯¹è±¡ï¼š

```js
const car = { color: 'blue' }
Object.preventExtensions(car)

car.model = 'Fiesta'(
  //ok
  () => {
    'use strict'
    car.owner = 'Flavio' //TypeError: Cannot add property owner, object is not extensible
  }
)()
```

è€Œä¸”å¯ä»¥è®¾ç½®åŸå§‹å€¼çš„å±æ€§ï¼Œæ²¡æœ‰ä»»ä½•é”™è¯¯æç¤ºï¼Œä½†æ˜¯ä¹Ÿä¸ç”Ÿæ•ˆï¼š

```js
true.false = ''(
  //''
  1
).name =
  'xxx' //'xxx'
var test = 'test' //undefined
test.testing = true //true
test.testing //undefined
```

ä¸¥æ ¼æ¨¡å¼ä¸‹è¿™äº›éƒ½ä¸è¢«å…è®¸ï¼š

```js
;(() => {
  'use strict'
  true.false = ''(
    //TypeError: Cannot create property 'false' on boolean 'true'
    1
  ).name =
    'xxx' //TypeError: Cannot create property 'name' on number '1'
  'test'.testing = true //TypeError: Cannot create property 'testing' on string 'test'
})()
```

#### åˆ é™¤é”™è¯¯

è‰ç‡æ¨¡å¼ä¸‹ï¼Œå¦‚æœä½ å°è¯•åˆ é™¤ä¸èƒ½åˆ é™¤çš„å±æ€§å€¼ï¼ŒJavaScript åªä¼šè¿”å› falseï¼Œä½†åœ¨ä¸¥æ ¼æ¨¡å¼ï¼Œå®ƒä¼šæŠ›å‡º TypeErrorï¼š

```js
delete Object.prototype(
  //false

  () => {
    'use strict'
    delete Object.prototype //TypeError: Cannot delete property 'prototype' of function Object() { [native code] }
  }
)()
```

#### åŒåå‡½æ•°å‚æ•°

åœ¨ä¸€èˆ¬å‡½æ•°ä¸­ï¼Œå¯èƒ½æœ‰å†²çªçš„å‚æ•°åï¼š

```js
(function(a, a, b) {
  console.log(a, b)
})(1, 2, 3)
//2 3

(function(a, a, b) {
  'use strict'
  console.log(a, b)
})(1, 2, 3)
//Uncaught SyntaxError: Duplicate parameter name not allowed in this context
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç®­å¤´å‡½æ•°å§‹ç»ˆæŠ›å‡º `SyntaxError`ï¼š

```js
((a, a, b) => {
  console.log(a, b)
})(1, 2, 3)
//Uncaught SyntaxError: Duplicate parameter name not allowed in this context
```

#### å…«è¿›åˆ¶

å…«è¿›åˆ¶è¯­æ³•åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯ç¦ç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨æ•°å­—å‰åŠ ä¸Šå…¼å®¹å…«è¿›åˆ¶æ ¼å¼çš„ `0` å¯ä»¥æŠŠå®ƒè§£é‡Šä¸ºå…«è¿›åˆ¶æ•°å­—ï¼ˆæœ‰æ—¶çœ‹èµ·æ¥å¾ˆå›°æƒ‘ï¼‰ï¼š

```js
(() => {
  console.log(010)
})()
//8

(() => {
  'use strict'
  console.log(010)
})()
//Uncaught SyntaxError: Octal literals are not allowed in strict mode.
```

ä½ ä»ç„¶å¯ä»¥é€šè¿‡ `0oXX` è¯­æ³•åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨å…«è¿›åˆ¶æ•°å­—ï¼š

```js
;(() => {
  'use strict'
  console.log(0o10)
})()
//8
```

#### ç§»é™¤äº† with

ä¸¥æ ¼æ¨¡å¼ä¸èƒ½ä½¿ç”¨ `with` å…³é”®å­—ï¼Œç§»é™¤äº†ä¸€äº›è¾¹ç•Œæƒ…å†µï¼Œä»¥ä½¿ç¼–è¯‘å™¨å±‚é¢å¯ä»¥æ›´å¥½çš„ä¼˜åŒ–ã€‚

## ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰

ç«‹å³æ‰§è¡Œå‡½æ•°åœ¨å®ƒä»¬è¢«åˆ›å»ºçš„æ—¶å€™å°±ä¼šç«‹å³æ‰§è¡Œã€‚

ç«‹å³æ‰§è¡Œå‡½æ•°éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬**ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡**ï¼Œè€Œä¸”èƒ½å¤Ÿ**éš”ç¦»å˜é‡å£°æ˜**ã€‚

ç«‹å³æ‰§è¡Œå‡½æ•°çš„è¯­æ³•æ˜¯è¿™æ ·çš„ï¼š

```js
;(function() {
  /* */
})()
```

ç«‹å³æ‰§è¡Œå‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼š

```js
;(() => {
  /* */
})()
```

åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬æŠŠå‡½æ•°å®šä¹‰åœ¨åœ†æ‹¬å·å†…ï¼Œç„¶åå†åé¢åŠ ä¸Šä¸€å¯¹ `()` æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼š`(/* function */)()`ã€‚

è¿™äº›æ‹¬å·å®é™…ä¸Šæ˜¯ä½¿æˆ‘ä»¬çš„å‡½æ•°åœ¨å†…éƒ¨è¢«è§†ä¸ºè¡¨è¾¾å¼çš„åŸå› ï¼Œå¦åˆ™ï¼Œå‡½æ•°å£°æ˜å°†æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šä»»ä½•åç§°ï¼š

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d819cf24d57a?w=684&h=223&f=png&s=16717)

å‡½æ•°å£°æ˜éœ€è¦ä¸€ä¸ªåå­—ï¼Œè€Œå‡½æ•°è¡¨è¾¾å¼ä¸éœ€è¦ã€‚

ä½ ä¹Ÿå¯ä»¥æŠŠè°ƒç”¨æ‹¬å·æ”¾åœ¨è¡¨è¾¾å¼æ‹¬å·*é‡Œé¢*ï¼Œè¿™æ˜¯ä¸€æ ·çš„ï¼Œä»…ä»…æ˜¯å†™æ³•ä¸åŒï¼š

```js
(function() {
  /* */
}())

(() => {
  /* */
}())
```

### ä½¿ç”¨ä¸€å…ƒè¿ç®—ç¬¦

åœ¨ä½¿ç”¨ IIFE æ—¶ä½¿ç”¨*ä»»æ„*ä¸€å…ƒè¿ç®—ç¬¦å¾ˆå¥‡æ€ªï¼Œä½†æ˜¯åœ¨å®é™…è¿ç”¨ä¸­å´éå¸¸æœ‰ç”¨ï¼š

```js
;-(function() {
  /* */
})()

+(function() {
 /* */
})()

~(function() {
  /* */
})()

!(function() {
  /* */
})()
```

ï¼ˆç®­å¤´å‡½æ•°ä¸Šæ— æ•ˆï¼‰

### å‘½åçš„ IIFE

IIFE ä¹Ÿå¯ä»¥å‘½åå¸¸è§„å‡½æ•°ï¼ˆä¸æ˜¯ç®­å¤´å‡½æ•°ï¼‰ã€‚è¿™ä¸ä¼šå¯¼è‡´å‡½æ•°â€œæ³„éœ²â€åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œè€Œä¸”åœ¨å®ƒæ‰§è¡Œä¹‹åä¹Ÿä¸èƒ½å†æ¬¡è°ƒç”¨ï¼š

```js
;(function doSomething() {
  /* */
})()
```

### IIFE å‰çš„åˆ†å·

ä½ ä¼šçœ‹åˆ°ï¼š

```js
;(function() {
  /* */
})()
```

è¿™æ˜¯ä¸ºäº†é˜²æ­¢æŠŠä¸¤ä¸ªæ–‡ä»¶æ‹¼åˆåœ¨ä¸€èµ·æ—¶å‡ºç°é—®é¢˜ã€‚å› ä¸º JavaScript ä¸å¼ºåˆ¶ä½¿ç”¨åˆ†å·ï¼Œä½ å¯èƒ½ä¼šåœ¨æœ€åä¸€è¡Œä¸­ä½¿ç”¨æŸäº›è¯­å¥è¿æ¥ä¸€ä¸ªæ–‡ä»¶ï¼Œä»è€Œå¯¼è‡´è¯­æ³•é”™è¯¯ã€‚

è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä¸€ç§â€œèªæ˜â€çš„ä»£ç æ‰“åŒ…å·¥å…·è§£å†³ï¼Œæ¯”å¦‚[webpack](https://flaviocopes.com/webpack/)ã€‚

## æ•°å­¦è¿ç®—ç¬¦

å¯¹ä»»ä½•ç¼–ç¨‹è¯­è¨€æ‰§è¡Œæ•°å­¦è¿ç®—éƒ½æ˜¯å¾ˆå¸¸è§çš„äº‹æƒ…ã€‚JavaScript æä¾›äº†å‡ ä¸ªæ“ä½œç¬¦æ¥å¸®åŠ©æˆ‘ä»¬å¤„ç†æ•°å­—ã€‚

### ç®—æœ¯è¿ç®—ç¬¦

#### åŠ ï¼ˆ+ï¼‰

```js
const three = 1 + 2
const four = three + 1
```

`+` è¿ç®—ç¬¦ä¹Ÿä¼šæ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ³¨æ„ï¼š

```js
const three = 1 + 2
three + 1 // 4
'three' + 1 // three1
```

#### å‡ï¼ˆ-ï¼‰

```js
const two = 4 - 2
```

#### é™¤ï¼ˆ/ï¼‰

è¿”å›ç¬¬ä¸€ä¸ªæ•°å­—å’Œç¬¬äºŒä¸ªæ•°å­—ä¹‹é—´å•†ï¼š

```js
const result = 20 / 5 //result === 4
const result = 20 / 7 //result === 2.857142857142857
```

å¦‚æœé™¤ä»¥ 0ï¼ŒJavaScript ä¸ä¼šæŠ›å‡ºä»»ä½•é”™è¯¯ï¼Œè€Œæ˜¯è¿”å› `Infinity`ï¼ˆå¦‚æœæ˜¯è´Ÿå€¼è¿”å› `-Infinity`ï¼‰ã€‚

```js
1 / 0 //Infinity
-1 / 0 //-Infinity
```

#### å–ä½™ï¼ˆ%ï¼‰

å–ä½™åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼š

```js
const result = 20 % 5 //result === 0
const result = 20 % 7 //result === 6
```

å¯¹ 0 å–ä½™å§‹ç»ˆæ˜¯ `NaN`ï¼Œæ„æ€æ˜¯â€œä¸æ˜¯ä¸€ä¸ªæ•°å­—â€ï¼š

```js
1 % 0 //NaN
-1 % 0 //NaN
```

#### ä¹˜ï¼ˆ*ï¼‰

```js
1 * 2 //2
-1 * 2 //-2
```

#### æ±‚å¹‚ï¼ˆ**ï¼‰

å°†ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¹˜ç¬¬äºŒä¸ªæ“ä½œæ•°æ¬¡æ•°ï¼š

```js
1 ** 2 //1
2 ** 1 //2
2 ** 2 //4
2 ** 8 //256
8 ** 2 //64
```

### ä¸€å…ƒè¿ç®—ç¬¦

#### é€’å¢ï¼ˆ++ï¼‰

é€’å¢æ•°å­—ã€‚è¿™æ˜¯ä¸€ä¸ªä¸€å…ƒè¿ç®—ç¬¦ï¼Œå¦‚æœæŠŠå®ƒæ”¾åœ¨æ•°å­—å‰é¢ï¼Œè¿”å›è‡ªå¢åçš„å€¼ã€‚å¦‚æœæŠŠå®ƒæ”¾åœ¨æ•°å­—åé¢ï¼Œå…ˆè¿”å›åˆå§‹å€¼ï¼Œç„¶åé€’å¢ã€‚

```js
let x = 0
x++ //0
x //1
++x //2
```

#### é€’å‡ï¼ˆ--ï¼‰

å’Œé€’å¢æ“ä½œç¬¦ç›¸ä¼¼ï¼Œä¸è¿‡å®ƒé€’å‡å€¼ã€‚

```js
let x = 0
x-- //0
x //-1
--x //-2
```

#### ä¸€å…ƒå‡ï¼ˆ-ï¼‰

è¿”å›è´Ÿå€¼

```js
let x = 2
-x //-2
x //2
```

#### ä¸€å…ƒåŠ ï¼ˆ+ï¼‰

å¦‚æœç›®æ ‡ä¸æ˜¯æ•°å­—ï¼Œå®ƒä¼šå°è¯•è½¬åŒ–å®ƒã€‚å¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚

```js
let x = 2
+x //2

x = '2'
+x //2

x = '2a'
+x //NaN
```

### å¿«é€Ÿèµ‹å€¼

å¸¸è§„çš„èµ‹å€¼æ“ä½œç¬¦ `=` å¯¹æ‰€æœ‰çš„æ•°å­¦è¿ç®—ç¬¦éƒ½æœ‰ä¸€ä¸ªå¿«æ·æ–¹å¼è®©ä½ èƒ½ç»„åˆèµ‹å€¼ï¼Œå°†ç¬¬ä¸€ä¸ªæ“ä½œæ•°å’Œç¬¬äºŒä¸ªæ“ä½œæ•°çš„ç»“æœèµ‹å€¼ç»™ç¬¬ä¸€ä¸ªæ“ä½œæ•°ã€‚

å®ƒä»¬æ˜¯ï¼š

- `+=`ï¼šåŠ æ³•èµ‹å€¼
- `-=`ï¼šé™¤æ³•èµ‹å€¼
- `*=`ï¼šä¹˜æ³•èµ‹å€¼
- `/=`ï¼šé™¤æ³•èµ‹å€¼
- `%=`ï¼šå–ä½™èµ‹å€¼
- `**=`ï¼šæ±‚å¹‚èµ‹å€¼

ä¾‹å­ï¼š

```js
const a = 0
a += 5 //a === 5
a -= 2 //a === 3
a *= 2 //a === 6
a /= 2 //a === 3
a %= 2 //a === 1
```

### ä¼˜å…ˆçº§

æ¯ä¸ªå¤æ‚çš„è¯­å¥éƒ½ä¼šå¼•å…¥ä¼˜å…ˆé—®é¢˜ã€‚çœ‹è¿™ä¸ªï¼š

```js
const a = 1 * 2 + 5 / 2 % 2
```

ç»“æœç­‰äº 2.5ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå“ªä¸ªè¿ç®—å…ˆæ‰§è¡Œï¼Œå“ªä¸ªåæ‰§è¡Œï¼Ÿ

æœ‰äº›è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æ¯”å…¶å®ƒçš„é«˜ã€‚å…¶ä¼˜å…ˆçº§éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š

- `-` `+` `++` `--` ä¸€å…ƒè¿ç®—ç¬¦ï¼Œé€’å¢ï¼Œé€’å‡
- `*` `/` `%` ä¹˜æ³•/é™¤æ³•
- `+` `-` åŠ æ³•/å‡æ³•
- `=` `+=` `-=` `*=` `/=` `%=` `**=` èµ‹å€¼è¿ç®—

åŒçº§è¿ç®—ç¬¦ï¼ˆæ¯”å¦‚ `+` å’Œ `-`ï¼‰æŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚

æ ¹æ®ä¸Šé¢çš„é¡ºåºï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—è¿™ä¸ªå¼å­ï¼š

```js
const a = 1 * 2 + 5 / 2 % 2
const a = 1 * 2 + 5 / 2 % 2
const a = 2 + 2.5 % 2
const a = 2 + 0.5
const a = 2.5
```

## Math å¯¹è±¡

Math å¯¹è±¡åŒ…å«å¾ˆå¤šæ•°å­¦ç›¸å…³çš„å·¥å…·ã€‚è®©æˆ‘ä»¬çœ‹çœ‹éƒ½æœ‰ä»€ä¹ˆã€‚

### å¸¸é‡

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d8210874f09e?w=793&h=391&f=png&s=52631)

### å‡½æ•°

æ‰€æœ‰å‡½æ•°æ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼ŒMath ä¸èƒ½è¢«ç»§æ‰¿ã€‚

### Math.abs()

è¿”å›æ•°å­—çš„ç»å¯¹å€¼

```js
Math.abs(2.5) //2.5
Math.abs(-2.5) //2.5
```

### Math.acos()

è¿”å›åä½™å¼¦å€¼ï¼Œå‚æ•°å¿…é¡»åœ¨ -1 åˆ° 1 ä¹‹é—´ã€‚

```js
Math.acos(0.8) //0.6435011087932843
```

#### Math.asin()

è¿”å›åæ­£å¼¦å€¼ï¼Œå‚æ•°å¿…é¡»åœ¨ -1 åˆ° 1 ä¹‹é—´ã€‚

```js
Math.asin(0.8) //0.9272952180016123
```

#### Math.atan()

è¿”å›åæ­£åˆ‡å€¼

```js
Math.atan(30) //1.5374753309166493
```

#### Math.atan2()

è¿”å›å…¶å‚æ•°å•†çš„åæ­£åˆ‡å€¼

```js
Math.atan2(30, 20) //0.982793723247329
```

#### Math.ceil()

å‘ä¸Šå–æ•´

```js
Math.ceil(2.5) //3
Math.ceil(2) //2
Math.ceil(2.1) //3
Math.ceil(2.99999) //3
```

#### Math.cos()

ç”¨å¼§åº¦è¡¨ç¤ºè§’åº¦çš„ä½™å¼¦å€¼

```js
Math.cos(0) //1
Math.cos(Math.PI) //-1
```

#### Math.exp()

è¿”å› Math.E çš„å‚æ•°æ¬¡æ–¹

```js
Math.exp(1) //2.718281828459045
Math.exp(2) //7.38905609893065
Math.exp(5) //148.4131591025766
```

#### Math.floor()

å‘ä¸‹å–æ•´

```js
Math.ceil(2.5) //2
Math.ceil(2) //2
Math.ceil(2.1) //2
Math.ceil(2.99999) //2
```

#### Math.log()

è¿”å›åŸºæ•° e çš„è‡ªç„¶å¯¹æ•°

```js
Math.log(10) //2.302585092994046
Math.log(Math.E) //1
```

#### Math.max()

è¿”å›ä¼ å…¥çš„ä¸€ç³»åˆ—æ•°å­—ä¸­çš„æœ€å¤§å€¼

```js
Math.max(1,2,3,4,5) //5
Math.max(1) //1
```

#### Math.min()

è¿”å›ä¼ å…¥çš„ä¸€ç³»åˆ—æ•°å­—ä¸­çš„æœ€å°å€¼

```js
Math.max(1,2,3,4,5) //1
Math.max(1) //1
```

#### Math.pow()

è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°çš„ç¬¬äºŒå‚æ•°æ¬¡æ–¹

```js
Math.pow(1, 2) //1
Math.pow(2, 1) //2
Math.pow(2, 2) //4
Math.pow(2, 4) //16
```

#### Math.random()

è¿”å› 0.0 åˆ° 1.0 ä¹‹é—´çš„ä¼ªéšæœºå€¼

```js
Math.random() //0.9318168241227056
Math.random() //0.35268950194094395
```

#### Math.round()

å››èˆäº”å…¥

```js
Math.round(1.2) //1
Math.round(1.6) //2
```

#### Math.sin()

ç”¨å¼§åº¦è®¡ç®—è§’åº¦çš„æ­£å¼¦å€¼

```js
Math.sin(0) //0
Math.sin(Math.PI) //1.2246467991473532e-16)
```

#### Math.sqrt()

å¼€æ–¹

```js
Math.sqrt(4) //2
Math.sqrt(16) //4
Math.sqrt(5) //2.23606797749979
```

#### Math.tan()

ç”¨å¼§åº¦è®¡ç®—è§’åº¦çš„æ­£åˆ‡å€¼

```js
Math.tan(0) //0
Math.tan(Math.PI) //-1.2246467991473532e-16
```

## ES æ¨¡å—

ES æ¨¡å—æ˜¯ç”¨äºå¤„ç†æ¨¡å—çš„ ECMAScript æ ‡å‡†ã€‚Node.js é•¿æœŸä»¥æ¥ä¸€ç›´ä½¿ç”¨ CommonJSï¼Œç„¶è€Œæµè§ˆå™¨è¿˜æ²¡æœ‰æ¨¡å—ç³»ç»Ÿã€‚æ¯ä¸ªä¸»è¦å†³ç­–ï¼ˆå¦‚æ¨¡å—ç³»ç»Ÿï¼‰å¿…é¡»é¦–å…ˆå…ˆç”± ECMAScript æ ‡å‡†åŒ–ï¼Œç„¶åç”±æµè§ˆå™¨å®ç°ã€‚

è¿™ä¸ªæ ‡å‡†åŒ–è¿‡ç¨‹åœ¨ ES6 ä¸­å®Œæˆï¼Œä¸æ­¤åŒæ—¶ï¼Œæµè§ˆå™¨å¼€å§‹é€æ­¥å®ç°è¿™ä¸ªæ ‡å‡†ï¼Œå°½åŠ›ä½¿å·¥ä½œæ–¹å¼ä¿æŒä¸€è‡´ã€‚ç°åœ¨ ES æ¨¡å—è¢« Chromeï¼ŒSafariï¼ŒEdge å’Œ Firefoxï¼ˆä» 60 ç‰ˆæœ¬å¼€å§‹ï¼‰æ”¯æŒã€‚

![](https://user-gold-cdn.xitu.io/2018/11/29/1675d82615dffca5?w=700&h=461&f=png&s=42207)

æ¨¡å—å¾ˆé…·ï¼Œå®ƒä»¬å…è®¸ä½ å°è£…ä»»æ„åŠŸèƒ½ï¼Œç„¶åä½œä¸ºåº“æš´éœ²ç»™å…¶å®ƒ JavaScript æ–‡ä»¶ã€‚

### ES æ¨¡å—è¯­æ³•

å¯¼å…¥ä¸€ä¸ªæ¨¡å—å¯ä»¥ç”¨ï¼š

```js
import package from 'module-name'
```

ç„¶è€Œ CommonJS ä½¿ç”¨ï¼š

```js
const package = require('module-name')
```

ä¸€ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªé€šè¿‡ `export` **å¯¼å‡º**ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼ˆå¯¹è±¡ï¼Œå‡½æ•°æˆ–å˜é‡ï¼‰çš„ JavaScript æ–‡ä»¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¿™ä¸ªæ¨¡å—å¯¼å‡ºäº†ä¸€ä¸ªå¤§å†™å­—ç¬¦ä¸²çš„å‡½æ•°ï¼š

> uppercase.js

```js
export default str => str.toUpperCase()
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¨¡å—å®šä¹‰äº†ä¸€ä¸ªå”¯ä¸€çš„ï¼Œ**é»˜è®¤å¯¼å‡ºï¼ˆdefault exportï¼‰**ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚å¦åˆ™å®ƒéœ€è¦ä¸€ä¸ªåå­—æ¥åŒºåˆ†å…¶å®ƒçš„å¯¼å‡ºã€‚ç°åœ¨ï¼Œ**å…¶å®ƒä»»ä½•çš„ JavaScript æ¨¡å—**éƒ½å¯ä»¥é€šè¿‡å¯¼å…¥ uppercase.js å¯¼å…¥è¿™ä¸ªå‡½æ•°ã€‚

ä¸€ä¸ª HTML é¡µé¢å¯ä»¥é€šè¿‡ `<script>` æ ‡ç­¾ä¸Šç‰¹æ®Šçš„ `type="module"` å±æ€§æ·»åŠ ä¸€ä¸ªæ¨¡å—ï¼š

```js
<script type="module" src="index.js"></script>
```

> æ³¨æ„ï¼šæ¨¡å—å¯¼å…¥è¡Œä¸ºå’Œ `defer` è„šæœ¬åŠ è½½ç±»ä¼¼ã€‚æŸ¥çœ‹[ä½¿ç”¨å»¶è¿Ÿå’Œå¼‚æ­¥é«˜æ•ˆåŠ è½½ JavaScript](https://flaviocopes.com/javascript-async-defer/)ã€‚

é‡è¦çš„æ˜¯ä»»ä½•æœ‰ `type="module"` çš„æ¨¡å—éƒ½æ˜¯ä»¥ä¸¥æ ¼æ¨¡å¼åŠ è½½çš„ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`uppercase.js` æ¨¡å—å®šä¹‰äº†ä¸€ä¸ª**é»˜è®¤å¯¼å‡º**ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¼å…¥è¿™ä¸ªæ¨¡å—ï¼Œè¿˜èƒ½å¤Ÿç»™å®ƒç»‘å®šä¸€ä¸ªæˆ‘ä»¬å–œæ¬¢çš„åå­—ï¼š

```js
import toUpperCase from './uppercase.js'
```

ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒï¼š

```js
toUpperCase('test') //'TEST'
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„å¯¼å…¥æ¨¡å—ï¼Œä»¥ä¾¿å¼•ç”¨å…¶å®ƒåŸŸåä¸­å®šä¹‰çš„æ¨¡å—ï¼š

```js
import toUpperCase from 'https://flavio-es-modules-example.glitch.me/uppercase.js'
```

è¿™ç§è¯­æ³•ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼š

```js
import { foo } from '/uppercase.js'
import { foo } from '../uppercase.js'
```

è¿™ç§ä¸è¡Œï¼š

```js
import { foo } from 'uppercase.js'
import { foo } from 'utils/uppercase.js'
```

è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ–åœ¨åå­—å‰åŠ ä¸Š `./` æˆ–è€… `/`ã€‚

### å…¶å®ƒå¯¼å…¥/å¯¼å‡ºæ–¹æ³•

æˆ‘ä»¬å·²ç»çŸ¥é“è¿™ä¸ªä¾‹å­ï¼š

```js
export default str => str.toUpperCase()
```

è¿™åˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤çš„å¯¼å‡ºã€‚ç„¶è€Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ä½ å¯ä»¥å¯¼å‡ºå¤šä¸ªå†…å®¹ï¼Œæ¯”å¦‚ï¼š

```js
const a = 1
const b = 2
const c = 3

export { a, b, c }
```

å¦ä¸€ä¸ªæ¨¡å—å¯ä»¥å¯¼å…¥æ‰€æœ‰ï¼š

```js
import * from 'module'
```

ä½ å¯ä»¥åªé€‰æ‹©å¯¼å…¥éƒ¨åˆ†å†…å®¹ï¼Œä½¿ç”¨è§£æ„ç»‘å®šï¼š

```js
import { a } from 'module'
import { a, b } from 'module'
```

ä½ ä¹Ÿå¯ä»¥å¯¼å…¥é»˜è®¤å¯¼å‡ºï¼Œç„¶åé€šè¿‡åå­—å¯¼å…¥æ²¡æœ‰é»˜è®¤å¯¼å‡ºçš„å†…å®¹ï¼Œå°±åƒå¸¸è§çš„å¯¼å…¥ Reactï¼š

```js
import React, { Component } from 'react'
```

åœ¨[è¿™é‡Œ](https://glitch.com/edit/#!/flavio-es-modules-example?path=index.html)æŸ¥çœ‹ ES æ¨¡å—çš„ç¤ºä¾‹ã€‚

### è·¨åŸŸèµ„æºå…±äº« CORS

é€šè¿‡ [CORS](https://flaviocopes.com/cors/) è·å–æ¨¡å—ï¼Œæ„å‘³ç€å¦‚æœä½ ä»å…¶å®ƒåŸŸåå¼•å…¥è„šæœ¬ï¼Œä»–ä»¬å¿…é¡»æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ CORS å¤´å…è®¸è·¨ç½‘é¡µåŠ è½½ï¼ˆåƒ `Access-Control-Allow-Origin`ï¼‰ã€‚

### ä¸æ”¯æŒæ¨¡å—çš„æµè§ˆå™¨æ€ä¹ˆåŠï¼Ÿ

ç»“åˆä½¿ç”¨ `type=module` å’Œ `nomodule`ï¼š

```js
<script type="module" src="module.js"></script>
<script nomodule src="fallback.js"></script>
```

### æ€»ç»“

ES æ¨¡å—æ˜¯ç°ä»£æµè§ˆå™¨å¼•å…¥çš„æœ€é‡è¦çš„åŠŸèƒ½ã€‚å®ƒä»¬æ˜¯ ES6 çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ç°å®ƒä»¬çš„è¿‡ç¨‹å¾ˆæ¼«é•¿ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬ï¼ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¿…é¡»çŸ¥é“å¤šä¸ªæ¨¡å—ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ï¼Œå› ä¸ºè¿™æ˜¯æµè§ˆå™¨å¿…é¡»æ‰§è¡Œçš„ä¸€æ­¥ã€‚

å³ä½¿ ES æ¨¡å—å·²ç»åœ¨æµè§ˆå™¨ç«¯ç™»é™†ï¼Œ[Webpack](https://flaviocopes.com/webpack/) ä¹Ÿå°†æ‰®æ¼”é‡è¦çš„è§’è‰²ï¼Œä½†æ˜¯ç›´æ¥ç”¨è¯­è¨€æ„å»ºè¿™æ ·çš„åŠŸèƒ½å¯¹äºç»Ÿä¸€æ¨¡å—åœ¨å®¢æˆ·ç«¯å’Œ Node.js ä¸Šçš„å·¥ä½œæ–¹å¼æ¥è¯´ä»»åŠ¡ç¹é‡ã€‚

## CommonJS

CommonJS æ¨¡å—è§„èŒƒæ˜¯ Node.js ä¸­çš„æ¨¡å—æ ‡å‡†ã€‚

> æµè§ˆå™¨ç«¯çš„ JavaScript é‡‡ç”¨ ES æ¨¡å—ã€‚

å®ƒä»¬è®©ä½ èƒ½å¤Ÿåˆ›å»ºæ˜“äºåˆ†å‰²ä¸”å¯å¤ç”¨çš„ä»£ç ç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µéƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•ã€‚

åºå¤§çš„ npm ç”Ÿæ€ç¯å¢ƒå°±å»ºç«‹åœ¨ CommonJS æ ¼å¼ä¹‹ä¸Šã€‚

å¯¼å…¥æ¨¡å—çš„è¯­æ³•å¦‚ä¸‹ï¼š

```js
const package = require('module-name')
```

åœ¨ CommonJS ä¸­ï¼Œæ¨¡å—åŒæ­¥åŠ è½½ï¼ŒæŒ‰ç…§ JavaScript è¿è¡Œæ—¶æ‰¾åˆ°çš„é¡ºåºæ‰§è¡Œã€‚è¿™ä¸ªç³»ç»ŸåŸæœ¬ä¸ºæœåŠ¡å™¨ç«¯ JavaScript è€Œç”Ÿï¼Œä¸å…¼å®¹å®¢æˆ·ç«¯ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¼•å…¥ ES æ¨¡å—ï¼‰ã€‚

JavaScript æ–‡ä»¶æ˜¯å¯¼å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä¸­å®šä¹‰çš„ç¬¦å·çš„æ¨¡å—ï¼Œå®ƒä»¬å¯ä»¥æ˜¯å˜é‡ï¼Œå‡½æ•°ï¼Œå¯¹è±¡ï¼š

> uppercase.js

```js
exports.uppercase = str => str.toUpperCase()
```

ä»»ä½• JavaScript æ–‡ä»¶éƒ½å¯ä»¥å¯¼å…¥å¹¶ä¸”ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼š

```js
const uppercaseModule = require('uppercase.js')
uppercaseModule.uppercase('test')
```

åœ¨ [Glitch](https://glitch.com/edit/#!/flavio-commonjs-example?path=server.js) ä¸Šçš„ç®€å•ä¾‹å­ã€‚

ä½ å¯ä»¥å¯¼å‡ºå¤šä¸ªå€¼ï¼š

```js
exports.a = 1
exports.b = 2
exports.c = 3
```

é€šè¿‡è§£æ„èµ‹å€¼å•ç‹¬å¯¼å…¥æ¯ä¸€ä¸ªå€¼ï¼š

```js
const { a, b, c } = require('./uppercase.js')
```

æˆ–è€…åªå¯¼å‡ºä¸€ä¸ªå€¼ï¼š

```js
//file.js
module.exports = value
```

ç„¶åå¯¼å…¥ï¼š

```js
const value = require('./file.js')
```

## è¯æ±‡è¡¨

æœ€åï¼Œä¸€äº›å‰ç«¯å¼€å‘çš„æœ¯è¯­å¯èƒ½å’Œä½ ç†è§£çš„ä¸åŒã€‚

### å¼‚æ­¥

å¼‚æ­¥ä»£ç æ˜¯å½“ä½ å¯åŠ¨æŸä¸ªå†…å®¹ï¼Œå¯ä»¥å…ˆå¿˜æ‰å®ƒï¼Œæ— éœ€åˆ»æ„ç­‰å¾…ï¼Œå½“ç»“æœå‡†å¤‡å°±ç»ªä½ ä¼šè‡ªåŠ¨å¾—åˆ°å®ƒã€‚å…¸å‹çš„ä¾‹å­å°±æ˜¯ AJAX è°ƒç”¨ï¼Œå¯èƒ½ä¼šå ç”¨å¾ˆå¤šç§’ï¼Œä¸æ­¤åŒæ—¶ä½ å¯ä»¥å®Œæˆå…¶å®ƒäº‹æƒ…ï¼Œå½“è·å–å“åº”ï¼Œå›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚Promises å’Œ async/await æ˜¯å¤„ç†å¼‚æ­¥ä»£ç æ›´ç°ä»£çš„æ–¹æ³•ã€‚

### å—çº§ä½œç”¨åŸŸ

å—çº§ä½œç”¨åŸŸé‡Œä»»ä½•å®šä¹‰åœ¨å—å†…çš„å˜é‡å¯¹æ•´ä¸ªå—å¯è§ï¼Œå¯ä»¥åœ¨å†…éƒ¨è®¿é—®ï¼Œä¸èƒ½åœ¨å—å¤–éƒ¨è®¿é—®ã€‚

### å›è°ƒ

å›è°ƒæ˜¯ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨çš„å‡½æ•°ã€‚å…ƒç´ ç»‘å®šçš„ç‚¹å‡»äº‹ä»¶åœ¨ç”¨æˆ·ç‚¹å‡»äº†å…ƒç´ æ—¶è°ƒç”¨ã€‚ä¸€ä¸ª fetch è¯·æ±‚çš„å›è°ƒåœ¨èµ„æºä¸‹è½½å®Œæˆåè°ƒç”¨ã€‚

### å£°æ˜

å£°æ˜æ–¹æ³•æ˜¯ä½ è¯´æ˜ç»†èŠ‚ï¼Œå‘Šè¯‰æœºå™¨ä½ éœ€è¦åšä»€ä¹ˆã€‚React è¢«è®¤ä¸ºæ˜¯å£°æ˜å¼çš„ï¼Œç†ç”±æ˜¯æ›´æ³¨é‡æŠ½è±¡æ¨ç†è€Œä¸æ˜¯ç›´æ¥ç¼–è¾‘ DOMã€‚æ¯ä¸ªé«˜çº§ç¼–ç¨‹è¯­è¨€éƒ½æ¯”ä½çº§ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ Assemblerï¼Œæ›´å…·å£°æ˜æ€§ã€‚JavaScript æ¯” C è¯­è¨€æ›´åŠ å£°æ˜æ€§ï¼ŒHTML ä¹Ÿæ˜¯å£°æ˜æ€§çš„ã€‚

### å›é€€

å›é€€ç”¨æ¥åœ¨ç”¨æˆ·æ— æ³•è®¿é—®ç‰¹å®šåŠŸèƒ½æ—¶æä¾›æ›´å¥½çš„ä½“éªŒã€‚æ¯”å¦‚æµè§ˆå™¨å…³é—­äº† JavaScriptï¼Œç”¨æˆ·åº”è¯¥å¾—åˆ°ä¸€ä¸ªåŸç”Ÿç‰ˆæœ¬çš„ HTML é¡µé¢ã€‚æˆ–è€…é‡åˆ°æµè§ˆå™¨æ²¡æœ‰å®ç°çš„ APIï¼Œä½ åº”è¯¥æœ‰ä¸€ä¸ªå¯é çš„åŠæ³•é¿å…ä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒã€‚

### å‡½æ•°ä½œç”¨åŸŸ

å‡½æ•°ä½œç”¨åŸŸé‡Œä»»ä½•å®šä¹‰åœ¨å‡½æ•°å†…çš„å˜é‡å¯¹æ•´ä¸ªå‡½æ•°å¯è§ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨è®¿é—®ï¼Œä¸èƒ½åœ¨å‡½æ•°å¤–éƒ¨è®¿é—®ã€‚

### ä¸€è‡´æ€§

ä¸€ä¸ªå˜é‡çš„å€¼åœ¨åˆ›å»ºä¹‹åä¸èƒ½æ”¹å˜ï¼Œæˆ‘ä»¬å°±ç§°è¿™å˜é‡æ˜¯ä¸å˜çš„ã€‚å¯å˜å˜é‡æ˜¯å¯å˜çš„ã€‚è¿™åœ¨æ•°ç»„å’Œå¯¹è±¡é‡Œéƒ½ä¸€æ ·ã€‚

### è¯æ±‡èŒƒå›´

è¯æ±‡èŒƒå›´æ˜¯ä¸€ä¸ªç‰¹å®šä½œç”¨åŸŸï¼Œçˆ¶å‡½æ•°çš„å˜é‡å¯ä»¥åœ¨å†…éƒ¨å‡½æ•°ä½¿ç”¨ã€‚å†…éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸä¹ŸåŒ…æ‹¬çˆ¶å‡½æ•°çš„ä½œç”¨åŸŸã€‚

### Polyfill

Polyfill ç”¨æ¥ä¸ºæ—§æµè§ˆå™¨æä¾›å®ƒæ²¡æœ‰åŸç”Ÿæ”¯æŒçš„ç°ä»£æµè§ˆå™¨å…·æœ‰çš„æ–°åŠŸèƒ½ã€‚Polyfill æ˜¯ä¸€ç§ç‰¹æ®Šçš„ shimã€‚

### çº¯ç²¹å‡½æ•°ï¼ˆpure functionï¼‰

çº¯ç²¹å‡½æ•°æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨ï¼ˆä¸ä¼šä¿®æ”¹å¤–éƒ¨èµ„æºï¼‰ï¼Œè€Œä¸”å‚æ•°å†³å®šè¾“å‡ºçš„å‡½æ•°ã€‚ä½ å¯ä»¥è°ƒç”¨å‡½æ•°ä¸€ç™¾ä¸‡æ¬¡ï¼Œæ¯æ¬¡éƒ½ç”¨ç›¸åŒçš„å‚æ•°ï¼Œè¾“å‡ºå§‹ç»ˆä¿æŒä¸€è‡´ã€‚

### é‡æ–°èµ‹å€¼

`var` å’Œ `let` å…è®¸ä½ æ— æ•°æ¬¡åœ°ä¸ºå˜é‡é‡æ–°èµ‹å€¼ã€‚`const` å£°æ˜äº†ä¸€ä¸ªä¸å¯å˜çš„å­—ç¬¦ä¸²ï¼Œæ•´å‹ï¼Œå¸ƒå°”å€¼ï¼Œå¯¹è±¡ï¼ˆä½†æ˜¯ä½ ä»ç„¶å¯ä»¥é€šè¿‡æä¾›çš„æ–¹æ³•ä¿®æ”¹å®ƒï¼‰ã€‚

### èŒƒå›´

èŒƒå›´æ˜¯ä¸€ç³»åˆ—å˜é‡å¯¹äºç¨‹åºå¯è§çš„éƒ¨åˆ†ã€‚

### ä½œç”¨åŸŸ

ä½œç”¨åŸŸæ˜¯ç¼–ç¨‹è¯­è¨€é‡Œå®šä¹‰çš„å†³å®šå˜é‡å€¼çš„ä¸€ç³»åˆ—è§„åˆ™ã€‚

### Shim

Shim åŒ…å«äº†è®¸å¤šåŠŸèƒ½æˆ–è€… APIã€‚å®ƒé€šå¸¸ç”¨äºæŠ½è±¡å†…å®¹ï¼Œé¢„å¡«å……å‚æ•°æˆ–ä¸ºä¸æ”¯æŒæŸäº›åŠŸèƒ½çš„æµè§ˆå™¨æ·»åŠ  polyfillã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œå…¼å®¹å±‚ã€‚å“ˆå“ˆ

### å‰¯ä½œç”¨

å‰¯ä½œç”¨æ˜¯ä¸€ä¸ªå‡½æ•°ä¸å…¶å®ƒå‡½æ•°æˆ–è€…å¯¹è±¡è¿›è¡Œäº¤äº’ã€‚ä¸ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿæˆ–è€…æ˜¯ UI äº¤äº’éƒ½æœ‰å‰¯ä½œç”¨ã€‚

### çŠ¶æ€ï¼ˆstateï¼‰

è°ˆåˆ°ç»„ä»¶æ—¶ï¼Œä¸å¾—ä¸æåˆ°çŠ¶æ€ã€‚ä¸€ä¸ªç»„ä»¶ç®¡ç†æ•°æ®æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå¦åˆ™æ˜¯æ— çŠ¶æ€çš„ã€‚

### æœ‰çŠ¶æ€ï¼ˆstatefulï¼‰

ä¸€ä¸ªæœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œå‡½æ•°æˆ–è€…ç±»ä¼šè‡ªå·±ç®¡ç†è‡ªå·±çš„çŠ¶æ€ï¼ˆæ•°æ®ï¼‰ã€‚å®ƒå¯ä»¥å­˜å‚¨ä¸€ä¸ªæ•°ç»„ï¼Œä¸€ä¸ªè®¡æ—¶å™¨æˆ–è€…å…¶å®ƒçš„ä¸œè¥¿ã€‚

### æ— çŠ¶æ€ï¼ˆstatelessï¼‰

ä¸€ä¸ªæ— çŠ¶æ€çš„ç»„ä»¶ï¼Œå‡½æ•°æˆ–è€…ç±»ä¹Ÿè¢«ç§°ä½œ *dumb*ï¼Œå› ä¸ºå®ƒæ— æ³•ä½¿ç”¨è‡ªå·±çš„æ•°æ®åšå‡ºå†³å®šï¼Œæ‰€ä»¥å®ƒçš„è¾“å‡ºæˆ–è€…å±•ç¤ºå®ŒæˆåŸºäºå®ƒçš„å‚æ•°ã€‚è¿™æ„å‘³ç€çº¯ç²¹å‡½æ•°æ— çŠ¶æ€çš„ã€‚

### ä¸¥æ ¼æ¨¡å¼

ä¸¥æ ¼æ¨¡å¼æ˜¯ ECMAScipt 5.1 çš„æ–°åŠŸèƒ½ï¼Œå®ƒä¼šå¯¼è‡´ JavaScript è¿è¡Œæ—¶æ•æ‰æ›´å¤šçš„é”™è¯¯ï¼Œä½†æ˜¯å®ƒå¯ä»¥é€šè¿‡æ‹’ç»æœªå£°æ˜çš„å˜é‡å’Œå†²çªçš„å¯¹è±¡å±æ€§ç­‰å…¶ä»–å®¹æ˜“è¢«å¿½è§†çš„é—®é¢˜æ¥å¸®åŠ©ä½ æ”¹è¿› JavaScript ä»£ç ã€‚å»ºè®®ï¼šä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ã€‚å¦ä¸€ä¸ªâ€œè‰ç‡æ¨¡å¼â€çœ‹åå­—å°±çŸ¥é“ä¸æ˜¯ä»€ä¹ˆå¥½ä¸œè¥¿ã€‚

### Tree Shaking

Tree Shaking æ„å‘³ç€ä»ä½ æ‰“åŒ…å‘é€ç»™ç”¨æˆ·çš„ä»£ç ä¸­åˆ é™¤â€œæ­»ä»£ç â€ã€‚å¦‚æœä½ åœ¨å¾ˆé‡è¦è¯­å¥ä¸­æ·»åŠ äº†ä»æ¥ä¸ä¼šç”¨åˆ°çš„ä»£ç ï¼Œå®ƒä¸ä¼šå‘é€ç»™ä½ çš„åº”ç”¨ç”¨æˆ·ï¼Œä»¥æ­¤å‡å°‘æ–‡ä»¶ä½“ç§¯å’ŒåŠ è½½æ—¶é—´ã€‚

æ„Ÿè°¢é˜…è¯»ï¼

**æ³¨æ„**ï¼šä½ å¯ä»¥è·å–è¿™ç¯‡ JavaScript æŒ‡å—çš„ [PDF, ePub, Mobi](https://pages.convertkit.com/2b70e494a0/7e0cc9da5b) ç‰ˆæœ¬ä»¥ä¾¿åœ¨ Kindle æˆ–å¹³æ¿ä¸Šé˜…è¯»ã€‚
